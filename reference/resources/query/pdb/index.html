
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../uniprot/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.9">
    
    
      
        <title>pdb - symdesign Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.f2e4d321.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../../css/code_select.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#resources.query.pdb" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="symdesign Documentation" class="md-header__button md-logo" aria-label="symdesign Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            symdesign Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              pdb
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="green"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="green"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/kylemeador/symdesign" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../../user_guide/" class="md-tabs__link">
        
  
    
  
  User Guide

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../" class="md-tabs__link">
          
  
  API reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="symdesign Documentation" class="md-nav__button md-logo" aria-label="symdesign Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    symdesign Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/kylemeador/symdesign" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../../user_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    symdesign
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../flags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    flags
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../metrics/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    metrics
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            metrics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../metrics/pose/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pose
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../protocols/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    protocols
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            protocols
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../protocols/align/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    align
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../protocols/cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../protocols/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../protocols/fragdock/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fragdock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../protocols/pose/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pose
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../protocols/select/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    select
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../protocols/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    resources
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    database
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../distribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    distribute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../job/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    job
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ml
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../monomer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    monomer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../multimer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    multimer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_8" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    query
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_5_8" id="__nav_3_5_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_5_8_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_5_8">
            <span class="md-nav__icon md-icon"></span>
            query
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    pdb
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    pdb
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb" class="md-nav__link">
    <span class="md-ellipsis">
      pdb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.GB" class="md-nav__link">
    <span class="md-ellipsis">
      GB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.NOR" class="md-nav__link">
    <span class="md-ellipsis">
      NOR
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.UKB" class="md-nav__link">
    <span class="md-ellipsis">
      UKB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.qsbio_confirmed" class="md-nav__link">
    <span class="md-ellipsis">
      qsbio_confirmed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.retrieve_entity_id_by_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      retrieve_entity_id_by_sequence
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.find_matching_entities_by_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      find_matching_entities_by_sequence
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.parse_pdb_response_for_ids" class="md-nav__link">
    <span class="md-ellipsis">
      parse_pdb_response_for_ids
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.query_pdb" class="md-nav__link">
    <span class="md-ellipsis">
      query_pdb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.pdb_id_matching_uniprot_id" class="md-nav__link">
    <span class="md-ellipsis">
      pdb_id_matching_uniprot_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.generate_query" class="md-nav__link">
    <span class="md-ellipsis">
      generate_query
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.retrieve_pdb_entries_by_advanced_query" class="md-nav__link">
    <span class="md-ellipsis">
      retrieve_pdb_entries_by_advanced_query
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.query_pdb_by" class="md-nav__link">
    <span class="md-ellipsis">
      query_pdb_by
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.query_assembly_id" class="md-nav__link">
    <span class="md-ellipsis">
      query_assembly_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.parse_assembly_json" class="md-nav__link">
    <span class="md-ellipsis">
      parse_assembly_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.query_entry_id" class="md-nav__link">
    <span class="md-ellipsis">
      query_entry_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.parse_entry_json" class="md-nav__link">
    <span class="md-ellipsis">
      parse_entry_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.format_symmetry_group" class="md-nav__link">
    <span class="md-ellipsis">
      format_symmetry_group
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.format_length_group" class="md-nav__link">
    <span class="md-ellipsis">
      format_length_group
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.nanohedra_building_blocks_query" class="md-nav__link">
    <span class="md-ellipsis">
      nanohedra_building_blocks_query
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.find_author_confirmed_assembly_from_entity_group" class="md-nav__link">
    <span class="md-ellipsis">
      find_author_confirmed_assembly_from_entity_group
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.solve_author_confirmed_assemblies" class="md-nav__link">
    <span class="md-ellipsis">
      solve_author_confirmed_assemblies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.entity_thermophilicity" class="md-nav__link">
    <span class="md-ellipsis">
      entity_thermophilicity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.thermophilicity_from_entity_json" class="md-nav__link">
    <span class="md-ellipsis">
      thermophilicity_from_entity_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.parse_entities_json" class="md-nav__link">
    <span class="md-ellipsis">
      parse_entities_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.query_entity_id" class="md-nav__link">
    <span class="md-ellipsis">
      query_entity_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.get_entity_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_entity_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.get_entity_uniprot_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_entity_uniprot_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.get_entity_reference_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      get_entity_reference_sequence
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.get_rcsb_metadata_schema" class="md-nav__link">
    <span class="md-ellipsis">
      get_rcsb_metadata_schema
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../uniprot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    uniprot
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sql
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../structure_db/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    structure_db
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../wrapapi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wrapapi
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../sequence/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    sequence
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            sequence
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sequence/constants/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    constants
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../sequence/expression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    expression
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../structure/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    structure
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            structure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../structure/base/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    base
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../structure/coordinates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    coordinates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../structure/fragment/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    fragment
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7_3" id="__nav_3_7_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7_3">
            <span class="md-nav__icon md-icon"></span>
            fragment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../structure/fragment/db/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    db
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../structure/fragment/info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    info
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../structure/fragment/metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../structure/fragment/visuals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    visuals
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../structure/model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../structure/sequence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sequence
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../structure/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../tools/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    tools
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/BenchmarkCollapseHydrophobicityScale/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BenchmarkCollapseHydrophobicityScale
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/ConcatenatePDBFiles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ConcatenatePDBFiles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/ProfileScripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ProfileScripts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/SlurmControl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SlurmControl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/distribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    distribute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/fetch_commands_from_slurm_output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fetch_commands_from_slurm_output
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/format_commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    format_commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/format_pose_ids/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    format_pose_ids
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/generate_reference_docs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    generate_reference_docs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/get_array_numbers_from_identifiers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    get_array_numbers_from_identifiers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/list_files_in_directory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_files_in_directory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/list_overlap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_overlap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/models_to_multimodel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    models_to_multimodel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/profile_gpu_nodes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    profile_gpu_nodes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/retrieve_oligomers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    retrieve_oligomers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/retrieve_pdbs_by_advanced_query/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    retrieve_pdbs_by_advanced_query
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../tools/write_indices_for_C1_docking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    write_indices_for_C1_docking
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../utils/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    utils
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/SymEntry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SymEntry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/nanohedra_parsing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nanohedra_parsing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/path/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    path
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/query/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    query
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/rosetta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rosetta
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/symmetry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    symmetry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../utils/types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    types
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../visualization/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    visualization
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_10" id="__nav_3_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10">
            <span class="md-nav__icon md-icon"></span>
            visualization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../visualization/SymmetryMates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SymmetryMates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../visualization/VisualizeUtils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VisualizeUtils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../visualization/shapes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shapes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb" class="md-nav__link">
    <span class="md-ellipsis">
      pdb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.GB" class="md-nav__link">
    <span class="md-ellipsis">
      GB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.NOR" class="md-nav__link">
    <span class="md-ellipsis">
      NOR
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.UKB" class="md-nav__link">
    <span class="md-ellipsis">
      UKB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.qsbio_confirmed" class="md-nav__link">
    <span class="md-ellipsis">
      qsbio_confirmed
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.retrieve_entity_id_by_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      retrieve_entity_id_by_sequence
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.find_matching_entities_by_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      find_matching_entities_by_sequence
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.parse_pdb_response_for_ids" class="md-nav__link">
    <span class="md-ellipsis">
      parse_pdb_response_for_ids
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.query_pdb" class="md-nav__link">
    <span class="md-ellipsis">
      query_pdb
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.pdb_id_matching_uniprot_id" class="md-nav__link">
    <span class="md-ellipsis">
      pdb_id_matching_uniprot_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.generate_query" class="md-nav__link">
    <span class="md-ellipsis">
      generate_query
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.retrieve_pdb_entries_by_advanced_query" class="md-nav__link">
    <span class="md-ellipsis">
      retrieve_pdb_entries_by_advanced_query
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.query_pdb_by" class="md-nav__link">
    <span class="md-ellipsis">
      query_pdb_by
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.query_assembly_id" class="md-nav__link">
    <span class="md-ellipsis">
      query_assembly_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.parse_assembly_json" class="md-nav__link">
    <span class="md-ellipsis">
      parse_assembly_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.query_entry_id" class="md-nav__link">
    <span class="md-ellipsis">
      query_entry_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.parse_entry_json" class="md-nav__link">
    <span class="md-ellipsis">
      parse_entry_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.format_symmetry_group" class="md-nav__link">
    <span class="md-ellipsis">
      format_symmetry_group
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.format_length_group" class="md-nav__link">
    <span class="md-ellipsis">
      format_length_group
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.nanohedra_building_blocks_query" class="md-nav__link">
    <span class="md-ellipsis">
      nanohedra_building_blocks_query
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.find_author_confirmed_assembly_from_entity_group" class="md-nav__link">
    <span class="md-ellipsis">
      find_author_confirmed_assembly_from_entity_group
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.solve_author_confirmed_assemblies" class="md-nav__link">
    <span class="md-ellipsis">
      solve_author_confirmed_assemblies
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.entity_thermophilicity" class="md-nav__link">
    <span class="md-ellipsis">
      entity_thermophilicity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.thermophilicity_from_entity_json" class="md-nav__link">
    <span class="md-ellipsis">
      thermophilicity_from_entity_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.parse_entities_json" class="md-nav__link">
    <span class="md-ellipsis">
      parse_entities_json
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.query_entity_id" class="md-nav__link">
    <span class="md-ellipsis">
      query_entity_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.get_entity_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_entity_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.get_entity_uniprot_id" class="md-nav__link">
    <span class="md-ellipsis">
      get_entity_uniprot_id
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.get_entity_reference_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      get_entity_reference_sequence
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources.query.pdb.get_rcsb_metadata_schema" class="md-nav__link">
    <span class="md-ellipsis">
      get_rcsb_metadata_schema
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>pdb</h1>

<div class="doc doc-object doc-module">



<a id="resources.query.pdb"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="resources.query.pdb.GB" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">GB</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">GB</span> <span class="o">=</span> <span class="s1">&#39;GenBank&#39;</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The module level identifier for a GenBankID</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="resources.query.pdb.NOR" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">NOR</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">NOR</span> <span class="o">=</span> <span class="s1">&#39;Norine&#39;</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The module level identifier for a NorineID</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="resources.query.pdb.UKB" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">UKB</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">UKB</span> <span class="o">=</span> <span class="s1">&#39;UniProt&#39;</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The module level identifier for a UniProtID</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="resources.query.pdb.qsbio_confirmed" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">qsbio_confirmed</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">qsbio_confirmed</span><span class="p">:</span> <span class="n"><span title="typing.Annotated">Annotated</span></span><span class="p">[</span><span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]],</span> <span class="s2">&quot;PDB EntryID (lowercase) mapped to biological assembly numbers for ID&#39;s with QSBio confidence as high or very high&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n"><span title="symdesign.utils.unpickle">unpickle</span></span><span class="p">(</span><span class="n"><span title="resources.query.pdb.putils.qs_bio">qs_bio</span></span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>PDB EntryID (lowercase) mapped to biological assembly numbers for ID's with QSBio confidence as high or very high</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.retrieve_entity_id_by_sequence" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">retrieve_entity_id_by_sequence</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">retrieve_entity_id_by_sequence</span><span class="p">(</span><span class="n">sequence</span><span class="p">:</span> <span class="n">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">str</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>From a given sequence, retrieve the top matching Entity ID from the PDB API</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>sequence</code></b>
            (<code>str</code>)
        
        <div class="doc-md-description">
          <p>The sequence used to query for the EntityID</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>str | None</code>
        
        <div class="doc-md-description">
          <p>'1ABC_1'</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">retrieve_entity_id_by_sequence</span><span class="p">(</span><span class="n">sequence</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;From a given sequence, retrieve the top matching Entity ID from the PDB API</span>

<span class="sd">    Args:</span>
<span class="sd">        sequence: The sequence used to query for the EntityID</span>

<span class="sd">    Returns:</span>
<span class="sd">        &#39;1ABC_1&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">matching_entities</span> <span class="o">=</span> <span class="n">find_matching_entities_by_sequence</span><span class="p">(</span><span class="n">sequence</span><span class="p">,</span> <span class="n">all_matching</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">matching_entities</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sequence search found the matching EntityIDs: </span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">matching_entities</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">matching_entities</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.find_matching_entities_by_sequence" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">find_matching_entities_by_sequence</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">find_matching_entities_by_sequence</span><span class="p">(</span><span class="n">sequence</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">return_id</span><span class="p">:</span> <span class="n"><span title="resources.query.pdb.return_types_literal">return_types_literal</span></span> <span class="o">=</span> <span class="s1">&#39;polymer_entity&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Search the PDB for matching IDs given a sequence and a return_type. Pass all_matching=False to retrieve the top
10 IDs, otherwise return all IDs</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>sequence</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The sequence used to query for EntityID's</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>return_id</code></b>
            (<code><span title="resources.query.pdb.return_types_literal">return_types_literal</span></code>, default:
                <code>&#39;polymer_entity&#39;</code>
)
        
        <div class="doc-md-description">
          <p>The type of value to return</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[str] | None</code>
        
        <div class="doc-md-description">
          <p>The EntityID's matching the sequence</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">find_matching_entities_by_sequence</span><span class="p">(</span><span class="n">sequence</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">return_id</span><span class="p">:</span> <span class="n">return_types_literal</span> <span class="o">=</span> <span class="s1">&#39;polymer_entity&#39;</span><span class="p">,</span>
                                       <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Search the PDB for matching IDs given a sequence and a return_type. Pass all_matching=False to retrieve the top</span>
<span class="sd">    10 IDs, otherwise return all IDs</span>

<span class="sd">    Args:</span>
<span class="sd">        sequence: The sequence used to query for EntityID&#39;s</span>
<span class="sd">        return_id: The type of value to return</span>

<span class="sd">    Returns:</span>
<span class="sd">        The EntityID&#39;s matching the sequence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">return_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">return_type_args</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The specified return_id &#39;</span><span class="si">{</span><span class="n">return_id</span><span class="si">}</span><span class="s2">&#39; isn&#39;t supported. Allowed values: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">return_type_args</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Using the default sequence similarity parameters: &#39;</span>
                 <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">default_sequence_values</span><span class="o">.</span><span class="n">items</span><span class="p">())</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">sequence_query</span> <span class="o">=</span> <span class="n">format_terminal_group</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="s1">&#39;sequence&#39;</span><span class="p">,</span> <span class="n">sequence</span><span class="o">=</span><span class="n">sequence</span><span class="p">)</span>
    <span class="n">sequence_query_results</span> <span class="o">=</span> <span class="n">query_pdb</span><span class="p">(</span>
        <span class="n">generate_query</span><span class="p">(</span><span class="n">sequence_query</span><span class="p">,</span> <span class="n">return_id</span><span class="o">=</span><span class="n">return_id</span><span class="p">,</span> <span class="n">cluster_uniprot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">sequence_query_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">parse_pdb_response_for_ids</span><span class="p">(</span><span class="n">sequence_query_results</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sequence wasn&#39;t found by the PDB API:</span><span class="se">\n</span><span class="si">{</span><span class="n">sequence</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>  <span class="c1"># [None]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.parse_pdb_response_for_ids" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">parse_pdb_response_for_ids</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">parse_pdb_response_for_ids</span><span class="p">(</span><span class="n">response</span><span class="p">:</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n">str</span><span class="p">]],</span> <span class="n">groups</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n">str</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Parse JSON PDB API returns for identifiers</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>response</code></b>
            (<code>dict[str, dict[str, str]]</code>)
        
        <div class="doc-md-description">
          
        </div>
      </li>
      <li class="field-body">
        <b><code>groups</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        
        <div class="doc-md-description">
          <p>Whether the identifiers are clustered by group</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[str]</code>
        
        <div class="doc-md-description">
          <p>The list of identifiers from the response</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_pdb_response_for_ids</span><span class="p">(</span><span class="n">response</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]],</span> <span class="n">groups</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse JSON PDB API returns for identifiers</span>

<span class="sd">    Args:</span>
<span class="sd">        response:</span>
<span class="sd">        groups: Whether the identifiers are clustered by group</span>

<span class="sd">    Returns:</span>
<span class="sd">        The list of identifiers from the response</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># logger.debug(f&#39;Response contains the results: {response[&quot;result_set&quot;]}&#39;)</span>
    <span class="k">if</span> <span class="n">groups</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;group_set&#39;</span><span class="p">,</span> <span class="p">[])]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;identifier&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;result_set&#39;</span><span class="p">,</span> <span class="p">[])]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.query_pdb" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">query_pdb</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">query_pdb</span><span class="p">(</span><span class="n">query_</span><span class="p">:</span> <span class="n">dict</span><span class="p">[</span><span class="n"><span title="typing.Any">Any</span></span><span class="p">]</span> <span class="o">|</span> <span class="n">str</span><span class="p">,</span> <span class="n">json_formatted</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Take a JSON formatted PDB API query and return the results</p>
<p>PDB response can look like:
{'query_id': 'ecc736b3-f19c-4a54-a5d6-3db58ce6520b',
 'result_type': 'entry',
'total_count': 104,
'result_set': [{'identifier': '4A73', 'score': 1.0,
                'services': [{'service_type': 'text', 'nodes': [{'node_id': 11198,
                                                                 'original_score': 222.23667907714844,
                                                                 'norm_score': 1.0}]}]},
               {'identifier': '5UCQ', 'score': 1.0,
                'services': [{'service_type': 'text', 'nodes': [{'node_id': 11198,
                                                                 'original_score': 222.23667907714844,
                                                                 'norm_score': 1.0}]}]},
               {'identifier': '6P3L', 'score': 1.0,
                'services': [{'service_type': 'text', 'nodes': [{'node_id': 11198,
                                                                 'original_score': 222.23667907714844,
                                                                 'norm_score': 1.0}]}]},
                ...
              ]
}</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>query_</code></b>
            (<code>dict[<span title="typing.Any">Any</span>] | str</code>)
        
        <div class="doc-md-description">
          <p>The query formatted as a dictionary or a JSON string</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>json_formatted</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        
        <div class="doc-md-description">
          <p>Whether the query is already formatted as a JSON string</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>dict[str, <span title="typing.Any">Any</span>] | None</code>
        
        <div class="doc-md-description">
          <p>The response formatted as a dictionary from the JSON format or None if the query failed</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">query_pdb</span><span class="p">(</span><span class="n">query_</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="n">json_formatted</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Take a JSON formatted PDB API query and return the results</span>

<span class="sd">    PDB response can look like:</span>
<span class="sd">    {&#39;query_id&#39;: &#39;ecc736b3-f19c-4a54-a5d6-3db58ce6520b&#39;,</span>
<span class="sd">     &#39;result_type&#39;: &#39;entry&#39;,</span>
<span class="sd">    &#39;total_count&#39;: 104,</span>
<span class="sd">    &#39;result_set&#39;: [{&#39;identifier&#39;: &#39;4A73&#39;, &#39;score&#39;: 1.0,</span>
<span class="sd">                    &#39;services&#39;: [{&#39;service_type&#39;: &#39;text&#39;, &#39;nodes&#39;: [{&#39;node_id&#39;: 11198,</span>
<span class="sd">                                                                     &#39;original_score&#39;: 222.23667907714844,</span>
<span class="sd">                                                                     &#39;norm_score&#39;: 1.0}]}]},</span>
<span class="sd">                   {&#39;identifier&#39;: &#39;5UCQ&#39;, &#39;score&#39;: 1.0,</span>
<span class="sd">                    &#39;services&#39;: [{&#39;service_type&#39;: &#39;text&#39;, &#39;nodes&#39;: [{&#39;node_id&#39;: 11198,</span>
<span class="sd">                                                                     &#39;original_score&#39;: 222.23667907714844,</span>
<span class="sd">                                                                     &#39;norm_score&#39;: 1.0}]}]},</span>
<span class="sd">                   {&#39;identifier&#39;: &#39;6P3L&#39;, &#39;score&#39;: 1.0,</span>
<span class="sd">                    &#39;services&#39;: [{&#39;service_type&#39;: &#39;text&#39;, &#39;nodes&#39;: [{&#39;node_id&#39;: 11198,</span>
<span class="sd">                                                                     &#39;original_score&#39;: 222.23667907714844,</span>
<span class="sd">                                                                     &#39;norm_score&#39;: 1.0}]}]},</span>
<span class="sd">                    ...</span>
<span class="sd">                  ]</span>
<span class="sd">    }</span>

<span class="sd">    Args:</span>
<span class="sd">        query_: The query formatted as a dictionary or a JSON string</span>
<span class="sd">        json_formatted: Whether the query is already formatted as a JSON string</span>

<span class="sd">    Returns:</span>
<span class="sd">        The response formatted as a dictionary from the JSON format or None if the query failed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">json_formatted</span><span class="p">:</span>
        <span class="n">formatted_query_</span> <span class="o">=</span> <span class="n">query_</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">formatted_query_</span> <span class="o">=</span> <span class="n">dumps</span><span class="p">(</span><span class="n">query_</span><span class="p">)</span>

    <span class="n">query_response</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">query_response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">pdb_query_url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;json&#39;</span><span class="p">:</span> <span class="n">formatted_query_</span><span class="p">})</span>
            <span class="c1"># logger.debug(f&#39;Found the PDB query with url: {query_response.url}&#39;)</span>
            <span class="k">if</span> <span class="n">query_response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">query_response</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
            <span class="k">elif</span> <span class="n">query_response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">204</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;No response was returned. Your query likely found no matches!&#39;</span><span class="p">)</span>
                <span class="k">break</span>
            <span class="k">elif</span> <span class="n">query_response</span><span class="o">.</span><span class="n">status_code</span> <span class="o">==</span> <span class="mi">429</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Too many requests, pausing momentarily&#39;</span><span class="p">)</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Your query returned an unrecognized status code (</span><span class="si">{</span><span class="n">query_response</span><span class="o">.</span><span class="n">status_code</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">except</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">ConnectionError</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Requests ran into a connection error&#39;</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="k">if</span> <span class="n">iteration</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;The maximum number of resource fetch attempts was made with no resolution. &#39;</span>
                         <span class="sa">f</span><span class="s1">&#39;Offending request </span><span class="si">{</span><span class="nb">getattr</span><span class="p">(</span><span class="n">query_response</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;url&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pdb_query_url</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>  <span class="c1"># Todo format url</span>
            <span class="k">break</span>
            <span class="c1"># raise DesignError(&#39;The maximum number of resource fetch attempts was made with no resolution. &#39;</span>
            <span class="c1">#                   &#39;Offending request %s&#39; % getattr(query_response, &#39;url&#39;, pdb_query_url))</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.pdb_id_matching_uniprot_id" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">pdb_id_matching_uniprot_id</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">pdb_id_matching_uniprot_id</span><span class="p">(</span><span class="n">uniprot_id</span><span class="p">,</span> <span class="n">return_id</span><span class="p">:</span> <span class="n"><span title="resources.query.pdb.return_types_literal">return_types_literal</span></span> <span class="o">=</span> <span class="s1">&#39;polymer_entity&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n">str</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Find all matching PDB entries from a specified UniProt ID and specific return ID</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>uniprot_id</code></b>
        
        <div class="doc-md-description">
          <p>The UniProt ID of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>return_id</code></b>
            (<code><span title="resources.query.pdb.return_types_literal">return_types_literal</span></code>, default:
                <code>&#39;polymer_entity&#39;</code>
)
        
        <div class="doc-md-description">
          <p>The type of value to return</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[str]</code>
        
        <div class="doc-md-description">
          <p>The list of matching IDs</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">pdb_id_matching_uniprot_id</span><span class="p">(</span><span class="n">uniprot_id</span><span class="p">,</span> <span class="n">return_id</span><span class="p">:</span> <span class="n">return_types_literal</span> <span class="o">=</span> <span class="s1">&#39;polymer_entity&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find all matching PDB entries from a specified UniProt ID and specific return ID</span>

<span class="sd">    Args:</span>
<span class="sd">        uniprot_id: The UniProt ID of interest</span>
<span class="sd">        return_id: The type of value to return</span>

<span class="sd">    Returns:</span>
<span class="sd">        The list of matching IDs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">return_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">return_type_args</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The specified return_id &#39;</span><span class="si">{</span><span class="n">return_id</span><span class="si">}</span><span class="s2">&#39; isn&#39;t supported. Allowed values: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">return_type_args</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">database</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;attribute&#39;</span><span class="p">:</span> <span class="s1">&#39;rcsb_polymer_entity_container_identifiers.reference_sequence_identifiers.database_name&#39;</span><span class="p">,</span>
                <span class="s1">&#39;negation&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;operator&#39;</span><span class="p">:</span> <span class="s1">&#39;exact_match&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="s1">&#39;UniProt&#39;</span><span class="p">}</span>
    <span class="n">accession</span> <span class="o">=</span> \
        <span class="p">{</span><span class="s1">&#39;attribute&#39;</span><span class="p">:</span> <span class="s1">&#39;rcsb_polymer_entity_container_identifiers.reference_sequence_identifiers.database_accession&#39;</span><span class="p">,</span>
         <span class="s1">&#39;negation&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;operator&#39;</span><span class="p">:</span> <span class="s1">&#39;in&#39;</span><span class="p">,</span> <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">uniprot_id</span><span class="p">]}</span>

    <span class="n">uniprot_query</span> <span class="o">=</span> <span class="p">[</span><span class="n">format_terminal_group</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">database</span><span class="p">),</span>
                     <span class="n">format_terminal_group</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="s1">&#39;text&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">accession</span><span class="p">)]</span>
    <span class="n">final_query</span> <span class="o">=</span> <span class="n">generate_group</span><span class="p">(</span><span class="s1">&#39;and&#39;</span><span class="p">,</span> <span class="n">uniprot_query</span><span class="p">)</span>
    <span class="n">search_query</span> <span class="o">=</span> <span class="n">generate_query</span><span class="p">(</span><span class="n">final_query</span><span class="p">,</span> <span class="n">return_id</span><span class="o">=</span><span class="n">return_id</span><span class="p">)</span>
    <span class="n">response_d</span> <span class="o">=</span> <span class="n">query_pdb</span><span class="p">(</span><span class="n">search_query</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">response_d</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">parse_pdb_response_for_ids</span><span class="p">(</span><span class="n">response_d</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.generate_query" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">generate_query</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">generate_query</span><span class="p">(</span><span class="n">search</span><span class="p">:</span> <span class="n">dict</span><span class="p">,</span> <span class="n">return_id</span><span class="p">:</span> <span class="n"><span title="resources.query.pdb.return_types_literal">return_types_literal</span></span> <span class="o">=</span> <span class="s1">&#39;entry&#39;</span><span class="p">,</span> <span class="n">cluster_uniprot</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">cluster_sequence</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">return_groups</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">all_matching</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n">dict</span> <span class="o">|</span> <span class="n">str</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Format a PDB query with the specific return type and parameters affecting search results</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>search</code></b>
            (<code>dict</code>)
        
        <div class="doc-md-description">
          <p>Contains the key, value pairs in accordance with groups and terminal groups</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>return_id</code></b>
            (<code><span title="resources.query.pdb.return_types_literal">return_types_literal</span></code>, default:
                <code>&#39;entry&#39;</code>
)
        
        <div class="doc-md-description">
          <p>The type of ID that should be returned</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>cluster_uniprot</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        
        <div class="doc-md-description">
          <p>Whether the query generated is a sequence type query</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>cluster_sequence</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        
        <div class="doc-md-description">
          <p>Whether the query generated is clustered by sequence similarity</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>return_groups</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        
        <div class="doc-md-description">
          <p>Whether to return results as group IDs</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>all_matching</code></b>
            (<code>bool</code>, default:
                <code>True</code>
)
        
        <div class="doc-md-description">
          <p>Whether to get all matching IDs</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>dict[str, dict | str]</code>
        
        <div class="doc-md-description">
          <p>The formatted query to be sent via HTTP GET</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_query</span><span class="p">(</span><span class="n">search</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">return_id</span><span class="p">:</span> <span class="n">return_types_literal</span> <span class="o">=</span> <span class="s1">&#39;entry&#39;</span><span class="p">,</span> <span class="n">cluster_uniprot</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="n">cluster_sequence</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">return_groups</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">all_matching</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> \
        <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Format a PDB query with the specific return type and parameters affecting search results</span>

<span class="sd">    Args:</span>
<span class="sd">        search: Contains the key, value pairs in accordance with groups and terminal groups</span>
<span class="sd">        return_id: The type of ID that should be returned</span>
<span class="sd">        cluster_uniprot: Whether the query generated is a sequence type query</span>
<span class="sd">        cluster_sequence: Whether the query generated is clustered by sequence similarity</span>
<span class="sd">        return_groups: Whether to return results as group IDs</span>
<span class="sd">        all_matching: Whether to get all matching IDs</span>

<span class="sd">    Returns:</span>
<span class="sd">        The formatted query to be sent via HTTP GET</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">return_id</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">return_type_args</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The specified return type &#39;</span><span class="si">{</span><span class="n">return_id</span><span class="si">}</span><span class="s2">&#39; isn&#39;t supported. Viable types include &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">return_type_args</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">query_d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;query&#39;</span><span class="p">:</span> <span class="n">search</span><span class="p">,</span> <span class="s1">&#39;return_type&#39;</span><span class="p">:</span> <span class="n">return_id</span><span class="p">}</span>
    <span class="n">request_options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;results_content_type&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;experimental&#39;</span><span class="p">],</span>  <span class="c1"># &quot;computational&quot; for Alphafold</span>
                       <span class="s1">&#39;sort&#39;</span><span class="p">:</span> <span class="p">[{</span>
                           <span class="s1">&#39;sort_by&#39;</span><span class="p">:</span> <span class="s1">&#39;score&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;direction&#39;</span><span class="p">:</span> <span class="s1">&#39;desc&#39;</span><span class="p">}],</span>
                       <span class="s1">&#39;scoring_strategy&#39;</span><span class="p">:</span> <span class="s1">&#39;combined&#39;</span>
                       <span class="p">}</span>
    <span class="k">if</span> <span class="n">cluster_uniprot</span> <span class="ow">or</span> <span class="n">cluster_sequence</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">cluster_uniprot</span><span class="p">:</span>
            <span class="n">cluster_options</span> <span class="o">=</span> <span class="n">sequence_request_options</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">cluster_sequence</span><span class="p">:</span>
            <span class="n">cluster_options</span> <span class="o">=</span> <span class="n">sequence_cluster_request_options</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">return_groups</span><span class="p">:</span>
            <span class="n">cluster_options</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;group_by_return_type&#39;</span><span class="p">:</span> <span class="s1">&#39;groups&#39;</span><span class="p">})</span>

        <span class="n">request_options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">cluster_options</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">return_groups</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span>
            <span class="s2">&quot;The argument &#39;return_groups&#39; wasn&#39;t used as neither &#39;cluster_uniprot&#39; or &#39;cluster_sequence&#39; were provided&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">all_matching</span><span class="p">:</span>
        <span class="n">request_options</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;return_all_hits&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>

    <span class="n">query_d</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;request_options&#39;</span><span class="p">:</span> <span class="n">request_options</span><span class="p">})</span>

    <span class="k">return</span> <span class="n">query_d</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.retrieve_pdb_entries_by_advanced_query" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">retrieve_pdb_entries_by_advanced_query</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">retrieve_pdb_entries_by_advanced_query</span><span class="p">(</span><span class="n">save</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">force_schema_update</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">entity</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">assembly</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">chain</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">entry</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">str</span> <span class="o">|</span> <span class="n">list</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>save</code></b>
            (<code>bool</code>, default:
                <code>True</code>
)
        
        <div class="doc-md-description">
          
        </div>
      </li>
      <li class="field-body">
        <b><code>return_results</code></b>
            (<code>bool</code>, default:
                <code>True</code>
)
        
        <div class="doc-md-description">
          
        </div>
      </li>
      <li class="field-body">
        <b><code>force_schema_update</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        
        <div class="doc-md-description">
          
        </div>
      </li>
      <li class="field-body">
        <b><code>entity</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        
        <div class="doc-md-description">
          
        </div>
      </li>
      <li class="field-body">
        <b><code>assembly</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        
        <div class="doc-md-description">
          
        </div>
      </li>
      <li class="field-body">
        <b><code>chain</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        
        <div class="doc-md-description">
          
        </div>
      </li>
      <li class="field-body">
        <b><code>entry</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        
        <div class="doc-md-description">
          
        </div>
      </li>
  </ul>
      <p>Returns:</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">retrieve_pdb_entries_by_advanced_query</span><span class="p">(</span><span class="n">save</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">return_results</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                                           <span class="n">force_schema_update</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">entity</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                           <span class="n">assembly</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">chain</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">entry</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> \
        <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        save:</span>
<span class="sd">        return_results:</span>
<span class="sd">        force_schema_update:</span>
<span class="sd">        entity:</span>
<span class="sd">        assembly:</span>
<span class="sd">        chain:</span>
<span class="sd">        entry:</span>

<span class="sd">    Returns:</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># {attribute: {&#39;dtype&#39;: &#39;string&#39;, &#39;description&#39;: &#39;XYZ&#39;, &#39;operators&#39;: {&#39;equals&#39;,}, &#39;choices&#39;: []}, ...}</span>

    <span class="k">def</span> <span class="nf">search_schema</span><span class="p">(</span><span class="n">term</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[(</span><span class="n">key</span><span class="p">,</span> <span class="n">schema</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;description&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">schema</span> <span class="k">if</span> <span class="n">schema</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;description&#39;</span><span class="p">]</span> <span class="ow">and</span>
                <span class="n">term</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span>

    <span class="k">def</span> <span class="nf">make_groups</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">recursive_depth</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="c1"># Todo remove ^ * expression?</span>
        <span class="c1"># on initialization have [{}, {}, ...]</span>
        <span class="c1">#  was [(), (), ...]</span>
        <span class="c1"># on recursion get (terminal_queries, grouping,</span>
        <span class="n">terminal_queries</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">work_on_group</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">recursive_depth</span><span class="p">]</span>
        <span class="n">all_grouping_indices</span> <span class="o">=</span> <span class="p">{</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">work_on_group</span><span class="p">))}</span>

        <span class="n">group_introduction</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{</span><span class="n">header_string</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="s2">&quot;Grouping Instructions&quot;</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span> \
                             <span class="sa">f</span><span class="s1">&#39;Because you have </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">terminal_queries</span><span class="p">)</span><span class="si">}</span><span class="s1"> search queries, you need to combine these to &#39;</span> \
                             <span class="s1">&#39;a total search strategy. This is accomplished by grouping your search queries together &#39;</span> \
                             <span class="sa">f</span><span class="s1">&#39;using the operations </span><span class="si">{</span><span class="n">group_operators</span><span class="si">}</span><span class="s1">. You must eventually group all queries into a &#39;</span> \
                             <span class="s1">&#39;single logical operation.</span><span class="se">\n</span><span class="s1">If you have multiple groups, you will need to group those &#39;</span> \
                             <span class="s1">&#39;groups, so on and so forth.</span><span class="se">\n</span><span class="s1">Indicate your group selections with a space separated list!&#39;</span>\
                             <span class="s1">&#39; You will choose the group operation to combine this list afterwards.</span><span class="se">\n</span><span class="s1">Follow prior &#39;</span> \
                             <span class="s2">&quot;prompts if you need a reminder of how group#&#39;s relate to query#&#39;s&quot;</span>
        <span class="n">group_grouping_intro</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Groups remain, you must group groups as before.&#39;</span>
        <span class="n">group_inquiry_string</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Which of these (identified by #) would you like to combine into a group?</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> \
                               <span class="n">input_string</span>
        <span class="n">group_specification_string</span> <span class="o">=</span> <span class="s1">&#39;You specified &quot;</span><span class="si">%s</span><span class="s1">&quot; as a single group.&#39;</span>
        <span class="n">group_logic_string</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">What group operator </span><span class="si">{</span><span class="n">group_operators</span><span class="si">}</span><span class="s1"> would you like for this group?</span><span class="si">{</span><span class="n">input_string</span><span class="si">}</span><span class="s1">&#39;</span>

        <span class="n">available_query_string</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Your available queries are:</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> \
                                 <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">query_display_string</span> <span class="o">%</span> <span class="p">(</span><span class="n">query_num</span><span class="p">,</span> <span class="n">service</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">attribute</span><span class="p">,</span>
                                                                   <span class="s1">&#39;NOT &#39;</span> <span class="k">if</span> <span class="n">negate</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">value</span><span class="p">)</span>
                                           <span class="k">for</span> <span class="n">query_num</span><span class="p">,</span> <span class="p">(</span><span class="n">service</span><span class="p">,</span> <span class="n">attribute</span><span class="p">,</span> <span class="n">operator</span><span class="p">,</span> <span class="n">negate</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
                                           <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">terminal_queries</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="mi">1</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">recursive_depth</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">intro_string</span> <span class="o">=</span> <span class="n">group_introduction</span>
            <span class="n">available_entity_string</span> <span class="o">=</span> <span class="n">available_query_string</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">intro_string</span> <span class="o">=</span> <span class="n">group_grouping_intro</span>
            <span class="n">available_entity_string</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Your available groups are:</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> \
                                      <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Group Group #</span><span class="si">{</span><span class="n">i</span><span class="si">}{</span><span class="n">format_string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">group</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span>
                                                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">work_on_group</span><span class="o">.</span><span class="n">values</span><span class="p">()),</span> <span class="mi">1</span><span class="p">))</span>

        <span class="nb">print</span><span class="p">(</span><span class="n">intro_string</span><span class="p">)</span>  <span class="c1"># provide an introduction</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">available_entity_string</span><span class="p">)</span>  <span class="c1"># display available entities which switch between guery and group...</span>

        <span class="n">selected_grouping_indices</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">all_grouping_indices</span><span class="p">)</span>
        <span class="n">groupings</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected_grouping_indices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># check if more work needs to be done</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># ensure grouping input is viable</span>
                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">grouping</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">input</span><span class="p">(</span><span class="n">group_inquiry_string</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">()))</span>  <span class="c1"># get new grouping</span>
                    <span class="c1"># error on isdigit() ^</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">grouping</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;More than one group is required. Your group &quot;</span><span class="si">%s</span><span class="s1">&quot; is invalid&#39;</span> <span class="o">%</span> <span class="n">grouping</span><span class="p">)</span>
                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">confirm</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">group_specification_string</span> <span class="o">%</span> <span class="n">grouping</span><span class="p">,</span> <span class="n">confirmation_string</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">confirm</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">bool_d</span><span class="p">:</span>
                        <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> is not a valid choice!&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">invalid_string</span><span class="p">,</span> <span class="n">confirm</span><span class="p">))</span>

                <span class="k">if</span> <span class="n">bool_d</span><span class="p">[</span><span class="n">confirmation</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="ow">or</span> <span class="n">confirmation</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>  <span class="c1"># confirm that grouping is as specified</span>
                    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># check if logic input is viable</span>
                        <span class="n">group_logic</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="n">group_logic_string</span><span class="p">)</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                        <span class="k">if</span> <span class="n">group_logic</span> <span class="ow">in</span> <span class="n">group_operators</span><span class="p">:</span>
                            <span class="k">break</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">invalid_string</span><span class="p">)</span>
                    <span class="n">groupings</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">grouping</span><span class="p">,</span> <span class="n">group_logic</span><span class="p">))</span>
                    <span class="k">break</span>

            <span class="c1"># remove specified from the pool of available until all are gone</span>
            <span class="n">selected_grouping_indices</span> <span class="o">=</span> <span class="n">selected_grouping_indices</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">grouping</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selected_grouping_indices</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">groupings</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">selected_grouping_indices</span><span class="p">,</span> <span class="s1">&#39;and&#39;</span><span class="p">))</span>  <span class="c1"># When only 1 remains, automatically add &#39;and&#39;</span>
            <span class="c1"># Todo test logic of and with one group?</span>

        <span class="n">args</span><span class="o">.</span><span class="n">extend</span><span class="p">((</span><span class="n">groupings</span><span class="p">,))</span>  <span class="c1"># now [{} {}, ..., ([(grouping, group_logic), (), ...])</span>
        <span class="c1"># once all groupings are grouped, recurse</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">groupings</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># todo without the return call, the stack never comes back to update args?</span>
            <span class="n">make_groups</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">recursive_depth</span><span class="o">=</span><span class="n">recursive_depth</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">list</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>  <span class="c1"># list() may be unnecessary</span>

    <span class="c1"># Start the user input routine -------------------------------------------------------------------------------------</span>
    <span class="n">schema</span> <span class="o">=</span> <span class="n">get_rcsb_metadata_schema</span><span class="p">(</span><span class="n">force_update</span><span class="o">=</span><span class="n">force_schema_update</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{</span><span class="n">header_string</span><span class="w"> </span><span class="o">%</span><span class="w"> </span><span class="s2">&quot;PDB API Advanced Query&quot;</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
          <span class="sa">f</span><span class="s1">&#39;This prompt will walk you through generating an advanced search query and retrieving the matching &#39;</span>
          <span class="s2">&quot;set of entry ID&#39;s from the PDB. This automatically parses the ID&#39;s of interest for downstream use, which &quot;</span>
          <span class="s1">&#39;can save you some headache. If you want to take advantage of the PDB webpage GUI to perform the advanced &#39;</span>
          <span class="sa">f</span><span class="s1">&#39;search, visit:</span><span class="se">\n\t</span><span class="si">{</span><span class="n">pdb_advanced_search_url</span><span class="si">}</span><span class="se">\n</span><span class="s1">Then enter &quot;json&quot; in the prompt below and follow those &#39;</span>
          <span class="s1">&#39;instructions.</span><span class="se">\n\n</span><span class="s1">&#39;</span>
          <span class="s1">&#39;Otherwise, this command line prompt takes advantage of the same GUI functionality. If you have a &#39;</span>
          <span class="s1">&#39;search specified from a prior query that you want to process again, using &quot;json&quot; will be useful as well. &#39;</span>
          <span class="s1">&#39;To proceed with the command line search just hit &quot;Enter&quot;&#39;</span><span class="p">)</span>
    <span class="n">program_start</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="n">input_string</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">program_start</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;json&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">entity</span><span class="p">:</span>
            <span class="n">return_type</span> <span class="o">=</span> <span class="s1">&#39;Polymer Entities&#39;</span>  <span class="c1"># &#39;polymer_entity&#39;</span>
        <span class="k">elif</span> <span class="n">assembly</span><span class="p">:</span>
            <span class="n">return_type</span> <span class="o">=</span> <span class="s1">&#39;Assemblies&#39;</span>  <span class="c1"># &#39;assembly&#39;</span>
        <span class="k">elif</span> <span class="n">chain</span><span class="p">:</span>
            <span class="n">return_type</span> <span class="o">=</span> <span class="s1">&#39;Polymer Entities&#39;</span>  <span class="c1"># This isn&#39;t available on web GUI -&gt; &#39;polymer_instance&#39;</span>
        <span class="k">elif</span> <span class="n">entry</span><span class="p">:</span>
            <span class="n">return_type</span> <span class="o">=</span> <span class="s1">&#39;Structures&#39;</span>  <span class="c1"># &#39;entry&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">return_type</span> <span class="o">=</span> <span class="s1">&#39;Structures&#39;</span>  <span class="c1"># &#39;entry&#39;</span>

        <span class="n">return_type_prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;At the bottom left of the dialog, there is a drop down menu next to &quot;Return&quot;. &#39;</span> \
                             <span class="sa">f</span><span class="s1">&#39;Choose </span><span class="si">{</span><span class="n">return_type</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;DETAILS: To save time formatting and immediately move to your design pipeline, build your Query with the&#39;</span>
              <span class="s1">&#39; PDB webpage GUI, then save the resulting JSON text to a file. To do this, first build your full query &#39;</span>
              <span class="sa">f</span><span class="s1">&#39;on the advanced search page, </span><span class="si">{</span><span class="n">return_type_prompt</span><span class="si">}</span><span class="s1"> then click the Search button (magnifying glass icon).&#39;</span>
              <span class="s1">&#39; After the page loads, a new section of the search page should appear above the Advanced Search Query &#39;</span>
              <span class="s1">&#39;Builder dialog. There, click the JSON|-&gt;| button to open a new page with an automatically built JSON &#39;</span>
              <span class="s1">&#39;representation of your query. Save the entirety of this JSON formatted query to a file to return your &#39;</span>
              <span class="s2">&quot;chosen ID&#39;s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># (&#39;Paste your JSON object below. IMPORTANT select from the opening \&#39;{\&#39; to &#39;</span>
        <span class="c1">#  &#39;\&#39;&quot;return_type&quot;: &quot;entry&quot;\&#39; and paste. Before hitting enter, add a closing \&#39;}\&#39;. This hack &#39;</span>
        <span class="c1">#  &#39;ensures ALL results are retrieved with no sorting or pagination applied\n\n%s&#39; %</span>
        <span class="c1">#  input_string)</span>
        <span class="n">prior_query</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Please specify the path where the JSON query file is located</span><span class="si">{</span><span class="n">input_string</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">while</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">prior_query</span><span class="p">):</span>
            <span class="n">prior_query</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The specified path &#39;</span><span class="si">{</span><span class="n">prior_query</span><span class="si">}</span><span class="s2">&#39; doesn&#39;t exist! Please try again</span><span class="si">{</span><span class="n">input_string</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">prior_query</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">json_input</span> <span class="o">=</span> <span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>

        <span class="c1"># remove any paginate instructions from the json_input</span>
        <span class="n">json_input</span><span class="p">[</span><span class="s1">&#39;request_options&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;paginate&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="c1"># if all_matching:</span>
        <span class="c1"># Ensure we get all matching</span>
        <span class="n">json_input</span><span class="p">[</span><span class="s1">&#39;request_options&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;return_all_hits&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span>
        <span class="n">response_d</span> <span class="o">=</span> <span class="n">query_pdb</span><span class="p">(</span><span class="n">json_input</span><span class="p">)</span>
    <span class="c1"># elif program_start.lower() == &#39;previous&#39;:</span>
    <span class="c1">#     while True:</span>
    <span class="c1">#         prior_query = input(&#39;Please specify the path where the search file is located%s&#39; % input_string)</span>
    <span class="c1">#         if os.path.exists(prior_query):</span>
    <span class="c1">#             with open(prior_query, &#39;r&#39;) as f:</span>
    <span class="c1">#                 search_query = loads(f.readlines())</span>
    <span class="c1">#         else:</span>
    <span class="c1">#             print(&#39;The specified path \&#39;%s\&#39; doesn\&#39;t exist! Please try again.&#39; % prior_query)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">entity</span><span class="p">:</span>
            <span class="n">return_type</span> <span class="o">=</span> <span class="s1">&#39;polymer_entity&#39;</span>
        <span class="k">elif</span> <span class="n">assembly</span><span class="p">:</span>
            <span class="n">return_type</span> <span class="o">=</span> <span class="s1">&#39;assembly&#39;</span>
        <span class="k">elif</span> <span class="n">chain</span><span class="p">:</span>
            <span class="n">return_type</span> <span class="o">=</span> <span class="s1">&#39;polymer_instance&#39;</span>
        <span class="k">elif</span> <span class="n">entry</span><span class="p">:</span>
            <span class="n">return_type</span> <span class="o">=</span> <span class="s1">&#39;entry&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">return_identifier_string</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">For each set of options, choose the option from the first column for the &#39;</span> \
                                       <span class="s1">&#39;description in the second.</span><span class="se">\n</span><span class="s1">What type of identifier do you want to search the &#39;</span>\
                                       <span class="sa">f</span><span class="s1">&#39;PDB for?%s</span><span class="si">{</span><span class="n">input_string</span><span class="si">}</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">user_input_format</span> <span class="o">%</span> \
                                       <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">format_string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">return_types</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
            <span class="n">return_type</span> <span class="o">=</span> <span class="n">validate_input</span><span class="p">(</span><span class="n">return_identifier_string</span><span class="p">,</span> <span class="n">return_type_args</span><span class="p">)</span>

        <span class="n">terminal_group_queries</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># terminal_group_queries = {}</span>
        <span class="n">increment</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># Todo only text search is available now</span>
            <span class="c1"># query_builder_service_string = &#39;\nWhat type of search method would you like to use?%s%s&#39; % \</span>
            <span class="c1">#                                (user_input_format % &#39;\n&#39;.join(format_string % item</span>
            <span class="c1">#                                                               for item in services.items()), input_string)</span>
            <span class="n">query_builder_attribute_string</span> <span class="o">=</span> \
                <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">What type of attribute would you like to use? Examples include:</span><span class="se">\n\t</span><span class="si">%s</span><span class="se">\n\n</span><span class="s1">&#39;</span> \
                <span class="sa">f</span><span class="s1">&#39;For a more thorough list indicate &quot;s&quot; for search.</span><span class="se">\n</span><span class="s1">Alternatively, you can browse </span><span class="si">{</span><span class="n">attribute_url</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span> \
                <span class="sa">f</span><span class="s1">&#39;Ensure that your spelling is exact if you want your query to succeed!</span><span class="si">{</span><span class="n">input_string</span><span class="si">}</span><span class="s1">&#39;</span> <span class="o">%</span> \
                <span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">pretty_format_table</span><span class="p">(</span><span class="n">attributes</span><span class="o">.</span><span class="n">items</span><span class="p">(),</span> <span class="n">header</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;Option&#39;</span><span class="p">,</span> <span class="s1">&#39;Description&#39;</span><span class="p">)))</span>
            <span class="n">query_builder_operator_string</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">What operator would you like to use?</span><span class="se">\n</span><span class="s1">Possible operators include:&#39;</span> \
                                            <span class="s1">&#39;</span><span class="se">\n\t</span><span class="si">%s</span><span class="se">\n</span><span class="s1">If you would like to negate the operator, on input type &quot;not&quot; &#39;</span> \
                                            <span class="sa">f</span><span class="s1">&#39;after your selection. Ex: equals not</span><span class="si">{</span><span class="n">input_string</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="n">query_builder_value_string</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">What value should be </span><span class="si">%s</span><span class="s1">? Required type is: </span><span class="si">%s</span><span class="s1">.</span><span class="si">%s%s</span><span class="s1">&#39;</span>
            <span class="n">query_display_string</span> <span class="o">=</span> <span class="s1">&#39;Query #</span><span class="si">%d</span><span class="s1">: Search the PDB by &quot;</span><span class="si">%s</span><span class="s1">&quot; for &quot;</span><span class="si">%s</span><span class="s1">&quot; attributes &quot;</span><span class="si">%s%s</span><span class="s1">&quot; &quot;</span><span class="si">%s</span><span class="s1">&quot;.&#39;</span>

            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># start the query builder routine</span>
                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="c1"># service = input(query_builder_service_string)</span>
                    <span class="n">service</span> <span class="o">=</span> <span class="s1">&#39;text&#39;</span>  <span class="c1"># Todo</span>
                    <span class="k">if</span> <span class="n">service</span> <span class="ow">in</span> <span class="n">services</span><span class="p">:</span>
                        <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="n">invalid_string</span><span class="p">)</span>

                <span class="c1"># {attribute: {&#39;dtype&#39;: &#39;string&#39;, &#39;description&#39;: &#39;XYZ&#39;, &#39;operators&#39;: {&#39;equals&#39;,}, &#39;choices&#39;: []}, ...}</span>
                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">attribute</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="n">query_builder_attribute_string</span><span class="p">)</span>
                    <span class="k">while</span> <span class="n">attribute</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span>  <span class="c1"># If the user would like to search all possible</span>
                        <span class="n">search_term</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;What term would you like to search?</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">input_string</span><span class="p">)</span>
                        <span class="n">attribute</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Found the following instances of &quot;</span><span class="si">{</span><span class="n">search_term</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s1">&quot;:</span><span class="se">\n</span><span class="s1">%s</span><span class="se">\n</span><span class="s1">Which option&#39;</span>
                                          <span class="sa">f</span><span class="s1">&#39; are you interested in? Enter &quot;s&quot; to repeat search.</span><span class="si">{</span><span class="n">input_string</span><span class="si">}</span><span class="s1">&#39;</span> <span class="o">%</span>
                                          <span class="n">user_input_format</span> <span class="o">%</span>
                                          <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">format_string</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">key_description_pair</span><span class="p">)</span> <span class="k">for</span> <span class="n">key_description_pair</span>
                                                    <span class="ow">in</span> <span class="n">search_schema</span><span class="p">(</span><span class="n">search_term</span><span class="p">)))</span>
                        <span class="k">if</span> <span class="n">attribute</span> <span class="o">!=</span> <span class="s1">&#39;s&#39;</span><span class="p">:</span>
                            <span class="k">break</span>
                    <span class="k">if</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>  <span class="c1"># Confirm the user wants to go forward with this</span>
                        <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;***ERROR: </span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="s1"> was not found in PDB schema***&#39;</span><span class="p">)</span>
                        <span class="c1"># while True:  # confirm that the confirmation input is valid</span>
                        <span class="c1">#     confirmation = input(&#39;ERROR: %s was not found in PDB schema! If you proceed, your search is&#39;</span>
                        <span class="c1">#                          &#39; almost certain to fail.\nProceed anyway? [y/n]%s&#39; %</span>
                        <span class="c1">#                          (attribute, input_string))</span>
                        <span class="c1">#     if confirmation.lower() in bool_d:</span>
                        <span class="c1">#         break</span>
                        <span class="c1">#     else:</span>
                        <span class="c1">#         print(&#39;%s %s is not a valid choice!&#39; % invalid_string, confirmation)</span>
                        <span class="c1"># if bool_d[confirmation.lower()] or confirmation.isspace():  # break the attribute routine on y or &#39;&#39;</span>
                        <span class="c1">#     break</span>

                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># Retrieve the operator for the search</span>
                    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># Check if the operator should be negated</span>
                        <span class="n">operator</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="n">query_builder_operator_string</span> <span class="o">%</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;operators&#39;</span><span class="p">]))</span>
                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">split</span><span class="p">())</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                            <span class="n">negation</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
                            <span class="n">operator</span> <span class="o">=</span> <span class="n">operator</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                            <span class="k">if</span> <span class="n">negation</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;not&#39;</span><span class="p">:</span>  <span class="c1"># Can negate any search</span>
                                <span class="n">negate</span> <span class="o">=</span> <span class="kc">True</span>
                                <span class="k">break</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">invalid_string</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">negation</span><span class="si">}</span><span class="s2"> is not a recognized negation!</span><span class="se">\n</span><span class="s2"> &quot;</span>
                                      <span class="sa">f</span><span class="s2">&quot;Try &#39;</span><span class="si">{</span><span class="n">operator</span><span class="si">}</span><span class="s2"> not&#39; instead or remove extra input&quot;</span><span class="p">)</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">negate</span> <span class="o">=</span> <span class="kc">False</span>
                            <span class="k">break</span>
                    <span class="k">if</span> <span class="n">operator</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;operators&#39;</span><span class="p">]:</span>
                        <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">invalid_string</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">operator</span><span class="si">}</span><span class="s2"> isn&#39;t a valid operator&quot;</span><span class="p">)</span>

                <span class="n">op_in</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">while</span> <span class="n">op_in</span><span class="p">:</span>  <span class="c1"># Check if operator is &#39;in&#39;</span>
                    <span class="k">if</span> <span class="n">operator</span> <span class="o">==</span> <span class="s1">&#39;in&#39;</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">The &#39;in&#39; operator can take multiple values. If you want multiple values, specify &quot;</span>
                              <span class="s1">&#39;each as a separate input&#39;</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">op_in</span> <span class="o">=</span> <span class="kc">False</span>

                    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># Retrieve the value for the search</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="n">query_builder_value_string</span> <span class="o">%</span> <span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">instance_d</span><span class="p">[</span><span class="n">schema</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;dtype&#39;</span><span class="p">]]</span>
                                                                    <span class="p">,</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Possible choices:</span><span class="se">\n\t</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span>
                                                                       <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;choices&#39;</span><span class="p">])</span>
                                                                       <span class="k">if</span> <span class="n">schema</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;choices&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
                                                                    <span class="n">input_string</span><span class="p">))</span>
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">instance_d</span><span class="p">[</span><span class="n">schema</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;dtype&#39;</span><span class="p">]]):</span>  <span class="c1"># check if the right data type</span>
                            <span class="k">break</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="k">try</span><span class="p">:</span>  <span class="c1"># try to convert the input value to the specified type</span>
                                <span class="n">value</span> <span class="o">=</span> <span class="n">instance_d</span><span class="p">[</span><span class="n">schema</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;dtype&#39;</span><span class="p">]](</span><span class="n">value</span><span class="p">)</span>
                                <span class="k">if</span> <span class="n">schema</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;choices&#39;</span><span class="p">]:</span>  <span class="c1"># if there is a choice</span>
                                    <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;choices&#39;</span><span class="p">]:</span>  <span class="c1"># check if the value is in the possible choices</span>
                                        <span class="k">break</span>
                                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># if not, confirm the users desire to do this</span>
                                        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># confirm that the confirmation input is valid</span>
                                            <span class="n">confirmation</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="s1"> was not found in the possible choices: </span><span class="si">%s</span><span class="se">\n</span><span class="s1">Proceed&#39;</span>
                                                                 <span class="s1">&#39; anyway? [y/n]</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span>
                                                                 <span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;choices&#39;</span><span class="p">]),</span>
                                                                  <span class="n">input_string</span><span class="p">))</span>
                                            <span class="k">if</span> <span class="n">confirmation</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">bool_d</span><span class="p">:</span>
                                                <span class="k">break</span>
                                            <span class="k">else</span><span class="p">:</span>
                                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">invalid_string</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">confirmation</span><span class="si">}</span><span class="s2"> isn&#39;t a valid choice&quot;</span><span class="p">)</span>
                                        <span class="k">if</span> <span class="n">bool_d</span><span class="p">[</span><span class="n">confirmation</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="ow">or</span> <span class="n">confirmation</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>  <span class="c1"># break the value routine on y or &#39;&#39;</span>
                                            <span class="k">break</span>

                                <span class="k">else</span><span class="p">:</span>
                                    <span class="k">break</span>
                            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># catch any conversion issue like float(&#39;A&#39;)</span>
                                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">invalid_string</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> isn&#39;t a valid </span><span class="si">{</span><span class="n">instance_d</span><span class="p">[</span><span class="n">schema</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;dtype&#39;</span><span class="p">]]</span><span class="si">}</span><span class="s2">&quot;</span>
                                      <span class="s2">&quot; value!&quot;</span><span class="p">)</span>

                    <span class="k">while</span> <span class="n">op_in</span><span class="p">:</span>
                        <span class="c1"># TODO ensure that the in parameters are spit out as a list</span>
                        <span class="n">additional</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="n">additional_input_string</span> <span class="o">%</span> <span class="s2">&quot; value to your &#39;in&#39; operator&quot;</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">additional</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">bool_d</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">bool_d</span><span class="p">[</span><span class="n">additional</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="ow">or</span> <span class="n">additional</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
                                <span class="k">break</span>  <span class="c1"># Stop the inner &#39;in&#39; check loop</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">op_in</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Stop the inner and outer &#39;in&#39; while loops</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">invalid_string</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">additional</span><span class="si">}</span><span class="s2"> isn&#39;t a valid choice&quot;</span><span class="p">)</span>

                <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                    <span class="n">confirmation</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">%s</span><span class="se">\n</span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">query_display_string</span> <span class="o">%</span>
                                                       <span class="p">(</span><span class="n">increment</span><span class="p">,</span> <span class="n">service</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">attribute</span><span class="p">,</span>
                                                        <span class="s1">&#39;NOT &#39;</span> <span class="k">if</span> <span class="n">negate</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">operator</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">value</span><span class="p">),</span>
                                                       <span class="n">confirmation_string</span><span class="p">))</span>
                    <span class="k">if</span> <span class="n">confirmation</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">bool_d</span><span class="p">:</span>
                        <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">invalid_string</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">confirmation</span><span class="si">}</span><span class="s2"> isn&#39;t a valid choice&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">bool_d</span><span class="p">[</span><span class="n">confirmation</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="ow">or</span> <span class="n">confirmation</span><span class="o">.</span><span class="n">isspace</span><span class="p">():</span>
                    <span class="k">break</span>

            <span class="c1"># terminal_group_queries[increment] = (service, attribute, operator, negate, value)</span>
            <span class="n">terminal_group_queries</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">service</span><span class="o">=</span><span class="n">service</span><span class="p">,</span> <span class="n">attribute</span><span class="o">=</span><span class="n">attribute</span><span class="p">,</span> <span class="n">operator</span><span class="o">=</span><span class="n">operator</span><span class="p">,</span> <span class="n">negate</span><span class="o">=</span><span class="n">negate</span><span class="p">,</span>
                                               <span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">))</span>
            <span class="n">increment</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">additional</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="n">additional_input_string</span> <span class="o">%</span> <span class="s1">&#39; query&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">additional</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">in</span> <span class="n">bool_d</span><span class="p">:</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">invalid_string</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">confirmation</span><span class="si">}</span><span class="s2"> isn&#39;t a valid choice&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">bool_d</span><span class="p">[</span><span class="n">additional</span><span class="o">.</span><span class="n">lower</span><span class="p">()]:</span>  <span class="c1"># or confirmation.isspace():</span>
                <span class="k">break</span>

        <span class="c1"># Group terminal queries into groups if there are more than 1</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">terminal_group_queries</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">recursive_query_tree</span> <span class="o">=</span> <span class="n">make_groups</span><span class="p">(</span><span class="n">terminal_group_queries</span><span class="p">)</span>
            <span class="c1"># expecting return of [terminal_group_queries, bottom group hierarchy, second group hierarchy, ..., top]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">recursive_query_tree</span> <span class="o">=</span> <span class="p">[</span><span class="n">terminal_group_queries</span><span class="p">]</span>
            <span class="c1"># recursive_query_tree = (terminal_group_queries, )</span>
        <span class="c1"># recursive_query_tree = (queries, grouping1, grouping2, etc.)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">node</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">recursive_query_tree</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">recursive_query_tree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">j</span><span class="p">:</span> <span class="n">format_terminal_group</span><span class="p">(</span><span class="o">**</span><span class="n">leaf</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="mi">1</span><span class="p">)}</span>
                <span class="c1"># recursive_query_tree[i] = {j: format_terminal_group(*node[leaf]) for j, leaf in enumerate(node, 1)}</span>

                <span class="c1"># terminal_group_queries = {j: format_terminal_group(*leaf) for j, leaf in enumerate(node)}</span>
                <span class="c1"># format_terminal_group(parameter_args, service=service)</span>
                <span class="c1"># terminal_group_queries[increment] = \</span>
                <span class="c1">#     format_terminal_group(attribute, operator, value, service=service)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># if i == 1:</span>
                <span class="c1">#     child_groups = terminal_group_queries</span>
                <span class="c1">#     # child_groups = [terminal_group_queries[j] for j in child_nodes]</span>
                <span class="c1"># else:</span>
                <span class="c1">#     child_groups = recursive_query_tree[i]</span>
                <span class="c1"># operation, child_nodes = node</span>
                <span class="c1"># groups = {j: generate_group(operation, child_groups) for j, leaf in enumerate(node)}</span>

                <span class="c1"># NOPE Subtract the k indices to ensure that the user input numbers match with python zero indexing</span>
                <span class="c1"># i - 1 gives the index of the previous index of the recursive_query_tree to operate on</span>
                <span class="c1"># k pulls the groups specified in the input out to make a list with the corresponding terminai groups</span>
                <span class="n">recursive_query_tree</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">j</span><span class="p">:</span> <span class="n">generate_group</span><span class="p">(</span><span class="n">operation</span><span class="p">,</span> <span class="p">[</span><span class="n">recursive_query_tree</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">][</span><span class="n">k</span><span class="p">]</span>
                                                                         <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">child_group_nums</span><span class="p">])</span>
                                           <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="p">(</span><span class="n">child_group_nums</span><span class="p">,</span> <span class="n">operation</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="mi">1</span><span class="p">)}</span>
                <span class="c1"># for k in child_group_nums}</span>
        <span class="n">final_query</span> <span class="o">=</span> <span class="n">recursive_query_tree</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  <span class="c1">#</span>

        <span class="n">search_query</span> <span class="o">=</span> <span class="n">generate_query</span><span class="p">(</span><span class="n">final_query</span><span class="p">,</span> <span class="n">return_id</span><span class="o">=</span><span class="n">return_type</span><span class="p">)</span>
        <span class="n">response_d</span> <span class="o">=</span> <span class="n">query_pdb</span><span class="p">(</span><span class="n">search_query</span><span class="p">)</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The server returned:</span><span class="se">\n</span><span class="si">{</span><span class="n">response_d</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">response_d</span><span class="p">:</span>
        <span class="n">retrieved_ids</span> <span class="o">=</span> <span class="n">parse_pdb_response_for_ids</span><span class="p">(</span><span class="n">response_d</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">save</span><span class="p">:</span>
        <span class="n">utils</span><span class="o">.</span><span class="n">io_save</span><span class="p">(</span><span class="n">retrieved_ids</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">return_results</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">retrieved_ids</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.query_pdb_by" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">query_pdb_by</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">query_pdb_by</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">assembly_id</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">assembly_integer</span><span class="p">:</span> <span class="n">int</span> <span class="o">|</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_id</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_integer</span><span class="p">:</span> <span class="n">int</span> <span class="o">|</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">chain</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dict</span> <span class="o">|</span> <span class="n">list</span><span class="p">[</span><span class="n">list</span><span class="p">[</span><span class="n">str</span><span class="p">]]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Retrieve information from the PDB API by EntryID, AssemblyID, or EntityID</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>entry</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The 4 character PDB EntryID of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>assembly_id</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The AssemblyID to query with format (1ABC-1)</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>assembly_integer</code></b>
            (<code>int | str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The particular assembly integer to query. Must include entry as well</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>entity_id</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The PDB formatted EntityID. Has the format EntryID_Integer (1ABC_1)</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>entity_integer</code></b>
            (<code>int | str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The entity integer from the EntryID of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>chain</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The polymer "chain" identifier otherwise known as the "asym_id" from the PDB EntryID of interest</p>
        </div>
      </li>
  </ul>
      <p>Returns:
    The query result</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">query_pdb_by</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">assembly_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">assembly_integer</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">entity_integer</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">chain</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve information from the PDB API by EntryID, AssemblyID, or EntityID</span>

<span class="sd">    Args:</span>
<span class="sd">        entry: The 4 character PDB EntryID of interest</span>
<span class="sd">        assembly_id: The AssemblyID to query with format (1ABC-1)</span>
<span class="sd">        assembly_integer: The particular assembly integer to query. Must include entry as well</span>
<span class="sd">        entity_id: The PDB formatted EntityID. Has the format EntryID_Integer (1ABC_1)</span>
<span class="sd">        entity_integer: The entity integer from the EntryID of interest</span>
<span class="sd">        chain: The polymer &quot;chain&quot; identifier otherwise known as the &quot;asym_id&quot; from the PDB EntryID of interest</span>
<span class="sd">    Returns:</span>
<span class="sd">        The query result</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">entity_integer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Querying PDB API with </span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">entity_integer</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">_get_entity_info</span><span class="p">(</span><span class="n">entry</span><span class="o">=</span><span class="n">entry</span><span class="p">,</span> <span class="n">entity_integer</span><span class="o">=</span><span class="n">entity_integer</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">assembly_integer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Querying PDB API with </span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">assembly_integer</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">_get_assembly_info</span><span class="p">(</span><span class="n">entry</span><span class="o">=</span><span class="n">entry</span><span class="p">,</span> <span class="n">assembly_integer</span><span class="o">=</span><span class="n">assembly_integer</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Querying PDB API with </span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">data</span> <span class="o">=</span> <span class="n">_get_entry_info</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">chain</span><span class="p">:</span>
                    <span class="n">integer</span> <span class="o">=</span> <span class="kc">None</span>
                    <span class="k">for</span> <span class="n">entity_idx</span><span class="p">,</span> <span class="n">chains</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;entity&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                        <span class="k">if</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">chains</span><span class="p">:</span>
                            <span class="n">integer</span> <span class="o">=</span> <span class="n">entity_idx</span>
                            <span class="k">break</span>
                    <span class="k">if</span> <span class="n">integer</span><span class="p">:</span>
                        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Querying PDB API with </span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">integer</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                        <span class="k">return</span> <span class="n">_get_entity_info</span><span class="p">(</span><span class="n">entry</span><span class="o">=</span><span class="n">entry</span><span class="p">,</span> <span class="n">entity_integer</span><span class="o">=</span><span class="n">integer</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                            <span class="sa">f</span><span class="s2">&quot;No chainID &#39;</span><span class="si">{</span><span class="n">chain</span><span class="si">}</span><span class="s2">&#39; found in PDB ID </span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">. Possible chains &quot;</span>
                            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ch</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">chns</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;entity&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{})</span><span class="o">.</span><span class="n">items</span><span class="p">()</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">ch</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">chns</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EntryID &#39;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s2">&#39; isn&#39;t the required format and will not be found with the PDB API&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">assembly_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">entry</span><span class="p">,</span> <span class="n">assembly_integer</span><span class="p">,</span> <span class="o">*</span><span class="n">extra</span> <span class="o">=</span> <span class="n">assembly_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">extra</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Querying PDB API with </span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">assembly_integer</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">_get_assembly_info</span><span class="p">(</span><span class="n">entry</span><span class="o">=</span><span class="n">entry</span><span class="p">,</span> <span class="n">assembly_integer</span><span class="o">=</span><span class="n">assembly_integer</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;AssemblyID &#39;</span><span class="si">{</span><span class="n">assembly_id</span><span class="si">}</span><span class="s2">&#39; isn&#39;t the required format and will not be found with the PDB API&quot;</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">entity_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">entry</span><span class="p">,</span> <span class="n">entity_integer</span><span class="p">,</span> <span class="o">*</span><span class="n">extra</span> <span class="o">=</span> <span class="n">entity_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">extra</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Querying PDB API with </span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">entity_integer</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">_get_entity_info</span><span class="p">(</span><span class="n">entry</span><span class="o">=</span><span class="n">entry</span><span class="p">,</span> <span class="n">entity_integer</span><span class="o">=</span><span class="n">entity_integer</span><span class="p">)</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EntityID &#39;</span><span class="si">{</span><span class="n">entity_id</span><span class="si">}</span><span class="s2">&#39; isn&#39;t the required format and will not be found with the PDB API&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;No valid arguments passed to </span><span class="si">{</span><span class="n">query_pdb_by</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">. Valid arguments include: &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;entry, assembly_id, assembly_integer, entity_id, entity_integer, chain&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.query_assembly_id" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">query_assembly_id</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">query_assembly_id</span><span class="p">(</span><span class="n">assembly_id</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entry</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">assembly_integer</span><span class="p">:</span> <span class="n">str</span> <span class="o">|</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="requests.Response">Response</span></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Retrieve PDB AssemblyID information from the PDB API. More info at http://data.rcsb.org/#data-api</p>
<p>For all method types the following keys are available:
{'rcsb_polymer_entity_annotation', 'entity_poly', 'rcsb_polymer_entity', 'entity_src_gen',
 'rcsb_polymer_entity_feature_summary', 'rcsb_polymer_entity_align', 'rcsb_id', 'rcsb_cluster_membership',
 'rcsb_polymer_entity_container_identifiers', 'rcsb_entity_host_organism', 'rcsb_latest_revision',
 'rcsb_entity_source_organism'}
NMR only - {'rcsb_polymer_entity_feature'}
EM only - set()
X-ray_only_keys - {'rcsb_cluster_flexibility'}</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>assembly_id</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The AssemblyID to query with format (1ABC-1)</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>entry</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The 4 character PDB EntryID of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>assembly_integer</code></b>
            (<code>str | int</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The particular assembly integer to query. Must include entry as well</p>
        </div>
      </li>
  </ul>
      <p>Returns:
    The assembly information according to the PDB</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span>
<span class="normal">894</span>
<span class="normal">895</span>
<span class="normal">896</span>
<span class="normal">897</span>
<span class="normal">898</span>
<span class="normal">899</span>
<span class="normal">900</span>
<span class="normal">901</span>
<span class="normal">902</span>
<span class="normal">903</span>
<span class="normal">904</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">query_assembly_id</span><span class="p">(</span><span class="n">assembly_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entry</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">assembly_integer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> \
        <span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve PDB AssemblyID information from the PDB API. More info at http://data.rcsb.org/#data-api</span>

<span class="sd">    For all method types the following keys are available:</span>
<span class="sd">    {&#39;rcsb_polymer_entity_annotation&#39;, &#39;entity_poly&#39;, &#39;rcsb_polymer_entity&#39;, &#39;entity_src_gen&#39;,</span>
<span class="sd">     &#39;rcsb_polymer_entity_feature_summary&#39;, &#39;rcsb_polymer_entity_align&#39;, &#39;rcsb_id&#39;, &#39;rcsb_cluster_membership&#39;,</span>
<span class="sd">     &#39;rcsb_polymer_entity_container_identifiers&#39;, &#39;rcsb_entity_host_organism&#39;, &#39;rcsb_latest_revision&#39;,</span>
<span class="sd">     &#39;rcsb_entity_source_organism&#39;}</span>
<span class="sd">    NMR only - {&#39;rcsb_polymer_entity_feature&#39;}</span>
<span class="sd">    EM only - set()</span>
<span class="sd">    X-ray_only_keys - {&#39;rcsb_cluster_flexibility&#39;}</span>

<span class="sd">    Args:</span>
<span class="sd">        assembly_id: The AssemblyID to query with format (1ABC-1)</span>
<span class="sd">        entry: The 4 character PDB EntryID of interest</span>
<span class="sd">        assembly_integer: The particular assembly integer to query. Must include entry as well</span>
<span class="sd">    Returns:</span>
<span class="sd">        The assembly information according to the PDB</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">assembly_id</span><span class="p">:</span>
        <span class="n">entry</span><span class="p">,</span> <span class="n">assembly_integer</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">assembly_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)</span>  <span class="c1"># assume that this was passed correctly</span>

    <span class="k">if</span> <span class="n">entry</span> <span class="ow">and</span> <span class="n">assembly_integer</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">connection_exception_handler</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pdb_rest_url</span><span class="si">}</span><span class="s1">/assembly/</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">assembly_integer</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.parse_assembly_json" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">parse_assembly_json</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">parse_assembly_json</span><span class="p">(</span><span class="n">assembly_json</span><span class="p">:</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n">list</span><span class="p">[</span><span class="n">str</span><span class="p">]]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>For a PDB API AssemblyID, parse the associated 'clustered' chains</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>assembly_json</code></b>
            (<code>dict[str, <span title="typing.Any">Any</span>]</code>)
        
        <div class="doc-md-description">
          <p>The json type dictionary returned from requests.Response.json()</p>
        </div>
      </li>
  </ul>
      <p>Returns:
    The chain ID's which cluster in the assembly -
    Ex: [['A', 'A', 'A', ...], ...]</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_assembly_json</span><span class="p">(</span><span class="n">assembly_json</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;For a PDB API AssemblyID, parse the associated &#39;clustered&#39; chains</span>

<span class="sd">    Args:</span>
<span class="sd">        assembly_json: The json type dictionary returned from requests.Response.json()</span>
<span class="sd">    Returns:</span>
<span class="sd">        The chain ID&#39;s which cluster in the assembly -</span>
<span class="sd">        Ex: [[&#39;A&#39;, &#39;A&#39;, &#39;A&#39;, ...], ...]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">entity_clustered_chains</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">assembly_json</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">entity_clustered_chains</span>

    <span class="k">for</span> <span class="n">symmetry</span> <span class="ow">in</span> <span class="n">assembly_json</span><span class="p">[</span><span class="s1">&#39;rcsb_struct_symmetry&#39;</span><span class="p">]:</span>
        <span class="c1"># symmetry contains:</span>
        <span class="c1"># {symbol: &quot;O&quot;, type: &#39;Octahedral, stoichiometry: [], oligomeric_state: &quot;Homo 24-mer&quot;, clusters: [],</span>
        <span class="c1">#  rotation_axes: [], kind: &quot;Global Symmetry&quot;}</span>
        <span class="k">for</span> <span class="n">cluster</span> <span class="ow">in</span> <span class="n">symmetry</span><span class="p">[</span><span class="s1">&#39;clusters&#39;</span><span class="p">]:</span>  <span class="c1"># [{}, ...]</span>
            <span class="c1"># CLUSTER_IDX is not a mapping to entity index...</span>
            <span class="c1"># cluster contains:</span>
            <span class="c1"># {members: [], avg_rmsd: 5.219512137974998e-14} which indicates how similar each member in the cluster is</span>
            <span class="n">entity_clustered_chains</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">member</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;asym_id&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">member</span> <span class="ow">in</span> <span class="n">cluster</span><span class="p">[</span><span class="s1">&#39;members&#39;</span><span class="p">]])</span>

    <span class="k">return</span> <span class="n">entity_clustered_chains</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.query_entry_id" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">query_entry_id</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">query_entry_id</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="requests.Response">Response</span></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Fetches the JSON object for the EntryID from the PDB API</p>
<p>The following information is returned:
All methods (SOLUTION NMR, ELECTRON MICROSCOPY, X-RAY DIFFRACTION) have the following keys:
{'rcsb_primary_citation', 'pdbx_vrpt_summary', 'pdbx_audit_revision_history', 'audit_author',
 'pdbx_database_status', 'rcsb_id', 'pdbx_audit_revision_details', 'struct_keywords',
 'rcsb_entry_container_identifiers', 'entry', 'rcsb_entry_info', 'struct', 'citation', 'exptl',
 'rcsb_accession_info'}
EM only keys:
{'em3d_fitting', 'em3d_fitting_list', 'em_image_recording', 'em_specimen', 'em_software', 'em_entity_assembly',
 'em_vitrification', 'em_single_particle_entity', 'em3d_reconstruction', 'em_experiment', 'pdbx_audit_support',
 'em_imaging', 'em_ctf_correction'}
Xray only keys:
{'diffrn_radiation', 'cell', 'reflns', 'diffrn', 'software', 'refine_hist', 'diffrn_source', 'exptl_crystal',
 'symmetry', 'diffrn_detector', 'refine', 'reflns_shell', 'exptl_crystal_grow'}
NMR only keys:
{'pdbx_nmr_exptl', 'pdbx_audit_revision_item', 'pdbx_audit_revision_category', 'pdbx_nmr_spectrometer',
 'pdbx_nmr_refine', 'pdbx_nmr_representative', 'pdbx_nmr_software', 'pdbx_nmr_exptl_sample_conditions',
 'pdbx_nmr_ensemble'}</p>
<p>entry_json['rcsb_entry_info'] =         {'assembly_count': 1, 'branched_entity_count': 0, 'cis_peptide_count': 3, 'deposited_atom_count': 8492,
    'deposited_model_count': 1, 'deposited_modeled_polymer_monomer_count': 989,
    'deposited_nonpolymer_entity_instance_count': 0, 'deposited_polymer_entity_instance_count': 6,
    'deposited_polymer_monomer_count': 1065, 'deposited_solvent_atom_count': 735,
    'deposited_unmodeled_polymer_monomer_count': 76, 'diffrn_radiation_wavelength_maximum': 0.9797,
    'diffrn_radiation_wavelength_minimum': 0.9797, 'disulfide_bond_count': 0, 'entity_count': 3,
    'experimental_method': 'X-ray', 'experimental_method_count': 1, 'inter_mol_covalent_bond_count': 0,
    'inter_mol_metalic_bond_count': 0, 'molecular_weight': 115.09, 'na_polymer_entity_types': 'Other',
    'nonpolymer_entity_count': 0, 'polymer_composition': 'heteromeric protein', 'polymer_entity_count': 2,
    'polymer_entity_count_dna': 0, 'polymer_entity_count_rna': 0, 'polymer_entity_count_nucleic_acid': 0,
    'polymer_entity_count_nucleic_acid_hybrid': 0, 'polymer_entity_count_protein': 2,
    'polymer_entity_taxonomy_count': 2, 'polymer_molecular_weight_maximum': 21.89,
    'polymer_molecular_weight_minimum': 16.47, 'polymer_monomer_count_maximum': 201,
    'polymer_monomer_count_minimum': 154, 'resolution_combined': [1.95],
    'selected_polymer_entity_types': 'Protein (only)',
    'software_programs_combined': ['PHASER', 'REFMAC', 'XDS', 'XSCALE'], 'solvent_entity_count': 1,
    'diffrn_resolution_high': {'provenance_source': 'Depositor assigned', 'value': 1.95}}</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>entry</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The PDB code to search for</p>
        </div>
      </li>
  </ul>
      <p>Returns:
    The entry information according to the PDB</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span>
<span class="normal">994</span>
<span class="normal">995</span>
<span class="normal">996</span>
<span class="normal">997</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">query_entry_id</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Fetches the JSON object for the EntryID from the PDB API</span>

<span class="sd">    The following information is returned:</span>
<span class="sd">    All methods (SOLUTION NMR, ELECTRON MICROSCOPY, X-RAY DIFFRACTION) have the following keys:</span>
<span class="sd">    {&#39;rcsb_primary_citation&#39;, &#39;pdbx_vrpt_summary&#39;, &#39;pdbx_audit_revision_history&#39;, &#39;audit_author&#39;,</span>
<span class="sd">     &#39;pdbx_database_status&#39;, &#39;rcsb_id&#39;, &#39;pdbx_audit_revision_details&#39;, &#39;struct_keywords&#39;,</span>
<span class="sd">     &#39;rcsb_entry_container_identifiers&#39;, &#39;entry&#39;, &#39;rcsb_entry_info&#39;, &#39;struct&#39;, &#39;citation&#39;, &#39;exptl&#39;,</span>
<span class="sd">     &#39;rcsb_accession_info&#39;}</span>
<span class="sd">    EM only keys:</span>
<span class="sd">    {&#39;em3d_fitting&#39;, &#39;em3d_fitting_list&#39;, &#39;em_image_recording&#39;, &#39;em_specimen&#39;, &#39;em_software&#39;, &#39;em_entity_assembly&#39;,</span>
<span class="sd">     &#39;em_vitrification&#39;, &#39;em_single_particle_entity&#39;, &#39;em3d_reconstruction&#39;, &#39;em_experiment&#39;, &#39;pdbx_audit_support&#39;,</span>
<span class="sd">     &#39;em_imaging&#39;, &#39;em_ctf_correction&#39;}</span>
<span class="sd">    Xray only keys:</span>
<span class="sd">    {&#39;diffrn_radiation&#39;, &#39;cell&#39;, &#39;reflns&#39;, &#39;diffrn&#39;, &#39;software&#39;, &#39;refine_hist&#39;, &#39;diffrn_source&#39;, &#39;exptl_crystal&#39;,</span>
<span class="sd">     &#39;symmetry&#39;, &#39;diffrn_detector&#39;, &#39;refine&#39;, &#39;reflns_shell&#39;, &#39;exptl_crystal_grow&#39;}</span>
<span class="sd">    NMR only keys:</span>
<span class="sd">    {&#39;pdbx_nmr_exptl&#39;, &#39;pdbx_audit_revision_item&#39;, &#39;pdbx_audit_revision_category&#39;, &#39;pdbx_nmr_spectrometer&#39;,</span>
<span class="sd">     &#39;pdbx_nmr_refine&#39;, &#39;pdbx_nmr_representative&#39;, &#39;pdbx_nmr_software&#39;, &#39;pdbx_nmr_exptl_sample_conditions&#39;,</span>
<span class="sd">     &#39;pdbx_nmr_ensemble&#39;}</span>

<span class="sd">    entry_json[&#39;rcsb_entry_info&#39;] = \</span>
<span class="sd">        {&#39;assembly_count&#39;: 1, &#39;branched_entity_count&#39;: 0, &#39;cis_peptide_count&#39;: 3, &#39;deposited_atom_count&#39;: 8492,</span>
<span class="sd">        &#39;deposited_model_count&#39;: 1, &#39;deposited_modeled_polymer_monomer_count&#39;: 989,</span>
<span class="sd">        &#39;deposited_nonpolymer_entity_instance_count&#39;: 0, &#39;deposited_polymer_entity_instance_count&#39;: 6,</span>
<span class="sd">        &#39;deposited_polymer_monomer_count&#39;: 1065, &#39;deposited_solvent_atom_count&#39;: 735,</span>
<span class="sd">        &#39;deposited_unmodeled_polymer_monomer_count&#39;: 76, &#39;diffrn_radiation_wavelength_maximum&#39;: 0.9797,</span>
<span class="sd">        &#39;diffrn_radiation_wavelength_minimum&#39;: 0.9797, &#39;disulfide_bond_count&#39;: 0, &#39;entity_count&#39;: 3,</span>
<span class="sd">        &#39;experimental_method&#39;: &#39;X-ray&#39;, &#39;experimental_method_count&#39;: 1, &#39;inter_mol_covalent_bond_count&#39;: 0,</span>
<span class="sd">        &#39;inter_mol_metalic_bond_count&#39;: 0, &#39;molecular_weight&#39;: 115.09, &#39;na_polymer_entity_types&#39;: &#39;Other&#39;,</span>
<span class="sd">        &#39;nonpolymer_entity_count&#39;: 0, &#39;polymer_composition&#39;: &#39;heteromeric protein&#39;, &#39;polymer_entity_count&#39;: 2,</span>
<span class="sd">        &#39;polymer_entity_count_dna&#39;: 0, &#39;polymer_entity_count_rna&#39;: 0, &#39;polymer_entity_count_nucleic_acid&#39;: 0,</span>
<span class="sd">        &#39;polymer_entity_count_nucleic_acid_hybrid&#39;: 0, &#39;polymer_entity_count_protein&#39;: 2,</span>
<span class="sd">        &#39;polymer_entity_taxonomy_count&#39;: 2, &#39;polymer_molecular_weight_maximum&#39;: 21.89,</span>
<span class="sd">        &#39;polymer_molecular_weight_minimum&#39;: 16.47, &#39;polymer_monomer_count_maximum&#39;: 201,</span>
<span class="sd">        &#39;polymer_monomer_count_minimum&#39;: 154, &#39;resolution_combined&#39;: [1.95],</span>
<span class="sd">        &#39;selected_polymer_entity_types&#39;: &#39;Protein (only)&#39;,</span>
<span class="sd">        &#39;software_programs_combined&#39;: [&#39;PHASER&#39;, &#39;REFMAC&#39;, &#39;XDS&#39;, &#39;XSCALE&#39;], &#39;solvent_entity_count&#39;: 1,</span>
<span class="sd">        &#39;diffrn_resolution_high&#39;: {&#39;provenance_source&#39;: &#39;Depositor assigned&#39;, &#39;value&#39;: 1.95}}</span>

<span class="sd">    Args:</span>
<span class="sd">        entry: The PDB code to search for</span>
<span class="sd">    Returns:</span>
<span class="sd">        The entry information according to the PDB</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">entry</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">connection_exception_handler</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pdb_rest_url</span><span class="si">}</span><span class="s1">/entry/</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.parse_entry_json" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">parse_entry_json</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">parse_entry_json</span><span class="p">(</span><span class="n">entry_json</span><span class="p">:</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n">dict</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>For a PDB API EntryID, parse the associated entity ID's and chains</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>entry_json</code></b>
            (<code>dict[str, <span title="typing.Any">Any</span>]</code>)
        
        <div class="doc-md-description">
          <p>The json type dictionary returned from requests.Response.json()</p>
        </div>
      </li>
  </ul>
      <p>Returns:
    The structural information present in the PDB EntryID with format -
    {'method': xray,
     'res': resolution,
     'struct': {'space': space_group, 'a_b_c': (a, b, c), 'ang_a_b_c': (ang_a, ang_b, ang_c)}
     }</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_entry_json</span><span class="p">(</span><span class="n">entry_json</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;For a PDB API EntryID, parse the associated entity ID&#39;s and chains</span>

<span class="sd">    Args:</span>
<span class="sd">        entry_json: The json type dictionary returned from requests.Response.json()</span>
<span class="sd">    Returns:</span>
<span class="sd">        The structural information present in the PDB EntryID with format -</span>
<span class="sd">        {&#39;method&#39;: xray,</span>
<span class="sd">         &#39;res&#39;: resolution,</span>
<span class="sd">         &#39;struct&#39;: {&#39;space&#39;: space_group, &#39;a_b_c&#39;: (a, b, c), &#39;ang_a_b_c&#39;: (ang_a, ang_b, ang_c)}</span>
<span class="sd">         }</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">experimental_method</span> <span class="o">=</span> <span class="n">entry_json</span><span class="p">[</span><span class="s1">&#39;rcsb_entry_info&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;experimental_method&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">experimental_method</span><span class="p">:</span>
        <span class="c1"># Todo make ray, diffraction</span>
        <span class="k">if</span> <span class="s1">&#39;ray&#39;</span> <span class="ow">in</span> <span class="n">experimental_method</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">and</span> <span class="s1">&#39;cell&#39;</span> <span class="ow">in</span> <span class="n">entry_json</span> <span class="ow">and</span> <span class="s1">&#39;symmetry&#39;</span> <span class="ow">in</span> <span class="n">entry_json</span><span class="p">:</span>
            <span class="n">cell</span> <span class="o">=</span> <span class="n">entry_json</span><span class="p">[</span><span class="s1">&#39;cell&#39;</span><span class="p">]</span>
            <span class="n">ang_a</span><span class="p">,</span> <span class="n">ang_b</span><span class="p">,</span> <span class="n">ang_c</span> <span class="o">=</span> <span class="n">cell</span><span class="p">[</span><span class="s1">&#39;angle_alpha&#39;</span><span class="p">],</span> <span class="n">cell</span><span class="p">[</span><span class="s1">&#39;angle_beta&#39;</span><span class="p">],</span> <span class="n">cell</span><span class="p">[</span><span class="s1">&#39;angle_gamma&#39;</span><span class="p">]</span>
            <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">cell</span><span class="p">[</span><span class="s1">&#39;length_a&#39;</span><span class="p">],</span> <span class="n">cell</span><span class="p">[</span><span class="s1">&#39;length_b&#39;</span><span class="p">],</span> <span class="n">cell</span><span class="p">[</span><span class="s1">&#39;length_c&#39;</span><span class="p">]</span>
            <span class="n">space_group</span> <span class="o">=</span> <span class="n">entry_json</span><span class="p">[</span><span class="s1">&#39;symmetry&#39;</span><span class="p">][</span><span class="s1">&#39;space_group_name_hm&#39;</span><span class="p">]</span>
            <span class="n">struct_d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;space&#39;</span><span class="p">:</span> <span class="n">space_group</span><span class="p">,</span> <span class="s1">&#39;a_b_c&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="s1">&#39;ang_a_b_c&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">ang_a</span><span class="p">,</span> <span class="n">ang_b</span><span class="p">,</span> <span class="n">ang_c</span><span class="p">)}</span>
            <span class="n">resolution</span> <span class="o">=</span> <span class="n">entry_json</span><span class="p">[</span><span class="s1">&#39;rcsb_entry_info&#39;</span><span class="p">][</span><span class="s1">&#39;resolution_combined&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">experimental_method</span> <span class="o">==</span> <span class="s1">&#39;EM&#39;</span><span class="p">:</span>
            <span class="c1"># em_keys = {</span>
            <span class="c1">#     &#39;em3d_fitting&#39;: [{&#39;id&#39;: &#39;1&#39;, &#39;ref_protocol&#39;: &#39;RIGID BODY FIT&#39;, &#39;ref_space&#39;: &#39;REAL&#39;}]</span>
            <span class="c1">#     &#39;em3d_fitting_list&#39;: [{&#39;id&#39;: &#39;1&#39;, &#39;pdb_entry_id&#39;: &#39;4ZK7&#39;, &#39;3d_fitting_id&#39;: &#39;1&#39;}]</span>
            <span class="c1">#     &#39;em3d_reconstruction&#39;: [{&#39;algorithm&#39;: &#39;BACK PROJECTION&#39;, &#39;id&#39;: &#39;1&#39;, &#39;image_processing_id&#39;: &#39;1&#39;, &#39;num_class_averages&#39;: 1, &#39;num_particles&#39;: 110369, &#39;resolution&#39;: 2.9, &#39;resolution_method&#39;: &#39;FSC 0.143 CUT-OFF&#39;, &#39;symmetry_type&#39;: &#39;POINT&#39;}]</span>
            <span class="c1">#     &#39;em_ctf_correction&#39;: [{&#39;em_image_processing_id&#39;: &#39;1&#39;, &#39;id&#39;: &#39;1&#39;, &#39;type&#39;: &#39;PHASE FLIPPING AND AMPLITUDE CORRECTION&#39;}]</span>
            <span class="c1">#     &#39;em_entity_assembly&#39;: [{&#39;details&#39;: &#39;The map was generated by focused refinement of BG505 SOSIP-T33-31 nanoparticle dataset using a mask around the T33-31 nanoparticle core (masking out the flexibly linked antigens).&#39;, &#39;entity_id_list&#39;: [&#39;1&#39;, &#39;2&#39;], &#39;id&#39;: &#39;1&#39;, &#39;name&#39;: &#39;Designed tetrahedral nanoparticle BG505 SOSIP-T33-31&#39;, &#39;parent_id&#39;: 0, &#39;source&#39;: &#39;RECOMBINANT&#39;, &#39;type&#39;: &#39;COMPLEX&#39;}]</span>
            <span class="c1">#     &#39;em_experiment&#39;: {&#39;aggregation_state&#39;: &#39;PARTICLE&#39;, &#39;entity_assembly_id&#39;: &#39;1&#39;, &#39;id&#39;: &#39;1&#39;, &#39;reconstruction_method&#39;: &#39;SINGLE PARTICLE&#39;}</span>
            <span class="c1">#     &#39;em_image_recording&#39;: [{&#39;average_exposure_time&#39;: 10.25, &#39;avg_electron_dose_per_image&#39;: 50.0, &#39;detector_mode&#39;: &#39;COUNTING&#39;, &#39;film_or_detector_model&#39;: &#39;GATAN K2 SUMMIT (4k x 4k)&#39;, &#39;id&#39;: &#39;1&#39;, &#39;imaging_id&#39;: &#39;1&#39;, &#39;num_grids_imaged&#39;: 2, &#39;num_real_images&#39;: 1751}]</span>
            <span class="c1">#     &#39;em_imaging&#39;: [{&#39;accelerating_voltage&#39;: 200, &#39;alignment_procedure&#39;: &#39;BASIC&#39;, &#39;c2_aperture_diameter&#39;: 70.0, &#39;cryogen&#39;: &#39;NITROGEN&#39;, &#39;electron_source&#39;: &#39;FIELD EMISSION GUN&#39;, &#39;id&#39;: &#39;1&#39;, &#39;illumination_mode&#39;: &#39;FLOOD BEAM&#39;, &#39;microscope_model&#39;: &#39;FEI TALOS ARCTICA&#39;, &#39;mode&#39;: &#39;BRIGHT FIELD&#39;, &#39;nominal_cs&#39;: 2.7, &#39;nominal_defocus_max&#39;: 2000.0, &#39;nominal_defocus_min&#39;: 800.0, &#39;nominal_magnification&#39;: 36000, &#39;specimen_holder_model&#39;: &#39;OTHER&#39;, &#39;specimen_id&#39;: &#39;1&#39;}]</span>
            <span class="c1">#     &#39;em_particle_selection&#39;: [{&#39;details&#39;: &#39;Gaussian picker in Relion/3.0&#39;, &#39;id&#39;: &#39;1&#39;, &#39;image_processing_id&#39;: &#39;1&#39;, &#39;num_particles_selected&#39;: 223099}]</span>
            <span class="c1">#     &#39;em_single_particle_entity&#39;: [{&#39;id&#39;: 1, &#39;image_processing_id&#39;: &#39;1&#39;, &#39;point_symmetry&#39;: &#39;T&#39;}]</span>
            <span class="c1">#     &#39;em_software&#39;: [{&#39;category&#39;: &#39;PARTICLE SELECTION&#39;, &#39;id&#39;: &#39;1&#39;, &#39;image_processing_id&#39;: &#39;1&#39;, &#39;name&#39;: &#39;RELION&#39;, &#39;version&#39;: &#39;3.0&#39;}, {&#39;category&#39;: &#39;IMAGE ACQUISITION&#39;, &#39;id&#39;: &#39;2&#39;, &#39;imaging_id&#39;: &#39;1&#39;, &#39;name&#39;: &#39;Leginon&#39;}, {&#39;category&#39;: &#39;MASKING&#39;, &#39;id&#39;: &#39;3&#39;}, {&#39;category&#39;: &#39;CTF CORRECTION&#39;, &#39;id&#39;: &#39;4&#39;, &#39;image_processing_id&#39;: &#39;1&#39;, &#39;name&#39;: &#39;RELION&#39;, &#39;version&#39;: &#39;3.0&#39;}, {&#39;category&#39;: &#39;LAYERLINE INDEXING&#39;, &#39;id&#39;: &#39;5&#39;}, {&#39;category&#39;: &#39;DIFFRACTION INDEXING&#39;, &#39;id&#39;: &#39;6&#39;}, {&#39;category&#39;: &#39;MODEL FITTING&#39;, &#39;fitting_id&#39;: &#39;1&#39;, &#39;id&#39;: &#39;7&#39;, &#39;name&#39;: &#39;UCSF Chimera&#39;}, {&#39;category&#39;: &#39;OTHER&#39;, &#39;id&#39;: &#39;8&#39;}, {&#39;category&#39;: &#39;INITIAL EULER ASSIGNMENT&#39;, &#39;id&#39;: &#39;9&#39;, &#39;image_processing_id&#39;: &#39;1&#39;, &#39;name&#39;: &#39;RELION&#39;, &#39;version&#39;: &#39;3.0&#39;}, {&#39;category&#39;: &#39;FINAL EULER ASSIGNMENT&#39;, &#39;id&#39;: &#39;10&#39;, &#39;image_processing_id&#39;: &#39;1&#39;, &#39;name&#39;: &#39;RELION&#39;, &#39;version&#39;: &#39;3.0&#39;}, {&#39;category&#39;: &#39;CLASSIFICATION&#39;, &#39;id&#39;: &#39;11&#39;, &#39;image_processing_id&#39;: &#39;1&#39;, &#39;name&#39;: &#39;RELION&#39;, &#39;version&#39;: &#39;3.0&#39;}, {&#39;category&#39;: &#39;RECONSTRUCTION&#39;, &#39;id&#39;: &#39;12&#39;, &#39;image_processing_id&#39;: &#39;1&#39;, &#39;name&#39;: &#39;RELION&#39;, &#39;version&#39;: &#39;3.0&#39;}, {&#39;category&#39;: &#39;MODEL REFINEMENT&#39;, &#39;fitting_id&#39;: &#39;1&#39;, &#39;id&#39;: &#39;13&#39;, &#39;name&#39;: &#39;Coot&#39;}, {&#39;category&#39;: &#39;MODEL REFINEMENT&#39;, &#39;fitting_id&#39;: &#39;1&#39;, &#39;id&#39;: &#39;14&#39;, &#39;name&#39;: &#39;RosettaEM&#39;}]</span>
            <span class="c1">#     &#39;em_specimen&#39;: [{&#39;concentration&#39;: 4.1, &#39;details&#39;: &#39;BG505 SOSIP-T33-31 nanoparticle was prepared by combining equimolar amounts of BG505 SOSIP-T33-31A and BG505 SOSIP-T33-31B components that were expressed separately.&#39;, &#39;embedding_applied&#39;: &#39;NO&#39;, &#39;experiment_id&#39;: &#39;1&#39;, &#39;id&#39;: &#39;1&#39;, &#39;shadowing_applied&#39;: &#39;NO&#39;, &#39;staining_applied&#39;: &#39;NO&#39;, &#39;vitrification_applied&#39;: &#39;YES&#39;}]</span>
            <span class="c1">#     &#39;em_vitrification&#39;: [{&#39;chamber_temperature&#39;: 283.0, &#39;cryogen_name&#39;: &#39;ETHANE&#39;, &#39;details&#39;: &#39;Blotting time varied between 3 and 7 seconds.&#39;, &#39;humidity&#39;: 100.0, &#39;id&#39;: &#39;1&#39;, &#39;instrument&#39;: &#39;FEI VITROBOT MARK IV&#39;, &#39;specimen_id&#39;: &#39;1&#39;}]</span>
            <span class="c1"># }</span>
            <span class="c1"># for key in em_keys:</span>
            <span class="c1">#     print(entry_json.get(key))</span>
            <span class="n">struct_d</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="c1"># Access the first entry in the list with [0] v</span>
            <span class="n">resolution</span> <span class="o">=</span> <span class="n">entry_json</span><span class="p">[</span><span class="s1">&#39;em3d_reconstruction&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s1">&#39;resolution&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Todo NMR</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No useful information added with the experimental method </span><span class="si">{</span><span class="n">experimental_method</span><span class="si">}</span><span class="s2"> as &quot;</span>
                           <span class="s2">&quot;this method hasn&#39;t been explored yet&quot;</span><span class="p">)</span>
            <span class="n">struct_d</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">resolution</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Entry has no &quot;experimental_method&quot; keyword&#39;</span><span class="p">)</span>
        <span class="n">struct_d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">resolution</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;res&#39;</span><span class="p">:</span> <span class="n">resolution</span><span class="p">,</span> <span class="s1">&#39;struct&#39;</span><span class="p">:</span> <span class="n">struct_d</span><span class="p">,</span> <span class="s1">&#39;method&#39;</span><span class="p">:</span> <span class="n">experimental_method</span><span class="o">.</span><span class="n">lower</span><span class="p">()}</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.format_symmetry_group" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">format_symmetry_group</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">format_symmetry_group</span><span class="p">(</span><span class="n">symmetry</span><span class="p">:</span> <span class="n">str</span><span class="p">,</span> <span class="n">homomeric_number</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">heteromeric_number</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">str</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return a PDB API length limitation query</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>symmetry</code></b>
            (<code>str</code>)
        
        <div class="doc-md-description">
          <p>The symmetry to query for</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>homomeric_number</code></b>
            (<code>int</code>, default:
                <code>1</code>
)
        
        <div class="doc-md-description">
          <p>If the symmetry desired is homomeric, how many copies of the entity are desired</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>heteromeric_number</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>If the symmetry desired is heteromeric, how many entities are present</p>
        </div>
      </li>
  </ul>
      <p>Returns:
    The symmetry formatted query limiting entity searches to the described symmetry</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">format_symmetry_group</span><span class="p">(</span><span class="n">symmetry</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">homomeric_number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">heteromeric_number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a PDB API length limitation query</span>

<span class="sd">    Args:</span>
<span class="sd">        symmetry: The symmetry to query for</span>
<span class="sd">        homomeric_number: If the symmetry desired is homomeric, how many copies of the entity are desired</span>
<span class="sd">        heteromeric_number: If the symmetry desired is heteromeric, how many entities are present</span>
<span class="sd">    Returns:</span>
<span class="sd">        The symmetry formatted query limiting entity searches to the described symmetry</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s1">&#39;c&#39;</span> <span class="ow">in</span> <span class="n">symmetry</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
        <span class="n">symmetry_query</span> <span class="o">=</span> <span class="n">cyclic_symmetry_limiting_group</span> <span class="o">%</span> <span class="n">symmetry</span>
    <span class="k">elif</span> <span class="s1">&#39;d&#39;</span> <span class="ow">in</span> <span class="n">symmetry</span><span class="o">.</span><span class="n">lower</span><span class="p">():</span>
        <span class="n">symmetry_query</span> <span class="o">=</span> <span class="n">dihedral_symmetry_limiting_group</span> <span class="o">%</span> <span class="n">symmetry</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># point group symmetry</span>
        <span class="n">symmetry_query</span> <span class="o">=</span> <span class="n">point_symmetry_limiting_group</span> <span class="o">%</span> <span class="n">symmetry</span>

    <span class="n">symmetry_number</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">symmetry</span><span class="o">.</span><span class="n">valid_subunit_number</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">symmetry</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">heteromeric_number</span><span class="p">:</span>
        <span class="n">symmetry_query</span> <span class="o">+=</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="n">heteromer_termini</span> <span class="o">%</span> <span class="n">symmetry_number</span> <span class="o">*</span> <span class="n">heteromeric_number</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># if homomer:</span>
        <span class="n">symmetry_query</span> <span class="o">+=</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="n">homomer_termini</span> <span class="o">%</span> <span class="n">symmetry_number</span> <span class="o">*</span> <span class="n">homomeric_number</span>
    <span class="c1"># else:</span>
    <span class="c1">#     raise ValueError(&quot;Must provide either &#39;homomeric_number&#39; or &#39;heteromeric_number&#39;&quot;)</span>

    <span class="k">return</span> <span class="n">symmetry_query</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.format_length_group" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">format_length_group</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">format_length_group</span><span class="p">(</span><span class="n">lower</span><span class="p">:</span> <span class="n">int</span><span class="p">,</span> <span class="n">upper</span><span class="p">:</span> <span class="n">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">str</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return a PDB API length limitation query</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>lower</code></b>
            (<code>int</code>)
        
        <div class="doc-md-description">
          <p>The low end to limit entity length</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>upper</code></b>
            (<code>int</code>)
        
        <div class="doc-md-description">
          <p>The upper limit on entity length</p>
        </div>
      </li>
  </ul>
      <p>Returns:
    The length formatted query limiting entity searches to between the values lower and upper (non-inclusive)</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">format_length_group</span><span class="p">(</span><span class="n">lower</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">upper</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a PDB API length limitation query</span>

<span class="sd">    Args:</span>
<span class="sd">        lower: The low end to limit entity length</span>
<span class="sd">        upper: The upper limit on entity length</span>
<span class="sd">    Returns:</span>
<span class="sd">        The length formatted query limiting entity searches to between the values lower and upper (non-inclusive)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">length_group</span> <span class="o">%</span> <span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.nanohedra_building_blocks_query" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">nanohedra_building_blocks_query</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">nanohedra_building_blocks_query</span><span class="p">(</span><span class="n">symmetry</span><span class="p">:</span> <span class="n">str</span><span class="p">,</span> <span class="n">lower</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">upper</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">thermophile</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">return_groups</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">limit_by_groups</span><span class="p">:</span> <span class="n"><span title="collections.abc.Iterable">Iterable</span></span><span class="p">[</span><span class="n">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">search_by_groups</span><span class="p">:</span> <span class="n"><span title="collections.abc.Iterable">Iterable</span></span><span class="p">[</span><span class="n">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dict</span><span class="p">[</span><span class="n"><span title="typing.Any">Any</span></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Retrieve symmetric oligomers from the PDB to act as building blocks for nanohedra docking</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>symmetry</code></b>
            (<code>str</code>)
        
        <div class="doc-md-description">
          <p>The symmetry to query for</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>lower</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The low end to limit entity length</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>upper</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The upper limit on entity length</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>thermophile</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        
        <div class="doc-md-description">
          <p>Whether to limit search to entries from thermophilic species</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>return_groups</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        
        <div class="doc-md-description">
          <p>Whether to return results as groupID's</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>limit_by_groups</code></b>
            (<code><span title="collections.abc.Iterable">Iterable</span>[str]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>Whether to limit the query, i.e. not return groupID's that are provided in this argument</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>search_by_groups</code></b>
            (<code><span title="collections.abc.Iterable">Iterable</span>[str]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>Search only for groupID's that are provided to this argument</p>
        </div>
      </li>
  </ul>
      <p>Returns:
    Matching EntityID's formatted as a dictionary from the JSON formatted response or None if the query failed</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span>
<span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">nanohedra_building_blocks_query</span><span class="p">(</span>
        <span class="n">symmetry</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lower</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">upper</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">thermophile</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">return_groups</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">limit_by_groups</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">search_by_groups</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve symmetric oligomers from the PDB to act as building blocks for nanohedra docking</span>

<span class="sd">    Args:</span>
<span class="sd">        symmetry: The symmetry to query for</span>
<span class="sd">        lower: The low end to limit entity length</span>
<span class="sd">        upper: The upper limit on entity length</span>
<span class="sd">        thermophile: Whether to limit search to entries from thermophilic species</span>
<span class="sd">        return_groups: Whether to return results as groupID&#39;s</span>
<span class="sd">        limit_by_groups: Whether to limit the query, i.e. not return groupID&#39;s that are provided in this argument</span>
<span class="sd">        search_by_groups: Search only for groupID&#39;s that are provided to this argument</span>
<span class="sd">    Returns:</span>
<span class="sd">        Matching EntityID&#39;s formatted as a dictionary from the JSON formatted response or None if the query failed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">groups_and_terminal</span> <span class="o">=</span> <span class="n">common_quality_filters</span> \
        <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="n">format_symmetry_group</span><span class="p">(</span><span class="n">symmetry</span><span class="p">)</span> \
        <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="n">format_length_group</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">thermophile</span><span class="p">:</span>
        <span class="n">groups_and_terminal</span> <span class="o">+=</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="n">thermophilic_json_terminal_operator</span>
    <span class="k">if</span> <span class="n">limit_by_groups</span><span class="p">:</span>
        <span class="n">groups_and_terminal</span> <span class="o">+=</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="n">not_in_entity_group_id_search_block</span> \
                               <span class="o">%</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">id_</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">id_</span> <span class="ow">in</span> <span class="n">limit_by_groups</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">search_by_groups</span><span class="p">:</span>
        <span class="n">groups_and_terminal</span> <span class="o">+=</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="n">in_entity_group_id_search_block</span> \
                               <span class="o">%</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">id_</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">id_</span> <span class="ow">in</span> <span class="n">search_by_groups</span><span class="p">])</span>

    <span class="n">building_block_query</span> <span class="o">=</span> <span class="n">and_group_query</span> <span class="o">%</span> <span class="n">groups_and_terminal</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Found building_block_query: </span><span class="si">{</span><span class="n">building_block_query</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">formatted_query</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">building_block_query</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">query_pdb</span><span class="p">(</span><span class="n">generate_query</span><span class="p">(</span><span class="n">formatted_query</span><span class="p">,</span> <span class="n">return_id</span><span class="o">=</span><span class="s1">&#39;polymer_entity&#39;</span><span class="p">,</span>
                                    <span class="n">cluster_sequence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">return_groups</span><span class="o">=</span><span class="n">return_groups</span><span class="p">,</span> <span class="n">all_matching</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.find_author_confirmed_assembly_from_entity_group" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">find_author_confirmed_assembly_from_entity_group</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">find_author_confirmed_assembly_from_entity_group</span><span class="p">(</span><span class="n">group_ids</span><span class="p">:</span> <span class="n"><span title="collections.abc.Iterable">Iterable</span></span><span class="p">[</span><span class="n">str</span><span class="p">],</span> <span class="n">symmetry</span><span class="p">:</span> <span class="n">str</span><span class="p">,</span> <span class="n">lower</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">upper</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dict</span><span class="p">[</span><span class="n"><span title="typing.Any">Any</span></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>For specific groupID's, request all EntityID's that have an assembly confirmed by depositing authors from PDB API</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>group_ids</code></b>
            (<code><span title="collections.abc.Iterable">Iterable</span>[str]</code>)
        
        <div class="doc-md-description">
          <p>The groupID's to limit search to</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>symmetry</code></b>
            (<code>str</code>)
        
        <div class="doc-md-description">
          <p>The symmetry to query for</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>lower</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The low end to limit entity length</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>upper</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The upper limit on entity length</p>
        </div>
      </li>
  </ul>
      <p>Returns:
    Matching AssemblyID's formatted as a dictionary from the JSON formatted response or None if the query failed</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">find_author_confirmed_assembly_from_entity_group</span><span class="p">(</span>
        <span class="n">group_ids</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="n">symmetry</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">lower</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">upper</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;For specific groupID&#39;s, request all EntityID&#39;s that have an assembly confirmed by depositing authors from PDB API</span>

<span class="sd">    Args:</span>
<span class="sd">        group_ids: The groupID&#39;s to limit search to</span>
<span class="sd">        symmetry: The symmetry to query for</span>
<span class="sd">        lower: The low end to limit entity length</span>
<span class="sd">        upper: The upper limit on entity length</span>
<span class="sd">    Returns:</span>
<span class="sd">        Matching AssemblyID&#39;s formatted as a dictionary from the JSON formatted response or None if the query failed</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">groups_and_terminal</span> <span class="o">=</span> <span class="n">common_quality_filters</span> \
        <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="n">format_symmetry_group</span><span class="p">(</span><span class="n">symmetry</span><span class="p">)</span> \
        <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="n">format_length_group</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">)</span> \
        <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="n">assembly_author_defined</span> \
        <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="n">in_entity_group_id_search_block</span> <span class="o">%</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;&quot;</span><span class="si">{</span><span class="n">id_</span><span class="si">}</span><span class="s1">&quot;&#39;</span> <span class="k">for</span> <span class="n">id_</span> <span class="ow">in</span> <span class="n">group_ids</span><span class="p">])</span>
    <span class="n">author_confirmed_query</span> <span class="o">=</span> <span class="n">and_group_query</span> <span class="o">%</span> <span class="n">groups_and_terminal</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Found author_confirmed_query: </span><span class="si">{</span><span class="n">author_confirmed_query</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">formatted_query</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">author_confirmed_query</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">query_pdb</span><span class="p">(</span><span class="n">generate_query</span><span class="p">(</span><span class="n">formatted_query</span><span class="p">,</span> <span class="n">return_id</span><span class="o">=</span><span class="s1">&#39;assembly&#39;</span><span class="p">,</span> <span class="n">all_matching</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.solve_author_confirmed_assemblies" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">solve_author_confirmed_assemblies</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">solve_author_confirmed_assemblies</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n"><span title="resources.query.pdb.QueryParams">QueryParams</span></span><span class="p">,</span> <span class="n">grouped_entity_ids</span><span class="p">:</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n">list</span><span class="p">[</span><span class="n">str</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">tuple</span><span class="p">[</span><span class="n">list</span><span class="p">[</span><span class="n">str</span><span class="p">],</span> <span class="n">list</span><span class="p">[</span><span class="n">str</span><span class="p">]]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>From a map of Entity group ID's to resolution sorted EntityIDs, solve for those EntityIDs that have an assembly</p>
<p>First search for QSbio confirmed assemblies, then search the PDB API for 'author_defined_assembly' and
'author_and_software_defined_assembly'</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>params</code></b>
            (<code><span title="resources.query.pdb.QueryParams">QueryParams</span></code>)
        
        <div class="doc-md-description">
          <p>The parameter profile specified for the search procedure</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>grouped_entity_ids</code></b>
            (<code>dict[str, list[str]]</code>)
        
        <div class="doc-md-description">
          <p>A dictionary mapping groupID to EntryID's</p>
        </div>
      </li>
  </ul>
      <p>Returns:
    A tuple of the objects (
        The best EntityIDs according to incoming sorting and that pass the assembly test
        The Entity group ID of those groups that couldn't be solved
    )</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">solve_author_confirmed_assemblies</span><span class="p">(</span><span class="n">params</span><span class="p">:</span> <span class="n">QueryParams</span><span class="p">,</span> <span class="n">grouped_entity_ids</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]])</span> \
        <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;From a map of Entity group ID&#39;s to resolution sorted EntityIDs, solve for those EntityIDs that have an assembly</span>

<span class="sd">    First search for QSbio confirmed assemblies, then search the PDB API for &#39;author_defined_assembly&#39; and</span>
<span class="sd">    &#39;author_and_software_defined_assembly&#39;</span>

<span class="sd">    Args:</span>
<span class="sd">        params: The parameter profile specified for the search procedure</span>
<span class="sd">        grouped_entity_ids: A dictionary mapping groupID to EntryID&#39;s</span>
<span class="sd">    Returns:</span>
<span class="sd">        A tuple of the objects (</span>
<span class="sd">            The best EntityIDs according to incoming sorting and that pass the assembly test</span>
<span class="sd">            The Entity group ID of those groups that couldn&#39;t be solved</span>
<span class="sd">        )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check if the top thermophilic ids are actually bona-fide assemblies</span>
    <span class="n">top_entity_ids</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># If they aren&#39;t, then solve by PDB API query</span>
    <span class="n">solve_group_by_pdb</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">group_id</span><span class="p">,</span> <span class="n">entity_ids</span> <span class="ow">in</span> <span class="n">grouped_entity_ids</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">group_assemblies</span> <span class="o">=</span> <span class="p">[</span><span class="n">qsbio_confirmed</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">id_</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">())</span> <span class="k">for</span> <span class="n">id_</span> <span class="ow">in</span> <span class="n">entity_ids</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">id_</span><span class="p">,</span> <span class="n">assembly</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">entity_ids</span><span class="p">,</span> <span class="n">group_assemblies</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">assembly</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">top_entity_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">id_</span><span class="p">)</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># No assemblies are qsbio_confirmed</span>
            <span class="c1"># Solve by PDB assembly inference</span>
            <span class="n">solve_group_by_pdb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group_id</span><span class="p">)</span>
            <span class="n">top_entity_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

    <span class="n">author_confirmed_assembly_result</span> <span class="o">=</span> \
        <span class="n">find_author_confirmed_assembly_from_entity_group</span><span class="p">(</span>
            <span class="n">solve_group_by_pdb</span><span class="p">,</span> <span class="n">params</span><span class="o">.</span><span class="n">symmetry</span><span class="p">,</span> <span class="n">params</span><span class="o">.</span><span class="n">lower_length</span><span class="p">,</span> <span class="n">params</span><span class="o">.</span><span class="n">upper_length</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">author_confirmed_assembly_result</span><span class="p">:</span>
        <span class="n">author_confirmed_assembly_ids</span> <span class="o">=</span> <span class="n">parse_pdb_response_for_ids</span><span class="p">(</span><span class="n">author_confirmed_assembly_result</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">author_confirmed_assembly_ids</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Limit AssemblyID&#39;s to EntryID&#39;s</span>
    <span class="n">author_confirmed_entry_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">id_</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="k">for</span> <span class="n">id_</span> <span class="ow">in</span> <span class="n">author_confirmed_assembly_ids</span><span class="p">]</span>
    <span class="n">remove_group_ids</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">remove_group_indices</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># For orphaned groups, find and fit author confirmed assemblies in their corresponding groups</span>
    <span class="k">for</span> <span class="n">group_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">top_id</span><span class="p">,</span> <span class="n">group_id</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">top_entity_ids</span><span class="p">,</span> <span class="n">grouped_entity_ids</span><span class="o">.</span><span class="n">keys</span><span class="p">())):</span>
        <span class="k">if</span> <span class="n">top_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">entity_id</span> <span class="ow">in</span> <span class="n">grouped_entity_ids</span><span class="p">[</span><span class="n">group_id</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">entity_id</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="ow">in</span> <span class="n">author_confirmed_entry_ids</span><span class="p">:</span>
                    <span class="n">top_entity_ids</span><span class="p">[</span><span class="n">group_idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">entity_id</span>
                    <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># This still isn&#39;t solved. Remove from the pool</span>
                <span class="n">remove_group_ids</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group_id</span><span class="p">)</span>
                <span class="n">remove_group_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group_idx</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">group_idx</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">remove_group_indices</span><span class="p">):</span>
        <span class="n">top_entity_ids</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">group_idx</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">top_entity_ids</span><span class="p">,</span> <span class="n">remove_group_ids</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.entity_thermophilicity" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">entity_thermophilicity</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">entity_thermophilicity</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_integer</span><span class="p">:</span> <span class="n">int</span> <span class="o">|</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_id</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">float</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Query the PDB API for an EntityID and return the associated chains and reference dictionary</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>entry</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The 4 character PDB EntryID of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>entity_integer</code></b>
            (<code>int | str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The entity integer from the EntryID of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>entity_id</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The PDB formatted EntityID. Has the format EntryID_Integer (1ABC_1)</p>
        </div>
      </li>
  </ul>
      <p>Returns:
    Value ranging from 0-1 where 1 is completely thermophilic according to taxonomic classification</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">entity_thermophilicity</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_integer</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query the PDB API for an EntityID and return the associated chains and reference dictionary</span>

<span class="sd">    Args:</span>
<span class="sd">        entry: The 4 character PDB EntryID of interest</span>
<span class="sd">        entity_integer: The entity integer from the EntryID of interest</span>
<span class="sd">        entity_id: The PDB formatted EntityID. Has the format EntryID_Integer (1ABC_1)</span>
<span class="sd">    Returns:</span>
<span class="sd">        Value ranging from 0-1 where 1 is completely thermophilic according to taxonomic classification</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">entity_request</span> <span class="o">=</span> <span class="n">query_entity_id</span><span class="p">(</span><span class="n">entry</span><span class="o">=</span><span class="n">entry</span><span class="p">,</span> <span class="n">entity_integer</span><span class="o">=</span><span class="n">entity_integer</span><span class="p">,</span> <span class="n">entity_id</span><span class="o">=</span><span class="n">entity_id</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">entity_request</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">thermophilicity_from_entity_json</span><span class="p">(</span><span class="n">entity_request</span><span class="o">.</span><span class="n">json</span><span class="p">())</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.thermophilicity_from_entity_json" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">thermophilicity_from_entity_json</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">thermophilicity_from_entity_json</span><span class="p">(</span><span class="n">entity_json</span><span class="p">:</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the extent to which the entity json entry in question is thermophilic</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>entity_json</code></b>
            (<code>dict[str, <span title="typing.Any">Any</span>]</code>)
        
        <div class="doc-md-description">
          <p>The return json from PDB API query</p>
        </div>
      </li>
  </ul>
      <p>Returns:
    Value ranging from 0-1 where 1 is completely thermophilic</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span>
<span class="normal">1791</span>
<span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">thermophilicity_from_entity_json</span><span class="p">(</span><span class="n">entity_json</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the extent to which the entity json entry in question is thermophilic</span>

<span class="sd">    Args:</span>
<span class="sd">        entity_json: The return json from PDB API query</span>
<span class="sd">    Returns:</span>
<span class="sd">        Value ranging from 0-1 where 1 is completely thermophilic</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">thermophilic_source</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">organism</span> <span class="ow">in</span> <span class="n">entity_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rcsb_entity_source_organism&#39;</span><span class="p">,</span> <span class="p">{}):</span>
        <span class="n">taxonomy_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">organism</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ncbi_taxonomy_id&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">taxonomy_id</span> <span class="ow">in</span> <span class="n">thermophilic_taxonomy_ids</span><span class="p">:</span>
            <span class="n">thermophilic_source</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">thermophilic_source</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">thermophilic_source</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">thermophilic_source</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">thermophilic_source</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.parse_entities_json" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">parse_entities_json</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">parse_entities_json</span><span class="p">(</span><span class="n">entity_jsons</span><span class="p">:</span> <span class="n"><span title="collections.abc.Iterable">Iterable</span></span><span class="p">[</span><span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n">dict</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>entity_jsons</code></b>
            (<code><span title="collections.abc.Iterable">Iterable</span>[dict[str, <span title="typing.Any">Any</span>]]</code>)
        
        <div class="doc-md-description">
          <p>An Iterable of json like objects containing EntityID information as retrieved from the PDB API</p>
        </div>
      </li>
  </ul>
      <p>Returns:
    The entity dictionary with format -
    {'EntityID':
        {'chains': ['A', 'B', ...],
         'dbref': {'accession': ('Q96DC8',), 'db': 'UniProt'},
         'reference_sequence': 'MSLEHHHHHH...',
         'thermophilicity': 1.0},
     ...}</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span>
<span class="normal">1863</span>
<span class="normal">1864</span>
<span class="normal">1865</span>
<span class="normal">1866</span>
<span class="normal">1867</span>
<span class="normal">1868</span>
<span class="normal">1869</span>
<span class="normal">1870</span>
<span class="normal">1871</span>
<span class="normal">1872</span>
<span class="normal">1873</span>
<span class="normal">1874</span>
<span class="normal">1875</span>
<span class="normal">1876</span>
<span class="normal">1877</span>
<span class="normal">1878</span>
<span class="normal">1879</span>
<span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_entities_json</span><span class="p">(</span><span class="n">entity_jsons</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        entity_jsons: An Iterable of json like objects containing EntityID information as retrieved from the PDB API</span>
<span class="sd">    Returns:</span>
<span class="sd">        The entity dictionary with format -</span>
<span class="sd">        {&#39;EntityID&#39;:</span>
<span class="sd">            {&#39;chains&#39;: [&#39;A&#39;, &#39;B&#39;, ...],</span>
<span class="sd">             &#39;dbref&#39;: {&#39;accession&#39;: (&#39;Q96DC8&#39;,), &#39;db&#39;: &#39;UniProt&#39;},</span>
<span class="sd">             &#39;reference_sequence&#39;: &#39;MSLEHHHHHH...&#39;,</span>
<span class="sd">             &#39;thermophilicity&#39;: 1.0},</span>
<span class="sd">         ...}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">extract_dbref</span><span class="p">(</span><span class="n">entity_ids_json</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;For a PDB API EntityID, parse the associated chains and database reference identifiers</span>

<span class="sd">        Args:</span>
<span class="sd">            entity_ids_json: The json type dictionary returned from requests.Response.json()</span>
<span class="sd">        Returns:</span>
<span class="sd">            Ex: {&#39;db&#39;: DATABASE, &#39;accession&#39;: &#39;Q96DC8&#39;} where DATABASE can be one of &#39;GenBank&#39;, &#39;Norine&#39;, &#39;UniProt&#39;</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">database_keys</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;db&#39;</span><span class="p">,</span> <span class="s1">&#39;accession&#39;</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">uniprot_ids</span> <span class="o">=</span> <span class="n">entity_ids_json</span><span class="p">[</span><span class="s1">&#39;uniprot_ids&#39;</span><span class="p">]</span>
            <span class="c1"># Todo choose the most accurate if more than 2...</span>
            <span class="c1">#  &#39;rcsb_polymer_entity_align&#39; indicates how the model from the PDB aligns to UniprotKB through SIFTS</span>
            <span class="c1">#  [{provenance_source: &quot;SIFTS&quot;,</span>
            <span class="c1">#    reference_database_accession: &quot;P12528&quot;,</span>
            <span class="c1">#    reference_database_name: &quot;UniProt&quot;,</span>
            <span class="c1">#    aligned_regions: [{entity_beg_seq_id: 1,</span>
            <span class="c1">#                       length: 124,</span>
            <span class="c1">#                       ref_beg_seq_id: 2}]</span>
            <span class="c1">#   },</span>
            <span class="c1">#   {}, ...</span>
            <span class="c1">#  ]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">uniprot_ids</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;For Entity </span><span class="si">{</span><span class="n">entity_ids_json</span><span class="p">[</span><span class="s2">&quot;rcsb_id&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">, found multiple UniProt Entries: &#39;</span>
                               <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">uniprot_ids</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">db_d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">database_keys</span><span class="p">,</span> <span class="p">(</span><span class="n">UKB</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">uniprot_ids</span><span class="p">))))</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># No &#39;uniprot_ids&#39;</span>
            <span class="c1"># GenBank = GB, which is mostly RNA or DNA structures or antibody complexes</span>
            <span class="c1"># Norine = NOR, which is small peptide structures, sometimes bound to proteins...</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">identifiers</span> <span class="o">=</span> <span class="p">[</span><span class="nb">dict</span><span class="p">(</span><span class="n">db</span><span class="o">=</span><span class="n">ident</span><span class="p">[</span><span class="s1">&#39;database_name&#39;</span><span class="p">],</span> <span class="n">accession</span><span class="o">=</span><span class="p">(</span><span class="n">ident</span><span class="p">[</span><span class="s1">&#39;database_accession&#39;</span><span class="p">],))</span>
                               <span class="k">for</span> <span class="n">ident</span> <span class="ow">in</span> <span class="n">entity_ids_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;reference_sequence_identifiers&#39;</span><span class="p">,</span> <span class="p">[])]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># There are really no identifiers of use</span>
                <span class="k">return</span> <span class="p">{}</span>
            <span class="k">if</span> <span class="n">identifiers</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">identifiers</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Only one solution</span>
                    <span class="n">db_d</span> <span class="o">=</span> <span class="n">identifiers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>  <span class="c1"># Find the most ideal accession_database UniProt &gt; GenBank &gt; Norine &gt; ???</span>
                    <span class="n">whatever_else</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="n">priority_l</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">identifiers</span><span class="p">))]</span>
                    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">database</span><span class="p">,</span> <span class="n">accession</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">identifiers</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">database</span> <span class="o">==</span> <span class="n">UKB</span><span class="p">:</span>
                            <span class="n">priority_l</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
                        <span class="k">elif</span> <span class="n">database</span> <span class="o">==</span> <span class="n">GB</span><span class="p">:</span>
                            <span class="c1"># Two elements are required from above len check, never have IndexError</span>
                            <span class="n">priority_l</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
                        <span class="c1"># elif database == NOR:</span>
                        <span class="c1">#     priority_l[2].append(idx)</span>
                        <span class="k">elif</span> <span class="ow">not</span> <span class="n">whatever_else</span><span class="p">:</span>
                            <span class="c1"># Only set the first time an unknown identifier is seen</span>
                            <span class="n">whatever_else</span> <span class="o">=</span> <span class="n">idx</span>

                    <span class="c1"># Loop through the list of prioritized identifiers</span>
                    <span class="k">for</span> <span class="n">identifier_idx</span> <span class="ow">in</span> <span class="n">priority_l</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">identifier_idx</span><span class="p">:</span>  <span class="c1"># we have found a priority database, choose the corresponding identifier idx</span>
                            <span class="c1"># Make the db_d with the db name as first arg and all the identifiers as the second arg</span>
                            <span class="n">db_d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">database_keys</span><span class="p">,</span>
                                            <span class="p">(</span><span class="n">identifiers</span><span class="p">[</span><span class="n">identifier_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s1">&#39;db&#39;</span><span class="p">],</span> <span class="p">[</span><span class="n">identifiers</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="s1">&#39;accession&#39;</span><span class="p">]</span>
                                                                                    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">identifier_idx</span><span class="p">])))</span>
                            <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># if no solution from priority but something else, choose the other</span>
                        <span class="n">db_d</span> <span class="o">=</span> <span class="n">identifiers</span><span class="p">[</span><span class="n">whatever_else</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">db_d</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">return</span> <span class="n">db_d</span>

    <span class="n">entity_info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">entity_idx</span><span class="p">,</span> <span class="n">entity_json</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">entity_jsons</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">entity_json</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">entity_json_ids</span> <span class="o">=</span> <span class="n">entity_json</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rcsb_polymer_entity_container_identifiers&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">entity_json_ids</span><span class="p">:</span>
            <span class="n">entity_info</span><span class="p">[</span><span class="n">entity_json_ids</span><span class="p">[</span><span class="s1">&#39;rcsb_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()]</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
                <span class="n">chains</span><span class="o">=</span><span class="n">entity_json_ids</span><span class="p">[</span><span class="s1">&#39;asym_ids&#39;</span><span class="p">],</span>
                <span class="n">dbref</span><span class="o">=</span><span class="n">extract_dbref</span><span class="p">(</span><span class="n">entity_json_ids</span><span class="p">),</span>
                <span class="n">reference_sequence</span><span class="o">=</span><span class="n">entity_json</span><span class="p">[</span><span class="s1">&#39;entity_poly&#39;</span><span class="p">][</span><span class="s1">&#39;pdbx_seq_one_letter_code_can&#39;</span><span class="p">],</span>
                <span class="n">thermophilicity</span><span class="o">=</span><span class="n">thermophilicity_from_entity_json</span><span class="p">(</span><span class="n">entity_json</span><span class="p">),</span>
            <span class="p">)</span>

    <span class="k">return</span> <span class="n">entity_info</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.query_entity_id" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">query_entity_id</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">query_entity_id</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_integer</span><span class="p">:</span> <span class="n">str</span> <span class="o">|</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_id</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="requests.Response">Response</span></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Retrieve PDB EntityID information from the PDB API. More info at http://data.rcsb.org/#data-api</p>
<p>For all method types the following keys are available:
{'rcsb_polymer_entity_annotation', 'entity_poly', 'rcsb_polymer_entity', 'entity_src_gen',
 'rcsb_polymer_entity_feature_summary', 'rcsb_polymer_entity_align', 'rcsb_id', 'rcsb_cluster_membership',
 'rcsb_polymer_entity_container_identifiers', 'rcsb_entity_host_organism', 'rcsb_latest_revision',
 'rcsb_entity_source_organism'}
NMR only - {'rcsb_polymer_entity_feature'}
EM only - set()
X-ray_only_keys - {'rcsb_cluster_flexibility'}</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>entry</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The 4 character PDB EntryID of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>entity_integer</code></b>
            (<code>str | int</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The integer of the entity_id</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>entity_id</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The PDB formatted EntityID. Has the format EntryID_Integer (1ABC_1)</p>
        </div>
      </li>
  </ul>
      <p>Returns:
    The entity information according to the PDB</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1931</span>
<span class="normal">1932</span>
<span class="normal">1933</span>
<span class="normal">1934</span>
<span class="normal">1935</span>
<span class="normal">1936</span>
<span class="normal">1937</span>
<span class="normal">1938</span>
<span class="normal">1939</span>
<span class="normal">1940</span>
<span class="normal">1941</span>
<span class="normal">1942</span>
<span class="normal">1943</span>
<span class="normal">1944</span>
<span class="normal">1945</span>
<span class="normal">1946</span>
<span class="normal">1947</span>
<span class="normal">1948</span>
<span class="normal">1949</span>
<span class="normal">1950</span>
<span class="normal">1951</span>
<span class="normal">1952</span>
<span class="normal">1953</span>
<span class="normal">1954</span>
<span class="normal">1955</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">query_entity_id</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_integer</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> \
        <span class="n">requests</span><span class="o">.</span><span class="n">Response</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve PDB EntityID information from the PDB API. More info at http://data.rcsb.org/#data-api</span>

<span class="sd">    For all method types the following keys are available:</span>
<span class="sd">    {&#39;rcsb_polymer_entity_annotation&#39;, &#39;entity_poly&#39;, &#39;rcsb_polymer_entity&#39;, &#39;entity_src_gen&#39;,</span>
<span class="sd">     &#39;rcsb_polymer_entity_feature_summary&#39;, &#39;rcsb_polymer_entity_align&#39;, &#39;rcsb_id&#39;, &#39;rcsb_cluster_membership&#39;,</span>
<span class="sd">     &#39;rcsb_polymer_entity_container_identifiers&#39;, &#39;rcsb_entity_host_organism&#39;, &#39;rcsb_latest_revision&#39;,</span>
<span class="sd">     &#39;rcsb_entity_source_organism&#39;}</span>
<span class="sd">    NMR only - {&#39;rcsb_polymer_entity_feature&#39;}</span>
<span class="sd">    EM only - set()</span>
<span class="sd">    X-ray_only_keys - {&#39;rcsb_cluster_flexibility&#39;}</span>

<span class="sd">    Args:</span>
<span class="sd">        entry: The 4 character PDB EntryID of interest</span>
<span class="sd">        entity_integer: The integer of the entity_id</span>
<span class="sd">        entity_id: The PDB formatted EntityID. Has the format EntryID_Integer (1ABC_1)</span>
<span class="sd">    Returns:</span>
<span class="sd">        The entity information according to the PDB</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">entity_id</span><span class="p">:</span>
        <span class="n">entry</span><span class="p">,</span> <span class="n">entity_integer</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">entity_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>  <span class="c1"># Assume that this was passed correctly</span>

    <span class="k">if</span> <span class="n">entry</span> <span class="ow">and</span> <span class="n">entity_integer</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">connection_exception_handler</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">pdb_rest_url</span><span class="si">}</span><span class="s1">/polymer_entity/</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">entity_integer</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.get_entity_id" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_entity_id</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_entity_id</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_integer</span><span class="p">:</span> <span class="n">int</span> <span class="o">|</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_id</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">chain</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tuple</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n">str</span><span class="p">]</span> <span class="o">|</span> <span class="n">tuple</span><span class="p">[</span><span class="kc">None</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Retrieve a UniProtID from the PDB API by passing various PDB identifiers or combinations thereof</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>entry</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The 4 character PDB EntryID of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>entity_integer</code></b>
            (<code>int | str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The entity integer from the EntryID of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>entity_id</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The PDB formatted EntityID. Has the format EntryID_Integer (1ABC_1)</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>chain</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The polymer "chain" identifier otherwise known as the "asym_id" from the PDB EntryID of interest</p>
        </div>
      </li>
  </ul>
      <p>Returns:
    The Entity_ID</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1959</span>
<span class="normal">1960</span>
<span class="normal">1961</span>
<span class="normal">1962</span>
<span class="normal">1963</span>
<span class="normal">1964</span>
<span class="normal">1965</span>
<span class="normal">1966</span>
<span class="normal">1967</span>
<span class="normal">1968</span>
<span class="normal">1969</span>
<span class="normal">1970</span>
<span class="normal">1971</span>
<span class="normal">1972</span>
<span class="normal">1973</span>
<span class="normal">1974</span>
<span class="normal">1975</span>
<span class="normal">1976</span>
<span class="normal">1977</span>
<span class="normal">1978</span>
<span class="normal">1979</span>
<span class="normal">1980</span>
<span class="normal">1981</span>
<span class="normal">1982</span>
<span class="normal">1983</span>
<span class="normal">1984</span>
<span class="normal">1985</span>
<span class="normal">1986</span>
<span class="normal">1987</span>
<span class="normal">1988</span>
<span class="normal">1989</span>
<span class="normal">1990</span>
<span class="normal">1991</span>
<span class="normal">1992</span>
<span class="normal">1993</span>
<span class="normal">1994</span>
<span class="normal">1995</span>
<span class="normal">1996</span>
<span class="normal">1997</span>
<span class="normal">1998</span>
<span class="normal">1999</span>
<span class="normal">2000</span>
<span class="normal">2001</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_entity_id</span><span class="p">(</span><span class="n">entry</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_integer</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">chain</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> \
        <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="nb">tuple</span><span class="p">[</span><span class="kc">None</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve a UniProtID from the PDB API by passing various PDB identifiers or combinations thereof</span>

<span class="sd">    Args:</span>
<span class="sd">        entry: The 4 character PDB EntryID of interest</span>
<span class="sd">        entity_integer: The entity integer from the EntryID of interest</span>
<span class="sd">        entity_id: The PDB formatted EntityID. Has the format EntryID_Integer (1ABC_1)</span>
<span class="sd">        chain: The polymer &quot;chain&quot; identifier otherwise known as the &quot;asym_id&quot; from the PDB EntryID of interest</span>
<span class="sd">    Returns:</span>
<span class="sd">        The Entity_ID</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">entry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">4</span><span class="p">:</span>
            <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;EntryID &quot;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">&quot; is not of the required format and will not be found with the PDB API&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">entity_integer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">entry</span><span class="p">,</span> <span class="n">entity_integer</span>
            <span class="c1"># entity_id = f&#39;{entry}_{entity_integer}&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">info</span> <span class="o">=</span> <span class="n">_get_entry_info</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span>
            <span class="n">chain_entity</span> <span class="o">=</span> <span class="p">{</span><span class="n">chain</span><span class="p">:</span> <span class="n">entity_idx</span> <span class="k">for</span> <span class="n">entity_idx</span><span class="p">,</span> <span class="n">chains</span> <span class="ow">in</span> <span class="n">info</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;entity&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">for</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">chains</span><span class="p">}</span>
            <span class="k">if</span> <span class="n">chain</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">entry</span><span class="p">,</span> <span class="n">chain_entity</span><span class="p">[</span><span class="n">chain</span><span class="p">]</span>
                    <span class="c1"># entity_id = f&#39;{entry}_{chain_entity[chain]}&#39;</span>
                <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;No chain &quot;</span><span class="si">{</span><span class="n">chain</span><span class="si">}</span><span class="s1">&quot; found in PDB ID </span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">. &#39;</span>
                                   <span class="sa">f</span><span class="s1">&#39;Possible chains </span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">chain_entity</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">entity_integer</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">chain_entity</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s1">&#39;Using the argument &quot;entry&quot; without either &quot;entity_integer&quot; or &quot;chain&quot; is not &#39;</span>
                               <span class="sa">f</span><span class="s1">&#39;recommended. Choosing the first EntityID &quot;</span><span class="si">{</span><span class="n">entry</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">entity_integer</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">entry</span><span class="p">,</span> <span class="n">entity_integer</span>
                <span class="c1"># entity_id = f&#39;{entry}_{entity_integer}&#39;</span>

    <span class="k">elif</span> <span class="n">entity_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">entry</span><span class="p">,</span> <span class="n">entity_integer</span><span class="p">,</span> <span class="o">*</span><span class="n">extra</span> <span class="o">=</span> <span class="n">entity_id</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">extra</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">entry</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">entry</span><span class="p">,</span> <span class="n">entity_integer</span>

        <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;EntityID &#39;</span><span class="si">{</span><span class="n">entity_id</span><span class="si">}</span><span class="s2">&#39; isn&#39;t the required format and will not be found with the PDB API&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="kc">None</span><span class="p">,</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.get_entity_uniprot_id" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_entity_uniprot_id</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_entity_uniprot_id</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">str</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Retrieve a UniProtID from the PDB API by passing various PDB identifiers or combinations thereof</p>



  <p>Other Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>entry=None</code></b>
            (<code>str</code>)
        
        <div class="doc-md-description">
          <p>The 4 character PDB EntryID of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>entity_integer=None</code></b>
            (<code>str</code>)
        
        <div class="doc-md-description">
          <p>The entity integer from the EntryID of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>entity_id=None</code></b>
            (<code>str</code>)
        
        <div class="doc-md-description">
          <p>The PDB formatted EntityID. Has the format EntryID_Integer (1ABC_1)</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>chain=None</code></b>
            (<code>str</code>)
        
        <div class="doc-md-description">
          <p>The polymer "chain" identifier otherwise known as the "asym_id" from the PDB EntryID of
interest</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>str | None</code>
        
        <div class="doc-md-description">
          <p>The UniProt ID</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2005</span>
<span class="normal">2006</span>
<span class="normal">2007</span>
<span class="normal">2008</span>
<span class="normal">2009</span>
<span class="normal">2010</span>
<span class="normal">2011</span>
<span class="normal">2012</span>
<span class="normal">2013</span>
<span class="normal">2014</span>
<span class="normal">2015</span>
<span class="normal">2016</span>
<span class="normal">2017</span>
<span class="normal">2018</span>
<span class="normal">2019</span>
<span class="normal">2020</span>
<span class="normal">2021</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_entity_uniprot_id</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve a UniProtID from the PDB API by passing various PDB identifiers or combinations thereof</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        entry=None (str): The 4 character PDB EntryID of interest</span>
<span class="sd">        entity_integer=None (str): The entity integer from the EntryID of interest</span>
<span class="sd">        entity_id=None (str): The PDB formatted EntityID. Has the format EntryID_Integer (1ABC_1)</span>
<span class="sd">        chain=None (str): The polymer &quot;chain&quot; identifier otherwise known as the &quot;asym_id&quot; from the PDB EntryID of</span>
<span class="sd">            interest</span>

<span class="sd">    Returns:</span>
<span class="sd">        The UniProt ID</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">entity_request</span> <span class="o">=</span> <span class="n">query_entity_id</span><span class="p">(</span><span class="o">*</span><span class="n">get_entity_id</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">entity_request</span><span class="p">:</span>
        <span class="c1"># return the first uniprot entry</span>
        <span class="k">return</span> <span class="n">entity_request</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;rcsb_polymer_entity_container_identifiers&#39;</span><span class="p">)[</span><span class="s1">&#39;uniprot_id&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.get_entity_reference_sequence" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_entity_reference_sequence</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_entity_reference_sequence</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">str</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Query the PDB API for the reference amino acid sequence for a specified entity ID (PDB EntryID_Entity_ID)</p>



  <p>Other Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>entry=None</code></b>
            (<code>str</code>)
        
        <div class="doc-md-description">
          <p>The 4 character PDB EntryID of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>entity_integer=None</code></b>
            (<code>str</code>)
        
        <div class="doc-md-description">
          <p>The entity integer from the EntryID of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>entity_id=None</code></b>
            (<code>str</code>)
        
        <div class="doc-md-description">
          <p>The PDB formatted EntityID. Has the format EntryID_Integer (1ABC_1)</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>chain=None</code></b>
            (<code>str</code>)
        
        <div class="doc-md-description">
          <p>The polymer "chain" identifier otherwise known as the "asym_id" from the PDB EntryID of
interest</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>str | None</code>
        
        <div class="doc-md-description">
          <p>One letter amino acid sequence</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2025</span>
<span class="normal">2026</span>
<span class="normal">2027</span>
<span class="normal">2028</span>
<span class="normal">2029</span>
<span class="normal">2030</span>
<span class="normal">2031</span>
<span class="normal">2032</span>
<span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_entity_reference_sequence</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query the PDB API for the reference amino acid sequence for a specified entity ID (PDB EntryID_Entity_ID)</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        entry=None (str): The 4 character PDB EntryID of interest</span>
<span class="sd">        entity_integer=None (str): The entity integer from the EntryID of interest</span>
<span class="sd">        entity_id=None (str): The PDB formatted EntityID. Has the format EntryID_Integer (1ABC_1)</span>
<span class="sd">        chain=None (str): The polymer &quot;chain&quot; identifier otherwise known as the &quot;asym_id&quot; from the PDB EntryID of</span>
<span class="sd">            interest</span>

<span class="sd">    Returns:</span>
<span class="sd">        One letter amino acid sequence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">entity_request</span> <span class="o">=</span> <span class="n">query_entity_id</span><span class="p">(</span><span class="o">*</span><span class="n">get_entity_id</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">entity_request</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">entity_request</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;entity_poly&#39;</span><span class="p">)[</span><span class="s1">&#39;pdbx_seq_one_letter_code_can&#39;</span><span class="p">]</span>  <span class="c1"># returns non-cannonical as &#39;X&#39;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="resources.query.pdb.get_rcsb_metadata_schema" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_rcsb_metadata_schema</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_rcsb_metadata_schema</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_dir</span><span class="p">,</span> <span class="s1">&#39;rcsb_schema.pkl&#39;</span><span class="p">),</span> <span class="n">search_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">force_update</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Parse the rcsb metadata schema for useful information from the format
     {"properties" : {"assignment_version" : {"type" : "string", "examples" : [ "V4_0_2" ],
                                         "description" : "Identifies the version of the feature assignment.",
                                         "rcsb_description" : [
                                          {"text" : "Identifies the version of the feature assignment.",
                                           "context" : "dictionary"},
                                          {"text" : "Feature Version", "context" : "brief"} ]
                                        },
                      ...
                      "symmetry_type" : {"type" : "string",     &lt;-- provide data type
           provide options     --&gt;       "enum" : [ "2D CRYSTAL", "3D CRYSTAL", "HELICAL", "POINT" ],
           provide description --&gt;       "description" : "The type of symmetry applied to the reconstruction",
           provide operators   --&gt;       "rcsb_search_context" : [ "exact-match" ],
                                         "rcsb_full_text_priority" : 10,
                                         "rcsb_description" : [
                                            {"text" : "The type of symmetry applied to the reconstruction",
                                             "context" : "dictionary"},
                                            {"text" : "Symmetry Type (Em 3d Reconstruction)", "context" : "brief"} ]
                                        },
                      ... },
      "title" : "Core Metadata", "additionalProperties" : false, "$comment" : "Schema version: 1.14.0"
      "required" : ["rcsb_id", "rcsb_entry_container_identifiers", "rcsb_entry_info",
                    "rcsb_pubmed_container_identifiers", "rcsb_polymer_entity_container_identifiers",
                    "rcsb_assembly_container_identifiers", "rcsb_uniprot_container_identifiers" ],
      "$schema" : "http://json-schema.org/draft-07/schema#",
      "description" : "Collective JSON schema that includes definitions for all indexed cores with RCSB metadata extensions.",
     }
Returns:
    (dict): {attribute: {'dtype': 'string', 'description': 'XYZ', 'operators': {'equals'}, 'choices': []}, ...}</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/resources/query/pdb.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span>
<span class="normal">2056</span>
<span class="normal">2057</span>
<span class="normal">2058</span>
<span class="normal">2059</span>
<span class="normal">2060</span>
<span class="normal">2061</span>
<span class="normal">2062</span>
<span class="normal">2063</span>
<span class="normal">2064</span>
<span class="normal">2065</span>
<span class="normal">2066</span>
<span class="normal">2067</span>
<span class="normal">2068</span>
<span class="normal">2069</span>
<span class="normal">2070</span>
<span class="normal">2071</span>
<span class="normal">2072</span>
<span class="normal">2073</span>
<span class="normal">2074</span>
<span class="normal">2075</span>
<span class="normal">2076</span>
<span class="normal">2077</span>
<span class="normal">2078</span>
<span class="normal">2079</span>
<span class="normal">2080</span>
<span class="normal">2081</span>
<span class="normal">2082</span>
<span class="normal">2083</span>
<span class="normal">2084</span>
<span class="normal">2085</span>
<span class="normal">2086</span>
<span class="normal">2087</span>
<span class="normal">2088</span>
<span class="normal">2089</span>
<span class="normal">2090</span>
<span class="normal">2091</span>
<span class="normal">2092</span>
<span class="normal">2093</span>
<span class="normal">2094</span>
<span class="normal">2095</span>
<span class="normal">2096</span>
<span class="normal">2097</span>
<span class="normal">2098</span>
<span class="normal">2099</span>
<span class="normal">2100</span>
<span class="normal">2101</span>
<span class="normal">2102</span>
<span class="normal">2103</span>
<span class="normal">2104</span>
<span class="normal">2105</span>
<span class="normal">2106</span>
<span class="normal">2107</span>
<span class="normal">2108</span>
<span class="normal">2109</span>
<span class="normal">2110</span>
<span class="normal">2111</span>
<span class="normal">2112</span>
<span class="normal">2113</span>
<span class="normal">2114</span>
<span class="normal">2115</span>
<span class="normal">2116</span>
<span class="normal">2117</span>
<span class="normal">2118</span>
<span class="normal">2119</span>
<span class="normal">2120</span>
<span class="normal">2121</span>
<span class="normal">2122</span>
<span class="normal">2123</span>
<span class="normal">2124</span>
<span class="normal">2125</span>
<span class="normal">2126</span>
<span class="normal">2127</span>
<span class="normal">2128</span>
<span class="normal">2129</span>
<span class="normal">2130</span>
<span class="normal">2131</span>
<span class="normal">2132</span>
<span class="normal">2133</span>
<span class="normal">2134</span>
<span class="normal">2135</span>
<span class="normal">2136</span>
<span class="normal">2137</span>
<span class="normal">2138</span>
<span class="normal">2139</span>
<span class="normal">2140</span>
<span class="normal">2141</span>
<span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span>
<span class="normal">2148</span>
<span class="normal">2149</span>
<span class="normal">2150</span>
<span class="normal">2151</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_rcsb_metadata_schema</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">current_dir</span><span class="p">,</span> <span class="s1">&#39;rcsb_schema.pkl&#39;</span><span class="p">),</span> <span class="n">search_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">force_update</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse the rcsb metadata schema for useful information from the format</span>
<span class="sd">         {&quot;properties&quot; : {&quot;assignment_version&quot; : {&quot;type&quot; : &quot;string&quot;, &quot;examples&quot; : [ &quot;V4_0_2&quot; ],</span>
<span class="sd">                                             &quot;description&quot; : &quot;Identifies the version of the feature assignment.&quot;,</span>
<span class="sd">                                             &quot;rcsb_description&quot; : [</span>
<span class="sd">                                              {&quot;text&quot; : &quot;Identifies the version of the feature assignment.&quot;,</span>
<span class="sd">                                               &quot;context&quot; : &quot;dictionary&quot;},</span>
<span class="sd">                                              {&quot;text&quot; : &quot;Feature Version&quot;, &quot;context&quot; : &quot;brief&quot;} ]</span>
<span class="sd">                                            },</span>
<span class="sd">                          ...</span>
<span class="sd">                          &quot;symmetry_type&quot; : {&quot;type&quot; : &quot;string&quot;,     &lt;-- provide data type</span>
<span class="sd">               provide options     --&gt;       &quot;enum&quot; : [ &quot;2D CRYSTAL&quot;, &quot;3D CRYSTAL&quot;, &quot;HELICAL&quot;, &quot;POINT&quot; ],</span>
<span class="sd">               provide description --&gt;       &quot;description&quot; : &quot;The type of symmetry applied to the reconstruction&quot;,</span>
<span class="sd">               provide operators   --&gt;       &quot;rcsb_search_context&quot; : [ &quot;exact-match&quot; ],</span>
<span class="sd">                                             &quot;rcsb_full_text_priority&quot; : 10,</span>
<span class="sd">                                             &quot;rcsb_description&quot; : [</span>
<span class="sd">                                                {&quot;text&quot; : &quot;The type of symmetry applied to the reconstruction&quot;,</span>
<span class="sd">                                                 &quot;context&quot; : &quot;dictionary&quot;},</span>
<span class="sd">                                                {&quot;text&quot; : &quot;Symmetry Type (Em 3d Reconstruction)&quot;, &quot;context&quot; : &quot;brief&quot;} ]</span>
<span class="sd">                                            },</span>
<span class="sd">                          ... },</span>
<span class="sd">          &quot;title&quot; : &quot;Core Metadata&quot;, &quot;additionalProperties&quot; : false, &quot;$comment&quot; : &quot;Schema version: 1.14.0&quot;</span>
<span class="sd">          &quot;required&quot; : [&quot;rcsb_id&quot;, &quot;rcsb_entry_container_identifiers&quot;, &quot;rcsb_entry_info&quot;,</span>
<span class="sd">                        &quot;rcsb_pubmed_container_identifiers&quot;, &quot;rcsb_polymer_entity_container_identifiers&quot;,</span>
<span class="sd">                        &quot;rcsb_assembly_container_identifiers&quot;, &quot;rcsb_uniprot_container_identifiers&quot; ],</span>
<span class="sd">          &quot;$schema&quot; : &quot;http://json-schema.org/draft-07/schema#&quot;,</span>
<span class="sd">          &quot;description&quot; : &quot;Collective JSON schema that includes definitions for all indexed cores with RCSB metadata extensions.&quot;,</span>
<span class="sd">         }</span>
<span class="sd">    Returns:</span>
<span class="sd">        (dict): {attribute: {&#39;dtype&#39;: &#39;string&#39;, &#39;description&#39;: &#39;XYZ&#39;, &#39;operators&#39;: {&#39;equals&#39;}, &#39;choices&#39;: []}, ...}</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">schema_pairs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;dtype&#39;</span><span class="p">:</span> <span class="s1">&#39;type&#39;</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="s1">&#39;description&#39;</span><span class="p">,</span> <span class="s1">&#39;operators&#39;</span><span class="p">:</span> <span class="s1">&#39;rcsb_search_context&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;choices&#39;</span><span class="p">:</span> <span class="s1">&#39;enum&#39;</span><span class="p">}</span>
    <span class="n">operator_d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;full-text&#39;</span><span class="p">:</span> <span class="s1">&#39;contains_words, contains_phrase, exists&#39;</span><span class="p">,</span> <span class="s1">&#39;exact-match&#39;</span><span class="p">:</span> <span class="s1">&#39;in, exact_match, exists&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;default-match&#39;</span><span class="p">:</span> <span class="s1">&#39;equals, greater, less, greater_or_equal, less_or_equal, range, range_closed, &#39;</span>
                                   <span class="s1">&#39;exists&#39;</span><span class="p">,</span> <span class="s1">&#39;suggest&#39;</span><span class="p">:</span> <span class="kc">None</span><span class="p">}</span>
    <span class="c1"># Types of rcsb_search_context: (can be multiple)</span>
    <span class="c1"># full-text - contains_words, contains_phrase, exists</span>
    <span class="c1"># exact-match - in, exact-match, exists</span>
    <span class="c1"># default-match - equals, greater, less, greater_or_equal, less_or_equal, range, range_closed, exists</span>
    <span class="c1"># suggests - provides an example to the user in the GUI</span>
    <span class="n">data_types</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;integer&#39;</span><span class="p">,</span> <span class="s1">&#39;number&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">recurse_metadata</span><span class="p">(</span><span class="n">metadata_d</span><span class="p">,</span> <span class="n">stack</span><span class="o">=</span><span class="nb">tuple</span><span class="p">()):</span>  <span class="c1"># this puts the yield inside a local iter so we don&#39;t return</span>
        <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">metadata_d</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">metadata_d</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;array&#39;</span><span class="p">:</span>  <span class="c1"># &#39;items&#39; must be a keyword in dictionary</span>
                <span class="c1"># stack += (attribute, &#39;a&#39;)</span>
                <span class="k">if</span> <span class="n">metadata_d</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;items&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">data_types</span><span class="p">:</span>  <span class="c1"># array is the final attribute of the branch</span>
                    <span class="k">yield</span> <span class="n">stack</span> <span class="o">+</span> <span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">metadata_d</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;items&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">:</span>  <span class="c1"># type must be object, therefore contain &#39;properties&#39; key and then have more attributes as leafs</span>
                    <span class="k">yield from</span> <span class="n">recurse_metadata</span><span class="p">(</span><span class="n">metadata_d</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;items&#39;</span><span class="p">][</span><span class="s1">&#39;properties&#39;</span><span class="p">],</span> <span class="n">stack</span><span class="o">=</span><span class="n">stack</span> <span class="o">+</span> <span class="p">((</span><span class="n">attribute</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Array with type </span><span class="si">%s</span><span class="s1"> found in </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">metadata_d</span><span class="p">[</span><span class="n">attribute</span><span class="p">],</span> <span class="n">stack</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">metadata_d</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;object&#39;</span><span class="p">:</span>  <span class="c1"># This should never be reachable?</span>
                <span class="c1"># print(&#39;%s object found %s&#39; % (attribute, stack))</span>
                <span class="k">if</span> <span class="s1">&#39;properties&#39;</span> <span class="ow">in</span> <span class="n">metadata_d</span><span class="p">[</span><span class="n">attribute</span><span class="p">]:</span>  <span class="c1"># check may be unnecessary</span>
                    <span class="k">yield from</span> <span class="n">recurse_metadata</span><span class="p">(</span><span class="n">metadata_d</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;properties&#39;</span><span class="p">],</span> <span class="n">stack</span><span class="o">=</span><span class="n">stack</span> <span class="o">+</span> <span class="p">(</span><span class="n">attribute</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;Object with no properties found </span><span class="si">%s</span><span class="s1"> in </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">metadata_d</span><span class="p">[</span><span class="n">attribute</span><span class="p">],</span> <span class="n">stack</span><span class="p">))</span>
                    <span class="c1"># yield stack + (&#39;o&#39;, attribute,)</span>
            <span class="k">elif</span> <span class="n">metadata_d</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="n">data_types</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">stack</span> <span class="o">+</span> <span class="p">(</span><span class="n">attribute</span><span class="p">,)</span>  <span class="c1"># + (&#39;o&#39;, attribute,) add &#39;o&#39; as the parent had properties from the object type</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s1">&#39;other type = </span><span class="si">%s</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">metadata_d</span><span class="p">[</span><span class="n">attribute</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">])</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">file</span><span class="p">)</span> <span class="ow">or</span> <span class="n">force_update</span><span class="p">:</span>  <span class="c1"># Todo and date.datetime - date.current is not greater than a month...</span>
        <span class="n">logger</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Gathering the most current PDB metadata. This may take a couple minutes...&#39;</span><span class="p">)</span>
        <span class="n">metadata_json</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">attribute_metadata_schema_json</span><span class="p">)</span><span class="o">.</span><span class="n">json</span><span class="p">()</span>
        <span class="n">metadata_properties_d</span> <span class="o">=</span> <span class="n">metadata_json</span><span class="p">[</span><span class="s1">&#39;properties&#39;</span><span class="p">]</span>
        <span class="n">gen_schema</span> <span class="o">=</span> <span class="n">recurse_metadata</span><span class="p">(</span><span class="n">metadata_properties_d</span><span class="p">)</span>
        <span class="n">schema_header_tuples</span> <span class="o">=</span> <span class="p">[</span><span class="n">yield_schema</span> <span class="k">for</span> <span class="n">yield_schema</span> <span class="ow">in</span> <span class="n">gen_schema</span><span class="p">]</span>

        <span class="n">schema_dictionary_strings_d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="s2">&quot;[&#39;items&#39;]&quot;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">:</span> <span class="s2">&quot;[&#39;properties&#39;]&quot;</span><span class="p">}</span>  <span class="c1"># &#39;a&#39;: &quot;[&#39;items&#39;][&#39;properties&#39;]&quot;</span>
        <span class="n">schema_d</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">attribute_tuple</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">schema_header_tuples</span><span class="p">):</span>
            <span class="n">attribute_full</span> <span class="o">=</span> <span class="s1">&#39;.&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">attribute</span> <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">attribute_tuple</span>
                                      <span class="k">if</span> <span class="n">attribute</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schema_dictionary_strings_d</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="n">attribute_full</span><span class="p">)</span>
            <span class="n">schema_d</span><span class="p">[</span><span class="n">attribute_full</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">d_search_string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[&#39;</span><span class="si">{</span><span class="n">attribute</span><span class="si">}</span><span class="s2">&#39;]&quot;</span> <span class="k">if</span> <span class="n">attribute</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schema_dictionary_strings_d</span>
                                      <span class="k">else</span> <span class="n">schema_dictionary_strings_d</span><span class="p">[</span><span class="n">attribute</span><span class="p">]</span> <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="n">attribute_tuple</span><span class="p">)</span>
            <span class="n">evaluation_d</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">metadata_properties_d</span><span class="si">}{</span><span class="n">d_search_string</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">schema_pairs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">evaluation_d</span><span class="p">:</span>
                    <span class="n">schema_d</span><span class="p">[</span><span class="n">attribute_full</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">evaluation_d</span><span class="p">[</span><span class="n">value</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">schema_d</span><span class="p">[</span><span class="n">attribute_full</span><span class="p">][</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

            <span class="k">if</span> <span class="s1">&#39;format&#39;</span> <span class="ow">in</span> <span class="n">evaluation_d</span><span class="p">:</span>
                <span class="n">schema_d</span><span class="p">[</span><span class="n">attribute_full</span><span class="p">][</span><span class="s1">&#39;dtype&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;date&#39;</span>

            <span class="k">if</span> <span class="n">schema_d</span><span class="p">[</span><span class="n">attribute_full</span><span class="p">][</span><span class="s1">&#39;description&#39;</span><span class="p">]:</span>  <span class="c1"># convert the description to a simplified descriptor</span>
                <span class="n">schema_d</span><span class="p">[</span><span class="n">attribute_full</span><span class="p">][</span><span class="s1">&#39;description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">schema_d</span><span class="p">[</span><span class="n">attribute_full</span><span class="p">][</span><span class="s1">&#39;description&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">schema_d</span><span class="p">[</span><span class="n">attribute_full</span><span class="p">][</span><span class="s1">&#39;operators&#39;</span><span class="p">]:</span>  <span class="c1"># convert the rcsb_search_context to valid operator(s)</span>
                <span class="n">schema_d</span><span class="p">[</span><span class="n">attribute_full</span><span class="p">][</span><span class="s1">&#39;operators&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">operator_d</span><span class="p">[</span><span class="n">search_context</span><span class="p">]</span> <span class="k">for</span> <span class="n">search_context</span> <span class="ow">in</span> <span class="n">schema_d</span><span class="p">[</span><span class="n">attribute_full</span><span class="p">][</span><span class="s1">&#39;operators&#39;</span><span class="p">]</span>
                    <span class="k">if</span> <span class="n">operator_d</span><span class="p">[</span><span class="n">search_context</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">search_only</span><span class="p">:</span>  <span class="c1"># remove entries that don&#39;t have a corresponding operator as these aren&#39;t searchable</span>
                    <span class="n">schema_d</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">attribute_full</span><span class="p">)</span>

        <span class="n">pickled_schema_file</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">pickle_object</span><span class="p">(</span><span class="n">schema_d</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">out_path</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">utils</span><span class="o">.</span><span class="n">unpickle</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">schema_d</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: query">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                query
              </div>
            </div>
          </a>
        
        
          
          <a href="../uniprot/" class="md-footer__link md-footer__link--next" aria-label="Next: uniprot">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                uniprot
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Kyle Meador
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/kylemeador" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "navigation.instant", "navigation.path", "navigation.top", "navigation.footer", "search.suggest", "search.highlight", "toc.follow", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
    
  </body>
</html>