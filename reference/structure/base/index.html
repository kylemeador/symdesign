
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../coordinates/">
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.9">
    
    
      
        <title>base - symdesign Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.f2e4d321.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../../css/code_select.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#structure.base" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="symdesign Documentation" class="md-header__button md-logo" aria-label="symdesign Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            symdesign Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              base
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="green"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="deep-purple" data-md-color-accent="green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9h-1.9M20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69m-9.15 3.96h2.3L12 9l-1.15 3.65Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="deep-purple" data-md-color-accent="green"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/kylemeador/symdesign" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../user_guide/" class="md-tabs__link">
        
  
    
  
  User Guide

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../" class="md-tabs__link">
          
  
  API reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="symdesign Documentation" class="md-nav__button md-logo" aria-label="symdesign Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    symdesign Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/kylemeador/symdesign" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../user_guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    API reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            API reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    symdesign
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../flags/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    flags
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../metrics/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    metrics
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            metrics
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../metrics/pose/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pose
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../protocols/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    protocols
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            protocols
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocols/align/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    align
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocols/cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocols/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocols/fragdock/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fragdock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocols/pose/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pose
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocols/select/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    select
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../protocols/utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../resources/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    resources
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_5" id="__nav_3_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5">
            <span class="md-nav__icon md-icon"></span>
            resources
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/database/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    database
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/distribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    distribute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/job/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    job
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/ml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ml
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/monomer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    monomer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/multimer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    multimer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_5_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../resources/query/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    query
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_5_8" id="__nav_3_5_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_5_8">
            <span class="md-nav__icon md-icon"></span>
            query
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/query/pdb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pdb
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/query/uniprot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    uniprot
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/sql/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sql
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/structure_db/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    structure_db
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../resources/wrapapi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    wrapapi
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../sequence/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    sequence
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_6" id="__nav_3_6_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_6">
            <span class="md-nav__icon md-icon"></span>
            sequence
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sequence/constants/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    constants
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../sequence/expression/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    expression
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    structure
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            structure
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    base
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    base
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#structure.base" class="md-nav__link">
    <span class="md-ellipsis">
      base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.DEFAULT_SS_COIL_IDENTIFIER" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_SS_COIL_IDENTIFIER
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.alpha_helix_15_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      alpha_helix_15_atoms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.ArrayIndexer" class="md-nav__link">
    <span class="md-ellipsis">
      ArrayIndexer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.Log" class="md-nav__link">
    <span class="md-ellipsis">
      Log
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.SymmetryBase" class="md-nav__link">
    <span class="md-ellipsis">
      SymmetryBase
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SymmetryBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.SymmetryBase.symmetry" class="md-nav__link">
    <span class="md-ellipsis">
      symmetry
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.SymmetryBase.symmetric_dependents" class="md-nav__link">
    <span class="md-ellipsis">
      symmetric_dependents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.SymmetryBase.reset_symmetry_state" class="md-nav__link">
    <span class="md-ellipsis">
      reset_symmetry_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.SymmetryBase.is_symmetric" class="md-nav__link">
    <span class="md-ellipsis">
      is_symmetric
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.SymmetryBase.has_symmetric_dependents" class="md-nav__link">
    <span class="md-ellipsis">
      has_symmetric_dependents
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.StructureMetadata" class="md-nav__link">
    <span class="md-ellipsis">
      StructureMetadata
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.CoordinateOpsMixin" class="md-nav__link">
    <span class="md-ellipsis">
      CoordinateOpsMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CoordinateOpsMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.CoordinateOpsMixin.coords" class="md-nav__link">
    <span class="md-ellipsis">
      coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.CoordinateOpsMixin.distance_from_reference" class="md-nav__link">
    <span class="md-ellipsis">
      distance_from_reference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.CoordinateOpsMixin.translate" class="md-nav__link">
    <span class="md-ellipsis">
      translate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.CoordinateOpsMixin.rotate" class="md-nav__link">
    <span class="md-ellipsis">
      rotate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.CoordinateOpsMixin.transform" class="md-nav__link">
    <span class="md-ellipsis">
      transform
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.CoordinateOpsMixin.copy" class="md-nav__link">
    <span class="md-ellipsis">
      copy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.CoordinateOpsMixin.get_transformed_copy" class="md-nav__link">
    <span class="md-ellipsis">
      get_transformed_copy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.StructureBase" class="md-nav__link">
    <span class="md-ellipsis">
      StructureBase
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StructureBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBase.parent" class="md-nav__link">
    <span class="md-ellipsis">
      parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBase.log" class="md-nav__link">
    <span class="md-ellipsis">
      log
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBase.coords" class="md-nav__link">
    <span class="md-ellipsis">
      coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBase.is_dependent" class="md-nav__link">
    <span class="md-ellipsis">
      is_dependent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBase.is_parent" class="md-nav__link">
    <span class="md-ellipsis">
      is_parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBase.make_parent" class="md-nav__link">
    <span class="md-ellipsis">
      make_parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBase.reset_state" class="md-nav__link">
    <span class="md-ellipsis">
      reset_state
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.Atom" class="md-nav__link">
    <span class="md-ellipsis">
      Atom
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Atom">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.type" class="md-nav__link">
    <span class="md-ellipsis">
      type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.atom_indices" class="md-nav__link">
    <span class="md-ellipsis">
      atom_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.coords" class="md-nav__link">
    <span class="md-ellipsis">
      coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.center_of_mass" class="md-nav__link">
    <span class="md-ellipsis">
      center_of_mass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.radius" class="md-nav__link">
    <span class="md-ellipsis">
      radius
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.x" class="md-nav__link">
    <span class="md-ellipsis">
      x
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.y" class="md-nav__link">
    <span class="md-ellipsis">
      y
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.z" class="md-nav__link">
    <span class="md-ellipsis">
      z
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.without_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      without_coordinates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.is_dependent" class="md-nav__link">
    <span class="md-ellipsis">
      is_dependent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.is_parent" class="md-nav__link">
    <span class="md-ellipsis">
      is_parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.make_parent" class="md-nav__link">
    <span class="md-ellipsis">
      make_parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.reset_state" class="md-nav__link">
    <span class="md-ellipsis">
      reset_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.is_backbone_and_cb" class="md-nav__link">
    <span class="md-ellipsis">
      is_backbone_and_cb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.is_backbone" class="md-nav__link">
    <span class="md-ellipsis">
      is_backbone
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.is_cb" class="md-nav__link">
    <span class="md-ellipsis">
      is_cb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.is_ca" class="md-nav__link">
    <span class="md-ellipsis">
      is_ca
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.is_heavy" class="md-nav__link">
    <span class="md-ellipsis">
      is_heavy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.get_atom_record" class="md-nav__link">
    <span class="md-ellipsis">
      get_atom_record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer" class="md-nav__link">
    <span class="md-ellipsis">
      StructureBaseContainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StructureBaseContainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer.reindex" class="md-nav__link">
    <span class="md-ellipsis">
      reindex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer.are_dependents" class="md-nav__link">
    <span class="md-ellipsis">
      are_dependents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer.append" class="md-nav__link">
    <span class="md-ellipsis">
      append
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer.delete" class="md-nav__link">
    <span class="md-ellipsis">
      delete
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer.insert" class="md-nav__link">
    <span class="md-ellipsis">
      insert
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer.set" class="md-nav__link">
    <span class="md-ellipsis">
      set
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer.reset_state" class="md-nav__link">
    <span class="md-ellipsis">
      reset_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer.set_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      set_attributes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.Atoms" class="md-nav__link">
    <span class="md-ellipsis">
      Atoms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Atoms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.Atoms.reindex" class="md-nav__link">
    <span class="md-ellipsis">
      reindex
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms" class="md-nav__link">
    <span class="md-ellipsis">
      ContainsAtoms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContainsAtoms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.atoms" class="md-nav__link">
    <span class="md-ellipsis">
      atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.atom_indices" class="md-nav__link">
    <span class="md-ellipsis">
      atom_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.number_of_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      number_of_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.backbone_and_cb_indices" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_and_cb_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.backbone_indices" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.ca_indices" class="md-nav__link">
    <span class="md-ellipsis">
      ca_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.cb_indices" class="md-nav__link">
    <span class="md-ellipsis">
      cb_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.heavy_indices" class="md-nav__link">
    <span class="md-ellipsis">
      heavy_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.side_chain_indices" class="md-nav__link">
    <span class="md-ellipsis">
      side_chain_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.backbone_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.backbone_and_cb_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_and_cb_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.ca_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      ca_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.cb_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      cb_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.heavy_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      heavy_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.side_chain_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      side_chain_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.center_of_mass" class="md-nav__link">
    <span class="md-ellipsis">
      center_of_mass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.radius" class="md-nav__link">
    <span class="md-ellipsis">
      radius
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.radius_of_gyration" class="md-nav__link">
    <span class="md-ellipsis">
      radius_of_gyration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.backbone_coords" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.backbone_and_cb_coords" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_and_cb_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.ca_coords" class="md-nav__link">
    <span class="md-ellipsis">
      ca_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.cb_coords" class="md-nav__link">
    <span class="md-ellipsis">
      cb_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.heavy_coords" class="md-nav__link">
    <span class="md-ellipsis">
      heavy_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.side_chain_coords" class="md-nav__link">
    <span class="md-ellipsis">
      side_chain_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.start_index" class="md-nav__link">
    <span class="md-ellipsis">
      start_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.end_index" class="md-nav__link">
    <span class="md-ellipsis">
      end_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.make_parent" class="md-nav__link">
    <span class="md-ellipsis">
      make_parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.get_base_containers" class="md-nav__link">
    <span class="md-ellipsis">
      get_base_containers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.neighboring_atom_indices" class="md-nav__link">
    <span class="md-ellipsis">
      neighboring_atom_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.atom" class="md-nav__link">
    <span class="md-ellipsis">
      atom
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.renumber_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      renumber_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.reset_indices" class="md-nav__link">
    <span class="md-ellipsis">
      reset_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.format_header" class="md-nav__link">
    <span class="md-ellipsis">
      format_header
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.get_atom_record" class="md-nav__link">
    <span class="md-ellipsis">
      get_atom_record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.write" class="md-nav__link">
    <span class="md-ellipsis">
      write
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.get_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      get_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.set_atoms_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      set_atoms_attributes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.Residue" class="md-nav__link">
    <span class="md-ellipsis">
      Residue
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Residue">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.index" class="md-nav__link">
    <span class="md-ellipsis">
      index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.range" class="md-nav__link">
    <span class="md-ellipsis">
      range
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.type1" class="md-nav__link">
    <span class="md-ellipsis">
      type1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.backbone_indices" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.backbone_and_cb_indices" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_and_cb_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.ca_indices" class="md-nav__link">
    <span class="md-ellipsis">
      ca_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.cb_indices" class="md-nav__link">
    <span class="md-ellipsis">
      cb_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.side_chain_indices" class="md-nav__link">
    <span class="md-ellipsis">
      side_chain_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.heavy_indices" class="md-nav__link">
    <span class="md-ellipsis">
      heavy_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.n" class="md-nav__link">
    <span class="md-ellipsis">
      n
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.n_coords" class="md-nav__link">
    <span class="md-ellipsis">
      n_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.n_atom_index" class="md-nav__link">
    <span class="md-ellipsis">
      n_atom_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.n_index" class="md-nav__link">
    <span class="md-ellipsis">
      n_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.h" class="md-nav__link">
    <span class="md-ellipsis">
      h
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.h_coords" class="md-nav__link">
    <span class="md-ellipsis">
      h_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.h_atom_index" class="md-nav__link">
    <span class="md-ellipsis">
      h_atom_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.h_index" class="md-nav__link">
    <span class="md-ellipsis">
      h_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.ca" class="md-nav__link">
    <span class="md-ellipsis">
      ca
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.ca_coords" class="md-nav__link">
    <span class="md-ellipsis">
      ca_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.ca_atom_index" class="md-nav__link">
    <span class="md-ellipsis">
      ca_atom_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.ca_index" class="md-nav__link">
    <span class="md-ellipsis">
      ca_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.cb" class="md-nav__link">
    <span class="md-ellipsis">
      cb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.cb_coords" class="md-nav__link">
    <span class="md-ellipsis">
      cb_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.cb_atom_index" class="md-nav__link">
    <span class="md-ellipsis">
      cb_atom_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.cb_index" class="md-nav__link">
    <span class="md-ellipsis">
      cb_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.c" class="md-nav__link">
    <span class="md-ellipsis">
      c
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.c_coords" class="md-nav__link">
    <span class="md-ellipsis">
      c_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.c_atom_index" class="md-nav__link">
    <span class="md-ellipsis">
      c_atom_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.c_index" class="md-nav__link">
    <span class="md-ellipsis">
      c_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.o" class="md-nav__link">
    <span class="md-ellipsis">
      o
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.o_coords" class="md-nav__link">
    <span class="md-ellipsis">
      o_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.o_atom_index" class="md-nav__link">
    <span class="md-ellipsis">
      o_atom_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.o_index" class="md-nav__link">
    <span class="md-ellipsis">
      o_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.prev_residue" class="md-nav__link">
    <span class="md-ellipsis">
      prev_residue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.next_residue" class="md-nav__link">
    <span class="md-ellipsis">
      next_residue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.local_density" class="md-nav__link">
    <span class="md-ellipsis">
      local_density
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.secondary_structure" class="md-nav__link">
    <span class="md-ellipsis">
      secondary_structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.sasa" class="md-nav__link">
    <span class="md-ellipsis">
      sasa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.sasa_apolar" class="md-nav__link">
    <span class="md-ellipsis">
      sasa_apolar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.sasa_polar" class="md-nav__link">
    <span class="md-ellipsis">
      sasa_polar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.relative_sasa" class="md-nav__link">
    <span class="md-ellipsis">
      relative_sasa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.spatial_aggregation_propensity" class="md-nav__link">
    <span class="md-ellipsis">
      spatial_aggregation_propensity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.contact_order" class="md-nav__link">
    <span class="md-ellipsis">
      contact_order
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.start_index" class="md-nav__link">
    <span class="md-ellipsis">
      start_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.delegate_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      delegate_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.contains_hydrogen" class="md-nav__link">
    <span class="md-ellipsis">
      contains_hydrogen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.is_n_termini" class="md-nav__link">
    <span class="md-ellipsis">
      is_n_termini
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.is_c_termini" class="md-nav__link">
    <span class="md-ellipsis">
      is_c_termini
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.get_upstream" class="md-nav__link">
    <span class="md-ellipsis">
      get_upstream
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.get_downstream" class="md-nav__link">
    <span class="md-ellipsis">
      get_downstream
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.get_neighbors" class="md-nav__link">
    <span class="md-ellipsis">
      get_neighbors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.mutation_possibilities_from_directive" class="md-nav__link">
    <span class="md-ellipsis">
      mutation_possibilities_from_directive
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.distance" class="md-nav__link">
    <span class="md-ellipsis">
      distance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.get_atom_record" class="md-nav__link">
    <span class="md-ellipsis">
      get_atom_record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.Residues" class="md-nav__link">
    <span class="md-ellipsis">
      Residues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Residues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.Residues.reindex" class="md-nav__link">
    <span class="md-ellipsis">
      reindex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residues.set_index" class="md-nav__link">
    <span class="md-ellipsis">
      set_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residues.reindex_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      reindex_atoms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.StructureIndexMixin" class="md-nav__link">
    <span class="md-ellipsis">
      StructureIndexMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StructureIndexMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureIndexMixin.is_parent" class="md-nav__link">
    <span class="md-ellipsis">
      is_parent
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues" class="md-nav__link">
    <span class="md-ellipsis">
      ContainsResidues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContainsResidues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.ss_sequence_indices" class="md-nav__link">
    <span class="md-ellipsis">
      ss_sequence_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.ss_type_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      ss_type_sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.fragment_db" class="md-nav__link">
    <span class="md-ellipsis">
      fragment_db
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.sequence" class="md-nav__link">
    <span class="md-ellipsis">
      sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.residue_indices" class="md-nav__link">
    <span class="md-ellipsis">
      residue_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.residues" class="md-nav__link">
    <span class="md-ellipsis">
      residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.alphafold_atom_mask" class="md-nav__link">
    <span class="md-ellipsis">
      alphafold_atom_mask
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.alphafold_coords" class="md-nav__link">
    <span class="md-ellipsis">
      alphafold_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.coords_indexed_residues" class="md-nav__link">
    <span class="md-ellipsis">
      coords_indexed_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.backbone_coords_indexed_residues" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_coords_indexed_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.backbone_and_cb_coords_indexed_residues" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_and_cb_coords_indexed_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.heavy_coords_indexed_residues" class="md-nav__link">
    <span class="md-ellipsis">
      heavy_coords_indexed_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.side_chain_coords_indexed_residues" class="md-nav__link">
    <span class="md-ellipsis">
      side_chain_coords_indexed_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.number_of_residues" class="md-nav__link">
    <span class="md-ellipsis">
      number_of_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.backbone_indices" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.backbone_and_cb_indices" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_and_cb_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.cb_indices" class="md-nav__link">
    <span class="md-ellipsis">
      cb_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.ca_indices" class="md-nav__link">
    <span class="md-ellipsis">
      ca_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.heavy_indices" class="md-nav__link">
    <span class="md-ellipsis">
      heavy_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.side_chain_indices" class="md-nav__link">
    <span class="md-ellipsis">
      side_chain_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.helix_cb_indices" class="md-nav__link">
    <span class="md-ellipsis">
      helix_cb_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.n_terminal_residue" class="md-nav__link">
    <span class="md-ellipsis">
      n_terminal_residue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.c_terminal_residue" class="md-nav__link">
    <span class="md-ellipsis">
      c_terminal_residue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.relative_sasa" class="md-nav__link">
    <span class="md-ellipsis">
      relative_sasa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.sasa_apolar" class="md-nav__link">
    <span class="md-ellipsis">
      sasa_apolar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.sasa_polar" class="md-nav__link">
    <span class="md-ellipsis">
      sasa_polar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.surface_residues" class="md-nav__link">
    <span class="md-ellipsis">
      surface_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.interior_residues" class="md-nav__link">
    <span class="md-ellipsis">
      interior_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.secondary_structure" class="md-nav__link">
    <span class="md-ellipsis">
      secondary_structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.spatial_aggregation_propensity" class="md-nav__link">
    <span class="md-ellipsis">
      spatial_aggregation_propensity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.contact_order" class="md-nav__link">
    <span class="md-ellipsis">
      contact_order
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.from_residues" class="md-nav__link">
    <span class="md-ellipsis">
      from_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.from_structure" class="md-nav__link">
    <span class="md-ellipsis">
      from_structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.assign_residues_from_structures" class="md-nav__link">
    <span class="md-ellipsis">
      assign_residues_from_structures
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.make_parent" class="md-nav__link">
    <span class="md-ellipsis">
      make_parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_base_containers" class="md-nav__link">
    <span class="md-ellipsis">
      get_base_containers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.contains_hydrogen" class="md-nav__link">
    <span class="md-ellipsis">
      contains_hydrogen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_coords_subset" class="md-nav__link">
    <span class="md-ellipsis">
      get_coords_subset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.set_residues_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      set_residues_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_residue_atom_indices" class="md-nav__link">
    <span class="md-ellipsis">
      get_residue_atom_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_residues_by_atom_indices" class="md-nav__link">
    <span class="md-ellipsis">
      get_residues_by_atom_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.renumber" class="md-nav__link">
    <span class="md-ellipsis">
      renumber
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.pose_numbering" class="md-nav__link">
    <span class="md-ellipsis">
      pose_numbering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.renumber_residues" class="md-nav__link">
    <span class="md-ellipsis">
      renumber_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_residues" class="md-nav__link">
    <span class="md-ellipsis">
      get_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.residue" class="md-nav__link">
    <span class="md-ellipsis">
      residue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.add_ideal_helix" class="md-nav__link">
    <span class="md-ellipsis">
      add_ideal_helix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_residue_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      get_residue_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.mutate_residue" class="md-nav__link">
    <span class="md-ellipsis">
      mutate_residue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.delete_residues" class="md-nav__link">
    <span class="md-ellipsis">
      delete_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.insert_residue_type" class="md-nav__link">
    <span class="md-ellipsis">
      insert_residue_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.insert_residues" class="md-nav__link">
    <span class="md-ellipsis">
      insert_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.delete_termini" class="md-nav__link">
    <span class="md-ellipsis">
      delete_termini
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.local_density" class="md-nav__link">
    <span class="md-ellipsis">
      local_density
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.is_clash" class="md-nav__link">
    <span class="md-ellipsis">
      is_clash
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_sasa" class="md-nav__link">
    <span class="md-ellipsis">
      get_sasa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_surface_area_residues" class="md-nav__link">
    <span class="md-ellipsis">
      get_surface_area_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.errat" class="md-nav__link">
    <span class="md-ellipsis">
      errat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.stride" class="md-nav__link">
    <span class="md-ellipsis">
      stride
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.is_termini_helical" class="md-nav__link">
    <span class="md-ellipsis">
      is_termini_helical
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.calculate_secondary_structure" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_secondary_structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.termini_proximity_from_reference" class="md-nav__link">
    <span class="md-ellipsis">
      termini_proximity_from_reference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_atom_record" class="md-nav__link">
    <span class="md-ellipsis">
      get_atom_record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_fragments" class="md-nav__link">
    <span class="md-ellipsis">
      get_fragments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_fragment_residues" class="md-nav__link">
    <span class="md-ellipsis">
      get_fragment_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.find_fragments" class="md-nav__link">
    <span class="md-ellipsis">
      find_fragments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.spatial_aggregation_propensity_per_residue" class="md-nav__link">
    <span class="md-ellipsis">
      spatial_aggregation_propensity_per_residue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.contact_order_per_residue" class="md-nav__link">
    <span class="md-ellipsis">
      contact_order_per_residue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.format_resfile_from_directives" class="md-nav__link">
    <span class="md-ellipsis">
      format_resfile_from_directives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.make_resfile" class="md-nav__link">
    <span class="md-ellipsis">
      make_resfile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.set_b_factor_by_attribute" class="md-nav__link">
    <span class="md-ellipsis">
      set_b_factor_by_attribute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.set_b_factor_data" class="md-nav__link">
    <span class="md-ellipsis">
      set_b_factor_data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.Structures" class="md-nav__link">
    <span class="md-ellipsis">
      Structures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Structures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.Structures.dtype" class="md-nav__link">
    <span class="md-ellipsis">
      dtype
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Structures.structures" class="md-nav__link">
    <span class="md-ellipsis">
      structures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.parse_seqres" class="md-nav__link">
    <span class="md-ellipsis">
      parse_seqres
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.read_pdb_file" class="md-nav__link">
    <span class="md-ellipsis">
      read_pdb_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.read_mmcif_file" class="md-nav__link">
    <span class="md-ellipsis">
      read_mmcif_file
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../coordinates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    coordinates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../fragment/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    fragment
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_7_3" id="__nav_3_7_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_7_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_7_3">
            <span class="md-nav__icon md-icon"></span>
            fragment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fragment/db/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    db
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fragment/info/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    info
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fragment/metrics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    metrics
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fragment/visuals/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    visuals
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../model/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sequence/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    sequence
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    utils
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../tools/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    tools
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_8" id="__nav_3_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_8">
            <span class="md-nav__icon md-icon"></span>
            tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/BenchmarkCollapseHydrophobicityScale/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BenchmarkCollapseHydrophobicityScale
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/ConcatenatePDBFiles/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ConcatenatePDBFiles
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/ProfileScripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ProfileScripts
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/SlurmControl/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SlurmControl
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/distribute/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    distribute
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/fetch_commands_from_slurm_output/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    fetch_commands_from_slurm_output
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/format_commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    format_commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/format_pose_ids/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    format_pose_ids
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/generate_reference_docs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    generate_reference_docs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/get_array_numbers_from_identifiers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    get_array_numbers_from_identifiers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/list_files_in_directory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_files_in_directory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/list_overlap/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    list_overlap
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/models_to_multimodel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    models_to_multimodel
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/profile_gpu_nodes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    profile_gpu_nodes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/retrieve_oligomers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    retrieve_oligomers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/retrieve_pdbs_by_advanced_query/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    retrieve_pdbs_by_advanced_query
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tools/write_indices_for_C1_docking/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    write_indices_for_C1_docking
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../utils/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    utils
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_9" id="__nav_3_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_9">
            <span class="md-nav__icon md-icon"></span>
            utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/SymEntry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SymEntry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/guide/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    guide
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/nanohedra_parsing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    nanohedra_parsing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/path/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    path
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/query/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    query
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/rosetta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rosetta
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/symmetry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    symmetry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/types/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    types
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../visualization/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    visualization
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_10" id="__nav_3_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_10">
            <span class="md-nav__icon md-icon"></span>
            visualization
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualization/SymmetryMates/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SymmetryMates
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualization/VisualizeUtils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    VisualizeUtils
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../visualization/shapes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    shapes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#structure.base" class="md-nav__link">
    <span class="md-ellipsis">
      base
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.DEFAULT_SS_COIL_IDENTIFIER" class="md-nav__link">
    <span class="md-ellipsis">
      DEFAULT_SS_COIL_IDENTIFIER
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.alpha_helix_15_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      alpha_helix_15_atoms
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.ArrayIndexer" class="md-nav__link">
    <span class="md-ellipsis">
      ArrayIndexer
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.Log" class="md-nav__link">
    <span class="md-ellipsis">
      Log
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.SymmetryBase" class="md-nav__link">
    <span class="md-ellipsis">
      SymmetryBase
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SymmetryBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.SymmetryBase.symmetry" class="md-nav__link">
    <span class="md-ellipsis">
      symmetry
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.SymmetryBase.symmetric_dependents" class="md-nav__link">
    <span class="md-ellipsis">
      symmetric_dependents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.SymmetryBase.reset_symmetry_state" class="md-nav__link">
    <span class="md-ellipsis">
      reset_symmetry_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.SymmetryBase.is_symmetric" class="md-nav__link">
    <span class="md-ellipsis">
      is_symmetric
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.SymmetryBase.has_symmetric_dependents" class="md-nav__link">
    <span class="md-ellipsis">
      has_symmetric_dependents
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.StructureMetadata" class="md-nav__link">
    <span class="md-ellipsis">
      StructureMetadata
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.CoordinateOpsMixin" class="md-nav__link">
    <span class="md-ellipsis">
      CoordinateOpsMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CoordinateOpsMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.CoordinateOpsMixin.coords" class="md-nav__link">
    <span class="md-ellipsis">
      coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.CoordinateOpsMixin.distance_from_reference" class="md-nav__link">
    <span class="md-ellipsis">
      distance_from_reference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.CoordinateOpsMixin.translate" class="md-nav__link">
    <span class="md-ellipsis">
      translate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.CoordinateOpsMixin.rotate" class="md-nav__link">
    <span class="md-ellipsis">
      rotate
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.CoordinateOpsMixin.transform" class="md-nav__link">
    <span class="md-ellipsis">
      transform
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.CoordinateOpsMixin.copy" class="md-nav__link">
    <span class="md-ellipsis">
      copy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.CoordinateOpsMixin.get_transformed_copy" class="md-nav__link">
    <span class="md-ellipsis">
      get_transformed_copy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.StructureBase" class="md-nav__link">
    <span class="md-ellipsis">
      StructureBase
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StructureBase">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBase.parent" class="md-nav__link">
    <span class="md-ellipsis">
      parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBase.log" class="md-nav__link">
    <span class="md-ellipsis">
      log
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBase.coords" class="md-nav__link">
    <span class="md-ellipsis">
      coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBase.is_dependent" class="md-nav__link">
    <span class="md-ellipsis">
      is_dependent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBase.is_parent" class="md-nav__link">
    <span class="md-ellipsis">
      is_parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBase.make_parent" class="md-nav__link">
    <span class="md-ellipsis">
      make_parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBase.reset_state" class="md-nav__link">
    <span class="md-ellipsis">
      reset_state
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.Atom" class="md-nav__link">
    <span class="md-ellipsis">
      Atom
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Atom">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.type" class="md-nav__link">
    <span class="md-ellipsis">
      type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.atom_indices" class="md-nav__link">
    <span class="md-ellipsis">
      atom_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.coords" class="md-nav__link">
    <span class="md-ellipsis">
      coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.center_of_mass" class="md-nav__link">
    <span class="md-ellipsis">
      center_of_mass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.radius" class="md-nav__link">
    <span class="md-ellipsis">
      radius
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.x" class="md-nav__link">
    <span class="md-ellipsis">
      x
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.y" class="md-nav__link">
    <span class="md-ellipsis">
      y
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.z" class="md-nav__link">
    <span class="md-ellipsis">
      z
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.without_coordinates" class="md-nav__link">
    <span class="md-ellipsis">
      without_coordinates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.is_dependent" class="md-nav__link">
    <span class="md-ellipsis">
      is_dependent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.is_parent" class="md-nav__link">
    <span class="md-ellipsis">
      is_parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.make_parent" class="md-nav__link">
    <span class="md-ellipsis">
      make_parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.reset_state" class="md-nav__link">
    <span class="md-ellipsis">
      reset_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.is_backbone_and_cb" class="md-nav__link">
    <span class="md-ellipsis">
      is_backbone_and_cb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.is_backbone" class="md-nav__link">
    <span class="md-ellipsis">
      is_backbone
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.is_cb" class="md-nav__link">
    <span class="md-ellipsis">
      is_cb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.is_ca" class="md-nav__link">
    <span class="md-ellipsis">
      is_ca
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.is_heavy" class="md-nav__link">
    <span class="md-ellipsis">
      is_heavy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.get_atom_record" class="md-nav__link">
    <span class="md-ellipsis">
      get_atom_record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Atom.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer" class="md-nav__link">
    <span class="md-ellipsis">
      StructureBaseContainer
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StructureBaseContainer">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer.reindex" class="md-nav__link">
    <span class="md-ellipsis">
      reindex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer.are_dependents" class="md-nav__link">
    <span class="md-ellipsis">
      are_dependents
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer.append" class="md-nav__link">
    <span class="md-ellipsis">
      append
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer.delete" class="md-nav__link">
    <span class="md-ellipsis">
      delete
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer.insert" class="md-nav__link">
    <span class="md-ellipsis">
      insert
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer.set" class="md-nav__link">
    <span class="md-ellipsis">
      set
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer.reset_state" class="md-nav__link">
    <span class="md-ellipsis">
      reset_state
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureBaseContainer.set_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      set_attributes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.Atoms" class="md-nav__link">
    <span class="md-ellipsis">
      Atoms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Atoms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.Atoms.reindex" class="md-nav__link">
    <span class="md-ellipsis">
      reindex
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms" class="md-nav__link">
    <span class="md-ellipsis">
      ContainsAtoms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContainsAtoms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.atoms" class="md-nav__link">
    <span class="md-ellipsis">
      atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.atom_indices" class="md-nav__link">
    <span class="md-ellipsis">
      atom_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.number_of_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      number_of_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.backbone_and_cb_indices" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_and_cb_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.backbone_indices" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.ca_indices" class="md-nav__link">
    <span class="md-ellipsis">
      ca_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.cb_indices" class="md-nav__link">
    <span class="md-ellipsis">
      cb_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.heavy_indices" class="md-nav__link">
    <span class="md-ellipsis">
      heavy_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.side_chain_indices" class="md-nav__link">
    <span class="md-ellipsis">
      side_chain_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.backbone_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.backbone_and_cb_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_and_cb_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.ca_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      ca_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.cb_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      cb_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.heavy_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      heavy_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.side_chain_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      side_chain_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.center_of_mass" class="md-nav__link">
    <span class="md-ellipsis">
      center_of_mass
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.radius" class="md-nav__link">
    <span class="md-ellipsis">
      radius
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.radius_of_gyration" class="md-nav__link">
    <span class="md-ellipsis">
      radius_of_gyration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.backbone_coords" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.backbone_and_cb_coords" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_and_cb_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.ca_coords" class="md-nav__link">
    <span class="md-ellipsis">
      ca_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.cb_coords" class="md-nav__link">
    <span class="md-ellipsis">
      cb_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.heavy_coords" class="md-nav__link">
    <span class="md-ellipsis">
      heavy_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.side_chain_coords" class="md-nav__link">
    <span class="md-ellipsis">
      side_chain_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.start_index" class="md-nav__link">
    <span class="md-ellipsis">
      start_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.end_index" class="md-nav__link">
    <span class="md-ellipsis">
      end_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.make_parent" class="md-nav__link">
    <span class="md-ellipsis">
      make_parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.get_base_containers" class="md-nav__link">
    <span class="md-ellipsis">
      get_base_containers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.neighboring_atom_indices" class="md-nav__link">
    <span class="md-ellipsis">
      neighboring_atom_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.atom" class="md-nav__link">
    <span class="md-ellipsis">
      atom
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.renumber_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      renumber_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.reset_indices" class="md-nav__link">
    <span class="md-ellipsis">
      reset_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.format_header" class="md-nav__link">
    <span class="md-ellipsis">
      format_header
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.get_atom_record" class="md-nav__link">
    <span class="md-ellipsis">
      get_atom_record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.write" class="md-nav__link">
    <span class="md-ellipsis">
      write
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.get_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      get_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsAtoms.set_atoms_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      set_atoms_attributes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.Residue" class="md-nav__link">
    <span class="md-ellipsis">
      Residue
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Residue">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.index" class="md-nav__link">
    <span class="md-ellipsis">
      index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.range" class="md-nav__link">
    <span class="md-ellipsis">
      range
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.type1" class="md-nav__link">
    <span class="md-ellipsis">
      type1
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.backbone_indices" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.backbone_and_cb_indices" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_and_cb_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.ca_indices" class="md-nav__link">
    <span class="md-ellipsis">
      ca_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.cb_indices" class="md-nav__link">
    <span class="md-ellipsis">
      cb_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.side_chain_indices" class="md-nav__link">
    <span class="md-ellipsis">
      side_chain_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.heavy_indices" class="md-nav__link">
    <span class="md-ellipsis">
      heavy_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.n" class="md-nav__link">
    <span class="md-ellipsis">
      n
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.n_coords" class="md-nav__link">
    <span class="md-ellipsis">
      n_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.n_atom_index" class="md-nav__link">
    <span class="md-ellipsis">
      n_atom_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.n_index" class="md-nav__link">
    <span class="md-ellipsis">
      n_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.h" class="md-nav__link">
    <span class="md-ellipsis">
      h
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.h_coords" class="md-nav__link">
    <span class="md-ellipsis">
      h_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.h_atom_index" class="md-nav__link">
    <span class="md-ellipsis">
      h_atom_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.h_index" class="md-nav__link">
    <span class="md-ellipsis">
      h_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.ca" class="md-nav__link">
    <span class="md-ellipsis">
      ca
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.ca_coords" class="md-nav__link">
    <span class="md-ellipsis">
      ca_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.ca_atom_index" class="md-nav__link">
    <span class="md-ellipsis">
      ca_atom_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.ca_index" class="md-nav__link">
    <span class="md-ellipsis">
      ca_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.cb" class="md-nav__link">
    <span class="md-ellipsis">
      cb
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.cb_coords" class="md-nav__link">
    <span class="md-ellipsis">
      cb_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.cb_atom_index" class="md-nav__link">
    <span class="md-ellipsis">
      cb_atom_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.cb_index" class="md-nav__link">
    <span class="md-ellipsis">
      cb_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.c" class="md-nav__link">
    <span class="md-ellipsis">
      c
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.c_coords" class="md-nav__link">
    <span class="md-ellipsis">
      c_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.c_atom_index" class="md-nav__link">
    <span class="md-ellipsis">
      c_atom_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.c_index" class="md-nav__link">
    <span class="md-ellipsis">
      c_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.o" class="md-nav__link">
    <span class="md-ellipsis">
      o
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.o_coords" class="md-nav__link">
    <span class="md-ellipsis">
      o_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.o_atom_index" class="md-nav__link">
    <span class="md-ellipsis">
      o_atom_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.o_index" class="md-nav__link">
    <span class="md-ellipsis">
      o_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.prev_residue" class="md-nav__link">
    <span class="md-ellipsis">
      prev_residue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.next_residue" class="md-nav__link">
    <span class="md-ellipsis">
      next_residue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.local_density" class="md-nav__link">
    <span class="md-ellipsis">
      local_density
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.secondary_structure" class="md-nav__link">
    <span class="md-ellipsis">
      secondary_structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.sasa" class="md-nav__link">
    <span class="md-ellipsis">
      sasa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.sasa_apolar" class="md-nav__link">
    <span class="md-ellipsis">
      sasa_apolar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.sasa_polar" class="md-nav__link">
    <span class="md-ellipsis">
      sasa_polar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.relative_sasa" class="md-nav__link">
    <span class="md-ellipsis">
      relative_sasa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.spatial_aggregation_propensity" class="md-nav__link">
    <span class="md-ellipsis">
      spatial_aggregation_propensity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.contact_order" class="md-nav__link">
    <span class="md-ellipsis">
      contact_order
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.start_index" class="md-nav__link">
    <span class="md-ellipsis">
      start_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.delegate_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      delegate_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.contains_hydrogen" class="md-nav__link">
    <span class="md-ellipsis">
      contains_hydrogen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.is_n_termini" class="md-nav__link">
    <span class="md-ellipsis">
      is_n_termini
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.is_c_termini" class="md-nav__link">
    <span class="md-ellipsis">
      is_c_termini
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.get_upstream" class="md-nav__link">
    <span class="md-ellipsis">
      get_upstream
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.get_downstream" class="md-nav__link">
    <span class="md-ellipsis">
      get_downstream
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.get_neighbors" class="md-nav__link">
    <span class="md-ellipsis">
      get_neighbors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.mutation_possibilities_from_directive" class="md-nav__link">
    <span class="md-ellipsis">
      mutation_possibilities_from_directive
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.distance" class="md-nav__link">
    <span class="md-ellipsis">
      distance
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.get_atom_record" class="md-nav__link">
    <span class="md-ellipsis">
      get_atom_record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residue.__str__" class="md-nav__link">
    <span class="md-ellipsis">
      __str__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.Residues" class="md-nav__link">
    <span class="md-ellipsis">
      Residues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Residues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.Residues.reindex" class="md-nav__link">
    <span class="md-ellipsis">
      reindex
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residues.set_index" class="md-nav__link">
    <span class="md-ellipsis">
      set_index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Residues.reindex_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      reindex_atoms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.StructureIndexMixin" class="md-nav__link">
    <span class="md-ellipsis">
      StructureIndexMixin
    </span>
  </a>
  
    <nav class="md-nav" aria-label="StructureIndexMixin">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.StructureIndexMixin.is_parent" class="md-nav__link">
    <span class="md-ellipsis">
      is_parent
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues" class="md-nav__link">
    <span class="md-ellipsis">
      ContainsResidues
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ContainsResidues">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.ss_sequence_indices" class="md-nav__link">
    <span class="md-ellipsis">
      ss_sequence_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.ss_type_sequence" class="md-nav__link">
    <span class="md-ellipsis">
      ss_type_sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.fragment_db" class="md-nav__link">
    <span class="md-ellipsis">
      fragment_db
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.sequence" class="md-nav__link">
    <span class="md-ellipsis">
      sequence
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.residue_indices" class="md-nav__link">
    <span class="md-ellipsis">
      residue_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.residues" class="md-nav__link">
    <span class="md-ellipsis">
      residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.alphafold_atom_mask" class="md-nav__link">
    <span class="md-ellipsis">
      alphafold_atom_mask
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.alphafold_coords" class="md-nav__link">
    <span class="md-ellipsis">
      alphafold_coords
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.coords_indexed_residues" class="md-nav__link">
    <span class="md-ellipsis">
      coords_indexed_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.backbone_coords_indexed_residues" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_coords_indexed_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.backbone_and_cb_coords_indexed_residues" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_and_cb_coords_indexed_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.heavy_coords_indexed_residues" class="md-nav__link">
    <span class="md-ellipsis">
      heavy_coords_indexed_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.side_chain_coords_indexed_residues" class="md-nav__link">
    <span class="md-ellipsis">
      side_chain_coords_indexed_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.number_of_residues" class="md-nav__link">
    <span class="md-ellipsis">
      number_of_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.backbone_indices" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.backbone_and_cb_indices" class="md-nav__link">
    <span class="md-ellipsis">
      backbone_and_cb_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.cb_indices" class="md-nav__link">
    <span class="md-ellipsis">
      cb_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.ca_indices" class="md-nav__link">
    <span class="md-ellipsis">
      ca_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.heavy_indices" class="md-nav__link">
    <span class="md-ellipsis">
      heavy_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.side_chain_indices" class="md-nav__link">
    <span class="md-ellipsis">
      side_chain_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.helix_cb_indices" class="md-nav__link">
    <span class="md-ellipsis">
      helix_cb_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.n_terminal_residue" class="md-nav__link">
    <span class="md-ellipsis">
      n_terminal_residue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.c_terminal_residue" class="md-nav__link">
    <span class="md-ellipsis">
      c_terminal_residue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.relative_sasa" class="md-nav__link">
    <span class="md-ellipsis">
      relative_sasa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.sasa_apolar" class="md-nav__link">
    <span class="md-ellipsis">
      sasa_apolar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.sasa_polar" class="md-nav__link">
    <span class="md-ellipsis">
      sasa_polar
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.surface_residues" class="md-nav__link">
    <span class="md-ellipsis">
      surface_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.interior_residues" class="md-nav__link">
    <span class="md-ellipsis">
      interior_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.secondary_structure" class="md-nav__link">
    <span class="md-ellipsis">
      secondary_structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.spatial_aggregation_propensity" class="md-nav__link">
    <span class="md-ellipsis">
      spatial_aggregation_propensity
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.contact_order" class="md-nav__link">
    <span class="md-ellipsis">
      contact_order
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.from_residues" class="md-nav__link">
    <span class="md-ellipsis">
      from_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.from_structure" class="md-nav__link">
    <span class="md-ellipsis">
      from_structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.assign_residues_from_structures" class="md-nav__link">
    <span class="md-ellipsis">
      assign_residues_from_structures
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.make_parent" class="md-nav__link">
    <span class="md-ellipsis">
      make_parent
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_base_containers" class="md-nav__link">
    <span class="md-ellipsis">
      get_base_containers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.contains_hydrogen" class="md-nav__link">
    <span class="md-ellipsis">
      contains_hydrogen
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_coords_subset" class="md-nav__link">
    <span class="md-ellipsis">
      get_coords_subset
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.set_residues_attributes" class="md-nav__link">
    <span class="md-ellipsis">
      set_residues_attributes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_residue_atom_indices" class="md-nav__link">
    <span class="md-ellipsis">
      get_residue_atom_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_residues_by_atom_indices" class="md-nav__link">
    <span class="md-ellipsis">
      get_residues_by_atom_indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.renumber" class="md-nav__link">
    <span class="md-ellipsis">
      renumber
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.pose_numbering" class="md-nav__link">
    <span class="md-ellipsis">
      pose_numbering
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.renumber_residues" class="md-nav__link">
    <span class="md-ellipsis">
      renumber_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_residues" class="md-nav__link">
    <span class="md-ellipsis">
      get_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.residue" class="md-nav__link">
    <span class="md-ellipsis">
      residue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.add_ideal_helix" class="md-nav__link">
    <span class="md-ellipsis">
      add_ideal_helix
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_residue_atoms" class="md-nav__link">
    <span class="md-ellipsis">
      get_residue_atoms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.mutate_residue" class="md-nav__link">
    <span class="md-ellipsis">
      mutate_residue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.delete_residues" class="md-nav__link">
    <span class="md-ellipsis">
      delete_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.insert_residue_type" class="md-nav__link">
    <span class="md-ellipsis">
      insert_residue_type
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.insert_residues" class="md-nav__link">
    <span class="md-ellipsis">
      insert_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.delete_termini" class="md-nav__link">
    <span class="md-ellipsis">
      delete_termini
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.local_density" class="md-nav__link">
    <span class="md-ellipsis">
      local_density
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.is_clash" class="md-nav__link">
    <span class="md-ellipsis">
      is_clash
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_sasa" class="md-nav__link">
    <span class="md-ellipsis">
      get_sasa
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_surface_area_residues" class="md-nav__link">
    <span class="md-ellipsis">
      get_surface_area_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.errat" class="md-nav__link">
    <span class="md-ellipsis">
      errat
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.stride" class="md-nav__link">
    <span class="md-ellipsis">
      stride
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.is_termini_helical" class="md-nav__link">
    <span class="md-ellipsis">
      is_termini_helical
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.calculate_secondary_structure" class="md-nav__link">
    <span class="md-ellipsis">
      calculate_secondary_structure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.termini_proximity_from_reference" class="md-nav__link">
    <span class="md-ellipsis">
      termini_proximity_from_reference
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_atom_record" class="md-nav__link">
    <span class="md-ellipsis">
      get_atom_record
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_fragments" class="md-nav__link">
    <span class="md-ellipsis">
      get_fragments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.get_fragment_residues" class="md-nav__link">
    <span class="md-ellipsis">
      get_fragment_residues
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.find_fragments" class="md-nav__link">
    <span class="md-ellipsis">
      find_fragments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.spatial_aggregation_propensity_per_residue" class="md-nav__link">
    <span class="md-ellipsis">
      spatial_aggregation_propensity_per_residue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.contact_order_per_residue" class="md-nav__link">
    <span class="md-ellipsis">
      contact_order_per_residue
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.format_resfile_from_directives" class="md-nav__link">
    <span class="md-ellipsis">
      format_resfile_from_directives
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.make_resfile" class="md-nav__link">
    <span class="md-ellipsis">
      make_resfile
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.set_b_factor_by_attribute" class="md-nav__link">
    <span class="md-ellipsis">
      set_b_factor_by_attribute
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.ContainsResidues.set_b_factor_data" class="md-nav__link">
    <span class="md-ellipsis">
      set_b_factor_data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.Structures" class="md-nav__link">
    <span class="md-ellipsis">
      Structures
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Structures">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#structure.base.Structures.dtype" class="md-nav__link">
    <span class="md-ellipsis">
      dtype
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#structure.base.Structures.structures" class="md-nav__link">
    <span class="md-ellipsis">
      structures
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.parse_seqres" class="md-nav__link">
    <span class="md-ellipsis">
      parse_seqres
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.read_pdb_file" class="md-nav__link">
    <span class="md-ellipsis">
      read_pdb_file
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#structure.base.read_mmcif_file" class="md-nav__link">
    <span class="md-ellipsis">
      read_mmcif_file
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


  <h1>base</h1>

<div class="doc doc-object doc-module">



<a id="structure.base"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="structure.base.DEFAULT_SS_COIL_IDENTIFIER" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">DEFAULT_SS_COIL_IDENTIFIER</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">DEFAULT_SS_COIL_IDENTIFIER</span> <span class="o">=</span> <span class="s1">&#39;C&#39;</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Secondary structure identifier mapping
Stride
B/b:Isolated bridge
E:Strand/Extended conformation 
G:3-10 helix
H:Alpha helix
I:PI-helix
T:Turn
C:Coil (none of the above)
SS_TURN_IDENTIFIERS = 'T'
SS_DISORDER_IDENTIFIERS = 'C'</p>
<p>DSSP
B:beta bridge
E:strand/beta bulge
G:310 helix
H: helix
I: helix
T:turns
S:high curvature (where the angle between i-2, i, and i+2 is at least 70)
" "(space):loop
SS_DISORDER_IDENTIFIERS = ' '
SS_TURN_IDENTIFIERS = 'TS'</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="structure.base.alpha_helix_15_atoms" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">alpha_helix_15_atoms</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">alpha_helix_15_atoms</span> <span class="o">=</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atoms" href="#structure.base.Atoms">Atoms</a></span><span class="p">([</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">27.128</span><span class="p">,</span> <span class="mf">20.897</span><span class="p">,</span> <span class="mf">37.943</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">27.933</span><span class="p">,</span> <span class="mf">21.94</span><span class="p">,</span> <span class="mf">38.546</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">28.402</span><span class="p">,</span> <span class="mf">22.92</span><span class="p">,</span> <span class="mf">37.481</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">28.303</span><span class="p">,</span> <span class="mf">24.132</span><span class="p">,</span> <span class="mf">37.663</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">29.162</span><span class="p">,</span> <span class="mf">21.356</span><span class="p">,</span> <span class="mf">39.234</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">28.914</span><span class="p">,</span> <span class="mf">22.392</span><span class="p">,</span> <span class="mf">36.367</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">29.395</span><span class="p">,</span> <span class="mf">23.219</span><span class="p">,</span> <span class="mf">35.278</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">28.286</span><span class="p">,</span> <span class="mf">24.142</span><span class="p">,</span> <span class="mf">34.793</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">28.508</span><span class="p">,</span> <span class="mf">25.337</span><span class="p">,</span> <span class="mf">34.61</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">29.857</span><span class="p">,</span> <span class="mf">22.365</span><span class="p">,</span> <span class="mf">34.102</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">27.092</span><span class="p">,</span> <span class="mf">23.583</span><span class="p">,</span> <span class="mf">34.584</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">25.956</span><span class="p">,</span> <span class="mf">24.355</span><span class="p">,</span> <span class="mf">34.121</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">25.681</span><span class="p">,</span> <span class="mf">25.505</span><span class="p">,</span> <span class="mf">35.079</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">25.488</span><span class="p">,</span> <span class="mf">26.639</span><span class="p">,</span> <span class="mf">34.648</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">24.703</span><span class="p">,</span> <span class="mf">23.49</span><span class="p">,</span> <span class="mf">34.038</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">25.662</span><span class="p">,</span> <span class="mf">25.208</span><span class="p">,</span> <span class="mf">36.38</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">25.411</span><span class="p">,</span> <span class="mf">26.214</span><span class="p">,</span> <span class="mf">37.393</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">26.424</span><span class="p">,</span> <span class="mf">27.344</span><span class="p">,</span> <span class="mf">37.27</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">26.055</span><span class="p">,</span> <span class="mf">28.516</span><span class="p">,</span> <span class="mf">37.29</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">25.519</span><span class="p">,</span> <span class="mf">25.624</span><span class="p">,</span> <span class="mf">38.794</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">27.704</span><span class="p">,</span> <span class="mf">26.987</span><span class="p">,</span> <span class="mf">37.142</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">28.764</span><span class="p">,</span> <span class="mf">27.968</span><span class="p">,</span> <span class="mf">37.016</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">28.497</span><span class="p">,</span> <span class="mf">28.876</span><span class="p">,</span> <span class="mf">35.825</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">28.602</span><span class="p">,</span> <span class="mf">30.096</span><span class="p">,</span> <span class="mf">35.937</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">30.115</span><span class="p">,</span> <span class="mf">27.292</span><span class="p">,</span> <span class="mf">36.812</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">28.151</span><span class="p">,</span> <span class="mf">28.278</span><span class="p">,</span> <span class="mf">34.682</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">27.871</span><span class="p">,</span> <span class="mf">29.032</span><span class="p">,</span> <span class="mf">33.478</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">27</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">26.759</span><span class="p">,</span> <span class="mf">30.04</span><span class="p">,</span> <span class="mf">33.737</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">26.876</span><span class="p">,</span> <span class="mf">31.205</span><span class="p">,</span> <span class="mf">33.367</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">27.429</span><span class="p">,</span> <span class="mf">28.113</span><span class="p">,</span> <span class="mf">32.344</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">25.678</span><span class="p">,</span> <span class="mf">29.586</span><span class="p">,</span> <span class="mf">34.376</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">24.552</span><span class="p">,</span> <span class="mf">30.444</span><span class="p">,</span> <span class="mf">34.682</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">25.013</span><span class="p">,</span> <span class="mf">31.637</span><span class="p">,</span> <span class="mf">35.507</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">24.652</span><span class="p">,</span> <span class="mf">32.773</span><span class="p">,</span> <span class="mf">35.212</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">23.489</span><span class="p">,</span> <span class="mf">29.693</span><span class="p">,</span> <span class="mf">35.478</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">25.814</span><span class="p">,</span> <span class="mf">31.374</span><span class="p">,</span> <span class="mf">36.543</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">26.321</span><span class="p">,</span> <span class="mf">32.423</span><span class="p">,</span> <span class="mf">37.405</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">37</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">27.081</span><span class="p">,</span> <span class="mf">33.454</span><span class="p">,</span> <span class="mf">36.583</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">38</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">26.874</span><span class="p">,</span> <span class="mf">34.654</span><span class="p">,</span> <span class="mf">36.745</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">39</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">27.193</span><span class="p">,</span> <span class="mf">31.773</span><span class="p">,</span> <span class="mf">38.487</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">27.963</span><span class="p">,</span> <span class="mf">32.98</span><span class="p">,</span> <span class="mf">35.7</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">28.75</span><span class="p">,</span> <span class="mf">33.859</span><span class="p">,</span> <span class="mf">34.858</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">27.834</span><span class="p">,</span> <span class="mf">34.759</span><span class="p">,</span> <span class="mf">34.042</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">43</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">28.052</span><span class="p">,</span> <span class="mf">35.967</span><span class="p">,</span> <span class="mf">33.969</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">29.621</span><span class="p">,</span> <span class="mf">33.061</span><span class="p">,</span> <span class="mf">33.894</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">26.807</span><span class="p">,</span> <span class="mf">34.168</span><span class="p">,</span> <span class="mf">33.427</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">25.864</span><span class="p">,</span> <span class="mf">34.915</span><span class="p">,</span> <span class="mf">32.62</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">47</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">25.23</span><span class="p">,</span> <span class="mf">36.024</span><span class="p">,</span> <span class="mf">33.448</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">25.146</span><span class="p">,</span> <span class="mf">37.165</span><span class="p">,</span> <span class="mf">33.001</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">24.752</span><span class="p">,</span> <span class="mf">34.012</span><span class="p">,</span> <span class="mf">32.097</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">24.783</span><span class="p">,</span> <span class="mf">35.683</span><span class="p">,</span> <span class="mf">34.66</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">51</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">24.16</span><span class="p">,</span> <span class="mf">36.646</span><span class="p">,</span> <span class="mf">35.544</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">25.104</span><span class="p">,</span> <span class="mf">37.812</span><span class="p">,</span> <span class="mf">35.797</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">53</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">24.699</span><span class="p">,</span> <span class="mf">38.97</span><span class="p">,</span> <span class="mf">35.714</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">54</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span> <span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">23.81</span><span class="p">,</span> <span class="mf">36.012</span><span class="p">,</span> <span class="mf">36.887</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">26.365</span><span class="p">,</span> <span class="mf">37.503</span><span class="p">,</span> <span class="mf">36.107</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">56</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">27.361</span><span class="p">,</span> <span class="mf">38.522</span><span class="p">,</span> <span class="mf">36.37</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">57</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">27.477</span><span class="p">,</span> <span class="mf">39.461</span><span class="p">,</span> <span class="mf">35.177</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">58</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">27.485</span><span class="p">,</span> <span class="mf">40.679</span><span class="p">,</span> <span class="mf">35.342</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">59</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">28.73</span><span class="p">,</span> <span class="mf">37.9</span><span class="p">,</span> <span class="mf">36.625</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">27.566</span><span class="p">,</span> <span class="mf">38.89</span><span class="p">,</span> <span class="mf">33.974</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">61</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">27.68</span><span class="p">,</span> <span class="mf">39.674</span><span class="p">,</span> <span class="mf">32.761</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">62</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">26.504</span><span class="p">,</span> <span class="mf">40.634</span><span class="p">,</span> <span class="mf">32.645</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">63</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">26.69</span><span class="p">,</span> <span class="mf">41.815</span><span class="p">,</span> <span class="mf">32.36</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">27.69</span><span class="p">,</span> <span class="mf">38.779</span><span class="p">,</span> <span class="mf">31.527</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">65</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">25.291</span><span class="p">,</span> <span class="mf">40.121</span><span class="p">,</span> <span class="mf">32.868</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">66</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">24.093</span><span class="p">,</span> <span class="mf">40.932</span><span class="p">,</span> <span class="mf">32.789</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">67</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">24.193</span><span class="p">,</span> <span class="mf">42.112</span><span class="p">,</span> <span class="mf">33.745</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">68</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">23.905</span><span class="p">,</span> <span class="mf">43.245</span><span class="p">,</span> <span class="mf">33.367</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">69</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">22.856</span><span class="p">,</span> <span class="mf">40.12</span><span class="p">,</span> <span class="mf">33.158</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">24.604</span><span class="p">,</span> <span class="mf">41.841</span><span class="p">,</span> <span class="mf">34.986</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;N&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">71</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="s1">&#39;CA&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">24.742</span><span class="p">,</span> <span class="mf">42.878</span><span class="p">,</span> <span class="mf">35.989</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">72</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">25.691</span><span class="p">,</span> <span class="mf">43.96</span><span class="p">,</span> <span class="mf">35.497</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">73</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">25.39</span><span class="p">,</span> <span class="mf">45.147</span><span class="p">,</span> <span class="mf">35.602</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;O&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">(</span><span class="mi">74</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="s1">&#39;CB&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="mf">24.418</span><span class="p">,</span> <span class="mf">41.969</span><span class="p">,</span> <span class="mf">34.808</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)])</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Caution. After the first time this helix is created as a Structure, the alpha_helix_15_atoms Atom instances will have 
their .coords set to the alpha_helix_15 'parent' Structure instance. Transformation of this Structure causes the 
starting coordinates in each Atom instance in alpha_helix_15_atoms to be transformed as well. Making new structures 
from this Atoms container is sufficient to detach them, but the coordinates are moved from program start after usage the
first time. This behavior isn't ideal, but a consequence of construction of Atom instances from the singular 
attribute basis with the intention to be reused</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="structure.base.ArrayIndexer" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">ArrayIndexer</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ArrayIndexer</span> <span class="o">=</span> <span class="n"><span title="typing.Type">Type</span></span><span class="p">[</span><span class="n"><span title="typing.Union">Union</span></span><span class="p">[</span><span class="n"><span title="collections.abc.Sequence">Sequence</span></span><span class="p">[</span><span class="n">int</span><span class="p">],</span> <span class="n"><span title="collections.abc.Sequence">Sequence</span></span><span class="p">[</span><span class="n">bool</span><span class="p">],</span> <span class="n">slice</span><span class="p">,</span> <span class="kc">None</span><span class="p">]]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Where integers, slices <code>:</code>, ellipsis <code>...</code>, None and integer or boolean arrays are valid indices</p>
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="structure.base.Log" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Log</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">Log</span><span class="p">(</span><span class="n">log</span><span class="p">:</span> <span class="n"><span title="logging.Logger">Logger</span></span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;null&#39;</span><span class="p">))</span>
</code></pre></div>

  <div class="doc doc-contents ">

  
      <p>Responsible for StructureBase logging operations</p>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>log</code></b>
            (<code><span title="logging.Logger">Logger</span> | None</code>, default:
                <code><span title="logging.getLogger">getLogger</span>(&#39;null&#39;)</code>
)
        
        <div class="doc-md-description">
          <p>The logging.Logger to handle StructureBase logging. If None is passed a Logger with NullHandler is used</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>symdesign/structure/base.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">log</span><span class="p">:</span> <span class="n">Logger</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s1">&#39;null&#39;</span><span class="p">)):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the instance</span>

<span class="sd">    Args:</span>
<span class="sd">        log: The logging.Logger to handle StructureBase logging. If None is passed a Logger with NullHandler is used</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span> <span class="o">=</span> <span class="n">log</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="structure.base.SymmetryBase" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">SymmetryBase</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">SymmetryBase</span><span class="p">(</span><span class="n">rotation_matrices</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">translation_matrices</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="abc.ABC">ABC</span></code></p>

  
      <p>Adds functionality for symmetric manipulation of Structure instances</p>
<p>Collects known keyword arguments for all derived classes to protect <code>object</code>. Should always be the last class
in the method resolution order of derived classes.</p>

                <details class="quote">
                  <summary>Source code in <code>symdesign/structure/base.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rotation_matrices</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">translation_matrices</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_symmetry</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_symmetric_dependents</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># SymmetryBase</span>
    <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The argument(s) passed to the </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> instance weren&#39;t recognized and aren&#39;t &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;accepted by the object class: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">It&#39;s likely that your class MRO is &quot;</span>
            <span class="s2">&quot;insufficient for your passed arguments or you have passed invalid arguments&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="structure.base.SymmetryBase.symmetry" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">symmetry</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">symmetry</span><span class="p">:</span> <span class="n">str</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The symmetry of the Structure described by its Schnflies notation</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.SymmetryBase.symmetric_dependents" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">symmetric_dependents</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">symmetric_dependents</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.StructureBase" href="#structure.base.StructureBase">StructureBase</a></span><span class="p">]</span> <span class="o">|</span> <span class="n">list</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Access the symmetrically dependent Structure instances</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="structure.base.SymmetryBase.reset_symmetry_state" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">reset_symmetry_state</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">reset_symmetry_state</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Remove any state variable associated with the instance</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reset_symmetry_state</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove any state variable associated with the instance&quot;&quot;&quot;</span>
    <span class="c1"># self.log.debug(f&quot;Removing symmetric attributes from {repr(self)}&quot;)</span>
    <span class="k">for</span> <span class="n">attribute</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">symmetry_state_attributes</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attribute</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">continue</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.SymmetryBase.is_symmetric" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">is_symmetric</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">is_symmetric</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Query whether the Structure is symmetric. Returns True if self.symmetry is not None</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_symmetric</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Query whether the Structure is symmetric. Returns True if self.symmetry is not None&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_symmetry</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.SymmetryBase.has_symmetric_dependents" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">has_symmetric_dependents</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">has_symmetric_dependents</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Evaluates to True if the Structure has symmetrically dependent children</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">has_symmetric_dependents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Evaluates to True if the Structure has symmetrically dependent children&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="kc">True</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_symmetric_dependents</span> <span class="k">else</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="structure.base.StructureMetadata" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">StructureMetadata</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">StructureMetadata</span><span class="p">(</span><span class="n">biological_assembly</span><span class="p">:</span> <span class="n">str</span> <span class="o">|</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cryst_record</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_info</span><span class="p">:</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n">dict</span><span class="p">[</span><span class="n">dict</span> <span class="o">|</span> <span class="n">list</span> <span class="o">|</span> <span class="n">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="n"><span title="typing.AnyStr">AnyStr</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">reference_sequence</span><span class="p">:</span> <span class="n">str</span> <span class="o">|</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">

  
      <p>Contains all metadata available from structure file parsing</p>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>biological_assembly</code></b>
            (<code>str | int</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The integer of the biological assembly (as indicated by PDB AssemblyID format)</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>cryst_record</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The string specifying how the molecule is situated in a lattice</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>entity_info</code></b>
            (<code>dict[str, dict[dict | list | str]]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>A mapping of the metadata to their distinct molecular identifiers</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>file_path</code></b>
            (<code><span title="typing.AnyStr">AnyStr</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The location on disk where the file was accessed</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>reference_sequence</code></b>
            (<code>str | dict[str, str]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The reference sequence (according to expression sequence or reference database)</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>resolution</code></b>
            (<code>float</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The level of detail available from an experimental dataset contributing to the sharpness with
which structural data can contribute towards building a model</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>symdesign/structure/base.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">871</span>
<span class="normal">872</span>
<span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span>
<span class="normal">886</span>
<span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span>
<span class="normal">892</span>
<span class="normal">893</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">biological_assembly</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cryst_record</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">entity_info</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">dict</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="n">AnyStr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">reference_sequence</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">resolution</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the instance</span>

<span class="sd">    Args:</span>
<span class="sd">        biological_assembly: The integer of the biological assembly (as indicated by PDB AssemblyID format)</span>
<span class="sd">        cryst_record: The string specifying how the molecule is situated in a lattice</span>
<span class="sd">        entity_info: A mapping of the metadata to their distinct molecular identifiers</span>
<span class="sd">        file_path: The location on disk where the file was accessed</span>
<span class="sd">        reference_sequence: The reference sequence (according to expression sequence or reference database)</span>
<span class="sd">        resolution: The level of detail available from an experimental dataset contributing to the sharpness with</span>
<span class="sd">            which structural data can contribute towards building a model</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">biological_assembly</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">biological_assembly</span> <span class="o">=</span> <span class="n">biological_assembly</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">biological_assembly</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">biological_assembly</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cryst_record</span> <span class="o">=</span> <span class="n">cryst_record</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">entity_info</span> <span class="o">=</span> <span class="n">entity_info</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">file_path</span> <span class="o">=</span> <span class="n">file_path</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reference_sequence</span> <span class="o">=</span> <span class="n">reference_sequence</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="n">resolution</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">











  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="structure.base.CoordinateOpsMixin" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">CoordinateOpsMixin</span>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="abc.ABC">ABC</span></code></p>



  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="structure.base.CoordinateOpsMixin.coords" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">coords</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">coords</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="structure.base.CoordinateOpsMixin.distance_from_reference" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">distance_from_reference</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">distance_from_reference</span><span class="p">(</span><span class="n">reference</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">symmetry</span><span class="o">.</span><span class="n">origin</span><span class="p">,</span> <span class="n">measure</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>From a Structure, find the furthest coordinate from the origin (default) or from a reference.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>reference</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>, default:
                <code><span title="symdesign.utils.symmetry.origin">origin</span></code>
)
        
        <div class="doc-md-description">
          <p>The reference where the point should be measured from. Default is origin</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>measure</code></b>
            (<code>str</code>, default:
                <code>&#39;mean&#39;</code>
)
        
        <div class="doc-md-description">
          <p>The measurement to take with respect to the reference. Could be 'mean', 'min', 'max', or any
numpy function to describe computed distance scalars</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>float</code>
        
        <div class="doc-md-description">
          <p>The distance from the reference point to the furthest point</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">distance_from_reference</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">reference</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">symmetry</span><span class="o">.</span><span class="n">origin</span><span class="p">,</span> <span class="n">measure</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;From a Structure, find the furthest coordinate from the origin (default) or from a reference.</span>

<span class="sd">    Args:</span>
<span class="sd">        reference: The reference where the point should be measured from. Default is origin</span>
<span class="sd">        measure: The measurement to take with respect to the reference. Could be &#39;mean&#39;, &#39;min&#39;, &#39;max&#39;, or any</span>
<span class="sd">            numpy function to describe computed distance scalars</span>

<span class="sd">    Returns:</span>
<span class="sd">        The distance from the reference point to the furthest point</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">reference</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">reference</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">symmetry</span><span class="o">.</span><span class="n">origin</span>

    <span class="k">return</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">np</span><span class="p">,</span> <span class="n">measure</span><span class="p">)(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">-</span> <span class="n">reference</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.CoordinateOpsMixin.translate" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">translate</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">translate</span><span class="p">(</span><span class="n">translation</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Perform a translation to the Structure ensuring only the Structure container of interest is translated
ensuring the underlying coords are not modified</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>translation</code></b>
            (<code>list[float] | <span title="numpy.ndarray">ndarray</span></code>)
        
        <div class="doc-md-description">
          <p>The first translation to apply, expected array shape (3,)</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span>
<span class="normal">942</span>
<span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">translate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">translation</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform a translation to the Structure ensuring only the Structure container of interest is translated</span>
<span class="sd">    ensuring the underlying coords are not modified</span>

<span class="sd">    Args:</span>
<span class="sd">        translation: The first translation to apply, expected array shape (3,)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_transforming</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">+=</span> <span class="n">translation</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_transforming</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.CoordinateOpsMixin.rotate" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">rotate</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">rotate</span><span class="p">(</span><span class="n">rotation</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]]</span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Perform a rotation to the Structure ensuring only the Structure container of interest is rotated ensuring the
underlying coords are not modified</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>rotation</code></b>
            (<code>list[list[float]] | <span title="numpy.ndarray">ndarray</span></code>)
        
        <div class="doc-md-description">
          <p>The first rotation to apply, expected array shape (3, 3)</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span>
<span class="normal">954</span>
<span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rotation</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform a rotation to the Structure ensuring only the Structure container of interest is rotated ensuring the</span>
<span class="sd">    underlying coords are not modified</span>

<span class="sd">    Args:</span>
<span class="sd">        rotation: The first rotation to apply, expected array shape (3, 3)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_transforming</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">rotation</span><span class="p">))</span>  <span class="c1"># Allows a list to be passed</span>
    <span class="c1"># self.coords = np.matmul(self.coords, rotation.swapaxes(-2, -1))  # Essentially a transpose</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_transforming</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.CoordinateOpsMixin.transform" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">transform</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">transform</span><span class="p">(</span><span class="n">rotation</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]]</span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">translation</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rotation2</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]]</span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">translation2</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Perform a specific transformation to the Structure ensuring only the Structure container of interest is
transformed ensuring the underlying coords are not modified</p>
<p>Transformation proceeds by matrix multiplication and vector addition with the order of operations as:
rotation, translation, rotation2, translation2</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>rotation</code></b>
            (<code>list[list[float]] | <span title="numpy.ndarray">ndarray</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The first rotation to apply, expected array shape (3, 3)</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>translation</code></b>
            (<code>list[float] | <span title="numpy.ndarray">ndarray</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The first translation to apply, expected array shape (3,)</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>rotation2</code></b>
            (<code>list[list[float]] | <span title="numpy.ndarray">ndarray</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The second rotation to apply, expected array shape (3, 3)</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>translation2</code></b>
            (<code>list[float] | <span title="numpy.ndarray">ndarray</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The second translation to apply, expected array shape (3,)</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span>
<span class="normal">966</span>
<span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span>
<span class="normal">986</span>
<span class="normal">987</span>
<span class="normal">988</span>
<span class="normal">989</span>
<span class="normal">990</span>
<span class="normal">991</span>
<span class="normal">992</span>
<span class="normal">993</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">transform</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">rotation</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">translation</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">rotation2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">translation2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform a specific transformation to the Structure ensuring only the Structure container of interest is</span>
<span class="sd">    transformed ensuring the underlying coords are not modified</span>

<span class="sd">    Transformation proceeds by matrix multiplication and vector addition with the order of operations as:</span>
<span class="sd">    rotation, translation, rotation2, translation2</span>

<span class="sd">    Args:</span>
<span class="sd">        rotation: The first rotation to apply, expected array shape (3, 3)</span>
<span class="sd">        translation: The first translation to apply, expected array shape (3,)</span>
<span class="sd">        rotation2: The second rotation to apply, expected array shape (3, 3)</span>
<span class="sd">        translation2: The second translation to apply, expected array shape (3,)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">rotation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Required for np.ndarray or None checks</span>
        <span class="n">new_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">rotation</span><span class="p">))</span>  <span class="c1"># Allows list to be passed...</span>
        <span class="c1"># new_coords = np.matmul(self.coords, rotation.swapaxes(-2, -1))  # Essentially a transpose</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span>  <span class="c1"># No need to copy as this is a view</span>

    <span class="k">if</span> <span class="n">translation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Required for np.ndarray or None checks</span>
        <span class="n">new_coords</span> <span class="o">+=</span> <span class="n">translation</span>

    <span class="k">if</span> <span class="n">rotation2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Required for np.ndarray or None checks</span>
        <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">new_coords</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">rotation2</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">new_coords</span><span class="p">)</span>  <span class="c1"># Allows list to be passed...</span>
        <span class="c1"># np.matmul(new_coords, rotation2.swapaxes(-2, -1), out=new_coords)  # Essentially a transpose</span>

    <span class="k">if</span> <span class="n">translation2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Required for np.ndarray or None checks</span>
        <span class="n">new_coords</span> <span class="o">+=</span> <span class="n">translation2</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_transforming</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">new_coords</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_transforming</span> <span class="o">=</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.CoordinateOpsMixin.copy" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">copy</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">copy</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">995</span>
<span class="normal">996</span>
<span class="normal">997</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.CoordinateOpsMixin.get_transformed_copy" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_transformed_copy</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_transformed_copy</span><span class="p">(</span><span class="n">rotation</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]]</span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">translation</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rotation2</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]]</span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">translation2</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.StructureBase" href="#structure.base.StructureBase">StructureBase</a></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Make a semi-deep copy of the Structure object with the coordinates transformed in cartesian space</p>
<p>Transformation proceeds by matrix multiplication and vector addition with the order of operations as:
rotation, translation, rotation2, translation2</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>rotation</code></b>
            (<code>list[list[float]] | <span title="numpy.ndarray">ndarray</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The first rotation to apply, expected array shape (3, 3)</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>translation</code></b>
            (<code>list[float] | <span title="numpy.ndarray">ndarray</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The first translation to apply, expected array shape (3,)</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>rotation2</code></b>
            (<code>list[list[float]] | <span title="numpy.ndarray">ndarray</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The second rotation to apply, expected array shape (3, 3)</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>translation2</code></b>
            (<code>list[float] | <span title="numpy.ndarray">ndarray</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The second translation to apply, expected array shape (3,)</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="structure.base.StructureBase" href="#structure.base.StructureBase">StructureBase</a></code>
        
        <div class="doc-md-description">
          <p>A transformed copy of the original object</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_transformed_copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">rotation</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">translation</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">rotation2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">translation2</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">StructureBase</span><span class="p">:</span>  <span class="c1"># Todo -&gt; Self in python 3.11</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Make a semi-deep copy of the Structure object with the coordinates transformed in cartesian space</span>

<span class="sd">    Transformation proceeds by matrix multiplication and vector addition with the order of operations as:</span>
<span class="sd">    rotation, translation, rotation2, translation2</span>

<span class="sd">    Args:</span>
<span class="sd">        rotation: The first rotation to apply, expected array shape (3, 3)</span>
<span class="sd">        translation: The first translation to apply, expected array shape (3,)</span>
<span class="sd">        rotation2: The second rotation to apply, expected array shape (3, 3)</span>
<span class="sd">        translation2: The second translation to apply, expected array shape (3,)</span>

<span class="sd">    Returns:</span>
<span class="sd">        A transformed copy of the original object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">rotation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Required for np.ndarray or None checks</span>
        <span class="n">new_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">rotation</span><span class="p">))</span>  <span class="c1"># Allows list to be passed...</span>
        <span class="c1"># new_coords = np.matmul(self.coords, rotation.swapaxes(-2, -1))  # Essentially a transpose</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">new_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span>  <span class="c1"># No need to copy as this is a view</span>

    <span class="k">if</span> <span class="n">translation</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Required for np.ndarray or None checks</span>
        <span class="n">new_coords</span> <span class="o">+=</span> <span class="n">translation</span>

    <span class="k">if</span> <span class="n">rotation2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Required for np.ndarray or None checks</span>
        <span class="n">np</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">new_coords</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">rotation2</span><span class="p">),</span> <span class="n">out</span><span class="o">=</span><span class="n">new_coords</span><span class="p">)</span>  <span class="c1"># Allows list to be passed...</span>
        <span class="c1"># np.matmul(new_coords, rotation2.swapaxes(-2, -1), out=new_coords)  # Essentially a transpose</span>

    <span class="k">if</span> <span class="n">translation2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Required for np.ndarray or None checks</span>
        <span class="n">new_coords</span> <span class="o">+=</span> <span class="n">translation2</span>

    <span class="n">new_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">new_structure</span><span class="o">.</span><span class="n">_transforming</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">new_structure</span><span class="o">.</span><span class="n">coords</span> <span class="o">=</span> <span class="n">new_coords</span>
    <span class="n">new_structure</span><span class="o">.</span><span class="n">_transforming</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="n">new_structure</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="structure.base.StructureBase" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">StructureBase</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">StructureBase</span><span class="p">(</span><span class="n">parent</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.StructureBase" href="#structure.base.StructureBase">StructureBase</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">log</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Log" href="#structure.base.Log">Log</a></span> <span class="o">|</span> <span class="n"><span title="logging.Logger">Logger</span></span> <span class="o">|</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">coords</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.coordinates.Coordinates" href="../coordinates/#structure.coordinates.Coordinates">Coordinates</a></span> <span class="o">|</span> <span class="n">list</span><span class="p">[</span><span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="n"><span title="typing.AnyStr">AnyStr</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">biological_assembly</span><span class="p">:</span> <span class="n">str</span> <span class="o">|</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cryst_record</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">resolution</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">entity_info</span><span class="p">:</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n">dict</span><span class="p">[</span><span class="n">dict</span> <span class="o">|</span> <span class="n">list</span> <span class="o">|</span> <span class="n">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">reference_sequence</span><span class="p">:</span> <span class="n">str</span> <span class="o">|</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="structure.base.SymmetryBase" href="#structure.base.SymmetryBase">SymmetryBase</a></code>, <code><a class="autorefs autorefs-internal" title="structure.base.CoordinateOpsMixin" href="#structure.base.CoordinateOpsMixin">CoordinateOpsMixin</a></code>, <code><span title="abc.ABC">ABC</span></code></p>

  
      <p>Manipulates Coordinates and Log instances as well as the .atom_indices.</p>
<p>Additionally. sorts through parent Structure and dependent Structure hierarchies during Structure subclass creation.</p>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>parent</code></b>
            (<code><a class="autorefs autorefs-internal" title="structure.base.StructureBase" href="#structure.base.StructureBase">StructureBase</a></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>If another Structure object created this Structure instance, pass the 'parent' instance. Will take
ownership over Structure containers (coords, atoms, residues) for dependent Structures</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>log</code></b>
            (<code><a class="autorefs autorefs-internal" title="structure.base.Log" href="#structure.base.Log">Log</a> | <span title="logging.Logger">Logger</span> | bool</code>, default:
                <code>True</code>
)
        
        <div class="doc-md-description">
          <p>The Log or Logger instance, or the name for the logger to handle parent Structure logging.
None or False prevents logging while any True assignment enables it</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>coords</code></b>
            (<code><span title="numpy.ndarray">ndarray</span> | <a class="autorefs autorefs-internal" title="structure.coordinates.Coordinates" href="../coordinates/#structure.coordinates.Coordinates">Coordinates</a> | list[list[float]]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>When setting up a parent Structure instance, the coordinates of that Structure</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>name</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The identifier for the Structure instance</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>symdesign/structure/base.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">StructureBase</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">log</span><span class="p">:</span> <span class="n">Log</span> <span class="o">|</span> <span class="n">Logger</span> <span class="o">|</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
             <span class="n">coords</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">|</span> <span class="n">Coordinates</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="c1"># metadata: StructureMetadata = None,</span>
             <span class="n">file_path</span><span class="p">:</span> <span class="n">AnyStr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">biological_assembly</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">cryst_record</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">resolution</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">entity_info</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">dict</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">reference_sequence</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="c1"># entity_info=None,</span>
             <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="c1"># These shouldn&#39;t be passed as they should be stripped by prior constructors...</span>
    <span class="c1"># entity_names=None, rotation_matrices=None, translation_matrices=None,</span>
    <span class="c1"># metadata=None, pose_format=None, query_by_sequence=True, rename_chains=None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the instance</span>

<span class="sd">    Args:</span>
<span class="sd">        parent: If another Structure object created this Structure instance, pass the &#39;parent&#39; instance. Will take</span>
<span class="sd">            ownership over Structure containers (coords, atoms, residues) for dependent Structures</span>
<span class="sd">        log: The Log or Logger instance, or the name for the logger to handle parent Structure logging.</span>
<span class="sd">            None or False prevents logging while any True assignment enables it</span>
<span class="sd">        coords: When setting up a parent Structure instance, the coordinates of that Structure</span>
<span class="sd">        name: The identifier for the Structure instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="kc">False</span><span class="p">]</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;Unnamed_</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">if</span> <span class="n">parent</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Initialize StructureBase from parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="n">parent</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># This is the parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parent_</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metadata</span> <span class="o">=</span> <span class="n">StructureMetadata</span><span class="p">(</span>
            <span class="n">biological_assembly</span><span class="o">=</span><span class="n">biological_assembly</span><span class="p">,</span> <span class="n">cryst_record</span><span class="o">=</span><span class="n">cryst_record</span><span class="p">,</span> <span class="n">entity_info</span><span class="o">=</span><span class="n">entity_info</span><span class="p">,</span>
            <span class="n">file_path</span><span class="o">=</span><span class="n">file_path</span><span class="p">,</span> <span class="n">reference_sequence</span><span class="o">=</span><span class="n">reference_sequence</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span>
        <span class="p">)</span>
        <span class="c1"># Initialize Log</span>
        <span class="k">if</span> <span class="n">log</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">log</span><span class="p">,</span> <span class="n">Log</span><span class="p">):</span>  <span class="c1"># Initialized Log</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span> <span class="o">=</span> <span class="n">log</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">log</span><span class="p">,</span> <span class="n">Logger</span><span class="p">):</span>  <span class="c1"># logging.Logger object</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span> <span class="o">=</span> <span class="n">Log</span><span class="p">(</span><span class="n">log</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">log</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span> <span class="o">=</span> <span class="n">Log</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">start_log</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">level</span><span class="o">=</span><span class="n">log</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># log is True or some other type:  # Use the module logger</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_log</span> <span class="o">=</span> <span class="n">Log</span><span class="p">(</span><span class="n">logger</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># When explicitly passed as None or False, uses the null logger</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log</span> <span class="o">=</span> <span class="n">null_struct_log</span>  <span class="c1"># Log()</span>

        <span class="c1"># Initialize Coordinates</span>
        <span class="k">if</span> <span class="n">coords</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Check this first</span>
            <span class="c1"># Most init occurs from Atom instances that are their own parent until another StructureBase adopts them</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_coords</span> <span class="o">=</span> <span class="n">Coordinates</span><span class="p">()</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">Coordinates</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_coords</span> <span class="o">=</span> <span class="n">coords</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Create a Coordinates instance. This assumes the dimensions are correct. Coordinates() handles if not</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_coords</span> <span class="o">=</span> <span class="n">Coordinates</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>

    <span class="c1"># try:</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># StructureBase</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="structure.base.StructureBase.parent" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">parent</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">parent</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.StructureBase" href="#structure.base.StructureBase">StructureBase</a></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the instance's 'parent' StructureBase which is responsible for manipulation of Structure containers</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.StructureBase.log" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">log</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">log</span><span class="p">:</span> <span class="n"><span title="logging.Logger">Logger</span></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The StructureBase Logger</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.StructureBase.coords" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">coords</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">coords</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The coordinates for the Atoms in the StructureBase object</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="structure.base.StructureBase.is_dependent" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">is_dependent</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">is_dependent</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Is this instance a dependent on a parent StructureBase?</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_dependent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Is this instance a dependent on a parent StructureBase?&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.StructureBase.is_parent" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">is_parent</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">is_parent</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Is this instance a parent?</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Is this instance a parent?&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parent_</span> <span class="ow">is</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.StructureBase.make_parent" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make_parent</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">make_parent</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Remove this instance from its parent, making it a parent in the process</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">make_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove this instance from its parent, making it a parent in the process&quot;&quot;&quot;</span>
    <span class="c1"># Set parent explicitly as None</span>
    <span class="bp">self</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="n">_parent_variable</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="c1"># Create a new, Coords instance detached from the parent</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_coords</span> <span class="o">=</span> <span class="n">Coordinates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.StructureBase.reset_state" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">reset_state</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">reset_state</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Removes attributes that are valid for the current state. Additionally, resets the symmetry state if symmetric</p>
<p>This is useful for transfer of ownership, or changes in the state that should be overwritten</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reset_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Removes attributes that are valid for the current state. Additionally, resets the symmetry state if symmetric</span>

<span class="sd">    This is useful for transfer of ownership, or changes in the state that should be overwritten</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># self.log.debug(f&#39;Resetting {repr(self)} state_attributes&#39;)</span>
    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_attributes</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="fm">__delattr__</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">continue</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">reset_symmetry_state</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="structure.base.Atom" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Atom</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">Atom</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">atom_type</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">alt_location</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">residue_type</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">residue_number</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">code_for_insertion</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">occupancy</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">b_factor</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">charge</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">coords</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="structure.base.CoordinateOpsMixin" href="#structure.base.CoordinateOpsMixin">CoordinateOpsMixin</a></code></p>

  
      <p>Contains Atom metadata and a single coordinate position</p>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>index</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The zero-indexed number to describe this Atom instance's position in a StructureBaseContainer</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>number</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The integer number describing this Atom instances position in comparison to others instances</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>atom_type</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The characters describing the classification of atom via membership to a molecule</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>alt_location</code></b>
            (<code>str</code>, default:
                <code>&#39; &#39;</code>
)
        
        <div class="doc-md-description">
          <p>Whether the observation of the Atom has alternative evidences</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>residue_type</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The characters describing the molecular unit to which this Atom belongs</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>chain_id</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The identifier which signifies this Atom instances membership to a larger polymer</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>residue_number</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The integer of the polymer that this Atom belongs too</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>code_for_insertion</code></b>
            (<code>str</code>, default:
                <code>&#39; &#39;</code>
)
        
        <div class="doc-md-description">
          <p>Whether the Atom is included in a residue which is inserted according to a common
numbering scheme</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>x</code></b>
            (<code>float</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The x axis value of the instances coordinate position, i.e., it's x coordinate</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>y</code></b>
            (<code>float</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The y axis value of the instances coordinate position, i.e., it's y coordinate</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>z</code></b>
            (<code>float</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The z axis value of the instances coordinate position, i.e., it's z coordinate</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>occupancy</code></b>
            (<code>float</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The fraction of the time this Atom is observed in the experiment</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>b_factor</code></b>
            (<code>float</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The thermal fluctuation for the Atom OR a value for which structural representation should account</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>element</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The atomic symbol for the Atom</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>charge</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The numeric value for the electronic charge of the Atom</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>coords</code></b>
            (<code>list[float]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The set of values of the x, y, and z coordinate position</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>**kwargs</code></b>
        
        <div class="doc-md-description">
          
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>symdesign/structure/base.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">atom_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">alt_location</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span>
             <span class="n">residue_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">residue_number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">code_for_insertion</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">z</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">occupancy</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">b_factor</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">element</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">charge</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the instance</span>

<span class="sd">    Args:</span>
<span class="sd">        index: The zero-indexed number to describe this Atom instance&#39;s position in a StructureBaseContainer</span>
<span class="sd">        number: The integer number describing this Atom instances position in comparison to others instances</span>
<span class="sd">        atom_type: The characters describing the classification of atom via membership to a molecule</span>
<span class="sd">        alt_location: Whether the observation of the Atom has alternative evidences</span>
<span class="sd">        residue_type: The characters describing the molecular unit to which this Atom belongs</span>
<span class="sd">        chain_id: The identifier which signifies this Atom instances membership to a larger polymer</span>
<span class="sd">        residue_number: The integer of the polymer that this Atom belongs too</span>
<span class="sd">        code_for_insertion: Whether the Atom is included in a residue which is inserted according to a common</span>
<span class="sd">            numbering scheme</span>
<span class="sd">        x: The x axis value of the instances coordinate position, i.e., it&#39;s x coordinate</span>
<span class="sd">        y: The y axis value of the instances coordinate position, i.e., it&#39;s y coordinate</span>
<span class="sd">        z: The z axis value of the instances coordinate position, i.e., it&#39;s z coordinate</span>
<span class="sd">        occupancy: The fraction of the time this Atom is observed in the experiment</span>
<span class="sd">        b_factor: The thermal fluctuation for the Atom OR a value for which structural representation should account</span>
<span class="sd">        element: The atomic symbol for the Atom</span>
<span class="sd">        charge: The numeric value for the electronic charge of the Atom</span>
<span class="sd">        coords: The set of values of the x, y, and z coordinate position</span>
<span class="sd">        **kwargs:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># super().__init__(**kwargs)  # Atom</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
    <span class="c1"># self._atom_indices = [index]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">number</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">=</span> <span class="n">atom_type</span>
    <span class="c1"># Comply with special .pdb formatting syntax by padding type with a space if len(atom_type) == 4</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_type_str</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="s2">&quot;&quot;</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">atom_type</span><span class="p">[</span><span class="mi">3</span><span class="p">:]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="s2">&quot; &quot;</span><span class="si">}{</span><span class="n">atom_type</span><span class="si">:</span><span class="s1">&lt;3s</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">alt_location</span> <span class="o">=</span> <span class="n">alt_location</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">residue_type</span> <span class="o">=</span> <span class="n">residue_type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">=</span> <span class="n">chain_id</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span> <span class="o">=</span> <span class="n">residue_number</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">code_for_insertion</span> <span class="o">=</span> <span class="n">code_for_insertion</span>
    <span class="k">if</span> <span class="n">coords</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coords_</span> <span class="o">=</span> <span class="n">coords</span>
    <span class="k">elif</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">z</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coords_</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_coords_</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">occupancy</span> <span class="o">=</span> <span class="n">occupancy</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">b_factor</span> <span class="o">=</span> <span class="n">b_factor</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">element</span> <span class="o">=</span> <span class="n">element</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">charge</span> <span class="o">=</span> <span class="n">charge</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sasa</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Atom.type" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">type</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nb">type</span><span class="p">:</span> <span class="n">str</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>This can't currently be set</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Atom.atom_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">atom_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">atom_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The index of the Atom in the Atoms/Coords container</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Atom.coords" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">coords</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">coords</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The coordinates for the Atom. Array is 1 dimensional in contrast to other .coords properties</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Atom.center_of_mass" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">center_of_mass</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">center_of_mass</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The center of mass (the Atom coordinates). Provided for compatibility with StructureBase API</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Atom.radius" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">radius</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">radius</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The width of the Atom</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Atom.x" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">x</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">x</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Access the value for the x coordinate</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Atom.y" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">y</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">y</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Access the value for the y coordinate</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Atom.z" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">z</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">z</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Access the value for the z coordinate</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="structure.base.Atom.without_coordinates" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">without_coordinates</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">without_coordinates</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">atom_type</span><span class="p">,</span> <span class="n">alt_location</span><span class="p">,</span> <span class="n">residue_type</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">,</span> <span class="n">residue_number</span><span class="p">,</span> <span class="n">code_for_insertion</span><span class="p">,</span> <span class="n">occupancy</span><span class="p">,</span> <span class="n">b_factor</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">charge</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Initialize Atom record data without coordinates. Performs all type casting</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">without_coordinates</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">number</span><span class="p">,</span> <span class="n">atom_type</span><span class="p">,</span> <span class="n">alt_location</span><span class="p">,</span> <span class="n">residue_type</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">,</span> <span class="n">residue_number</span><span class="p">,</span>
                        <span class="n">code_for_insertion</span><span class="p">,</span> <span class="n">occupancy</span><span class="p">,</span> <span class="n">b_factor</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">charge</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize Atom record data without coordinates. Performs all type casting&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="n">idx</span><span class="p">,</span> <span class="n">number</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">number</span><span class="p">),</span> <span class="n">atom_type</span><span class="o">=</span><span class="n">atom_type</span><span class="p">,</span> <span class="n">alt_location</span><span class="o">=</span><span class="n">alt_location</span><span class="p">,</span>
               <span class="n">residue_type</span><span class="o">=</span><span class="n">residue_type</span><span class="p">,</span> <span class="n">chain_id</span><span class="o">=</span><span class="n">chain_id</span><span class="p">,</span> <span class="n">residue_number</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">residue_number</span><span class="p">),</span>
               <span class="n">code_for_insertion</span><span class="o">=</span><span class="n">code_for_insertion</span><span class="p">,</span> <span class="n">occupancy</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">occupancy</span><span class="p">),</span> <span class="n">b_factor</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">b_factor</span><span class="p">),</span>
               <span class="n">element</span><span class="o">=</span><span class="n">element</span><span class="p">,</span> <span class="n">charge</span><span class="o">=</span><span class="n">charge</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="p">[])</span>  <span class="c1"># Use a list for speed</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Atom.is_dependent" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">is_dependent</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">is_dependent</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Is this instance a dependent on a parent StructureBase?</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_dependent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Is this instance a dependent on a parent StructureBase?&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="kc">True</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Atom.is_parent" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">is_parent</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">is_parent</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Is this instance a parent?</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Is this instance a parent?&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Atom.make_parent" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make_parent</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">make_parent</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Remove this instance from its parent, making it a parent in the process</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">make_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove this instance from its parent, making it a parent in the process&quot;&quot;&quot;</span>
    <span class="c1"># super().make_parent()  # When subclassing StructureBase</span>
    <span class="c1"># Create a new, Coords instance detached from the parent</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_coords</span> <span class="o">=</span> <span class="n">Coordinates</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Atom.reset_state" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">reset_state</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">reset_state</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Remove attributes that are valid for the current state</p>
<p>This is useful for transfer of ownership, or changes in the state that should be overwritten</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reset_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove attributes that are valid for the current state</span>

<span class="sd">    This is useful for transfer of ownership, or changes in the state that should be overwritten</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_attributes</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="fm">__delattr__</span><span class="p">(</span><span class="n">attr</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">continue</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Atom.is_backbone_and_cb" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">is_backbone_and_cb</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">is_backbone_and_cb</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Is the Atom is a backbone or CB Atom? Includes N, CA, C, O, and CB</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_backbone_and_cb</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Is the Atom is a backbone or CB Atom? Includes N, CA, C, O, and CB&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">in</span> <span class="n">protein_backbone_and_cb_atom_types</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Atom.is_backbone" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">is_backbone</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">is_backbone</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Is the Atom is a backbone Atom? These include N, CA, C, and O</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_backbone</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Is the Atom is a backbone Atom? These include N, CA, C, and O&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="ow">in</span> <span class="n">protein_backbone_atom_types</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Atom.is_cb" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">is_cb</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">is_cb</span><span class="p">(</span><span class="n">gly_ca</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Is the Atom a CB atom? Default returns True if Glycine and Atom is CA</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>gly_ca</code></b>
            (<code>bool</code>, default:
                <code>True</code>
)
        
        <div class="doc-md-description">
          <p>Whether to include Glycine CA in the boolean evaluation</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_cb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gly_ca</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Is the Atom a CB atom? Default returns True if Glycine and Atom is CA</span>

<span class="sd">    Args:</span>
<span class="sd">        gly_ca: Whether to include Glycine CA in the boolean evaluation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">gly_ca</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;CB&#39;</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residue_type</span> <span class="o">==</span> <span class="s1">&#39;GLY&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;CA&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1">#                                         When Rosetta assigns, it is this   v, but PDB assigns this v</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;CB&#39;</span> <span class="ow">or</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residue_type</span> <span class="o">==</span> <span class="s1">&#39;GLY&#39;</span> <span class="ow">and</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;2HA&#39;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;HA3&#39;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Atom.is_ca" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">is_ca</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">is_ca</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Is the Atom a CA atom?</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_ca</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Is the Atom a CA atom?&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span> <span class="o">==</span> <span class="s1">&#39;CA&#39;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Atom.is_heavy" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">is_heavy</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">is_heavy</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Is the Atom a heavy atom?</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_heavy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Is the Atom a heavy atom?&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s1">&#39;H&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_type</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Atom.get_atom_record" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_atom_record</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_atom_record</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">str</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Provide the Atom as an Atom record string</p>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>str</code>
        
        <div class="doc-md-description">
          <p>The archived .pdb formatted ATOM records for the Structure</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_atom_record</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provide the Atom as an Atom record string</span>

<span class="sd">    Returns:</span>
<span class="sd">        The archived .pdb formatted ATOM records for the Structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
    <span class="c1"># Add 1 to the self.index since this is 0 indexed</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;ATOM  </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">:</span><span class="s1">5d</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_type_str</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">alt_location</span><span class="si">:</span><span class="s1">1s</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">residue_type</span><span class="si">:</span><span class="s1">3s</span><span class="si">}</span><span class="s1">&#39;</span> \
           <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="si">:</span><span class="s1">&gt;2s</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">residue_number</span><span class="si">:</span><span class="s1">4d</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">code_for_insertion</span><span class="si">:</span><span class="s1">1s</span><span class="si">}</span><span class="s1">   &#39;</span> \
           <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}{</span><span class="n">y</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}{</span><span class="n">z</span><span class="si">:</span><span class="s1">8.3f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">occupancy</span><span class="si">:</span><span class="s1">6.2f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">b_factor</span><span class="si">:</span><span class="s1">6.2f</span><span class="si">}</span><span class="s1">          &#39;</span> \
           <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="si">:</span><span class="s1">&gt;2s</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="si">:</span><span class="s1">2s</span><span class="si">}</span><span class="s1">&#39;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Atom.__str__" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">__str__</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="fm">__str__</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">str</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Represent Atom in PDB format</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Represent Atom in PDB format&quot;&quot;&quot;</span>
    <span class="c1"># Use self.type_str to comply with the PDB format specifications because of the atom type field</span>
    <span class="c1"># ATOM     32  CG2 VAL A 132       9.902  -5.550   0.695  1.00 17.48           C  &lt;-- PDB format</span>
    <span class="c1"># Checks if len(atom.type)=4 with slice v. If not insert a space</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;ATOM  </span><span class="si">{</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_type_str</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">alt_location</span><span class="si">:</span><span class="s1">1s</span><span class="si">}{</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="si">}{</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="si">}{</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="si">}</span><span class="s1">&#39;</span> \
           <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">code_for_insertion</span><span class="si">:</span><span class="s1">1s</span><span class="si">}</span><span class="s1">   </span><span class="si">{</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">&quot;</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">occupancy</span><span class="si">:</span><span class="s1">6.2f</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">b_factor</span><span class="si">:</span><span class="s1">6.2f</span><span class="si">}</span><span class="s1">          &#39;</span> \
           <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">element</span><span class="si">:</span><span class="s1">&gt;2s</span><span class="si">}{</span><span class="bp">self</span><span class="o">.</span><span class="n">charge</span><span class="si">:</span><span class="s1">2s</span><span class="si">}</span><span class="s1">&#39;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="structure.base.StructureBaseContainer" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">StructureBaseContainer</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">StructureBaseContainer</span><span class="p">(</span><span class="n">structs</span><span class="p">:</span> <span class="n"><span title="collections.abc.Sequence">Sequence</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.StructureBase" href="#structure.base.StructureBase">StructureBase</a></span><span class="p">]</span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="typing.Generic">Generic</span>[<span title="structure.base._StructType">_StructType</span>]</code></p>

  
      <p>Container for a StructureBase instances</p>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>structs</code></b>
            (<code><span title="collections.abc.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="structure.base.StructureBase" href="#structure.base.StructureBase">StructureBase</a>] | <span title="numpy.ndarray">ndarray</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The StructureBase instances to store. Should be a homogeneous Sequence</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>symdesign/structure/base.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structs</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">StructureBase</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the instance</span>

<span class="sd">    Args:</span>
<span class="sd">        structs: The StructureBase instances to store. Should be a homogeneous Sequence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">structs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">structs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">structs</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="n">structs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">structs</span><span class="p">)</span>
        <span class="c1"># raise TypeError(</span>
        <span class="c1">#     f&quot;Can&#39;t initialize {self.__class__.__name__} with {type(structs).__name__}. Type must be a &quot;</span>
        <span class="c1">#     f&#39;numpy.ndarray or list[{StructureBase.__name__}]&#39;)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">structs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">structs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">object_</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="structure.base.StructureBaseContainer.reindex" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">reindex</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">reindex</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="structure.base.StructureBaseContainer.are_dependents" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">are_dependents</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">are_dependents</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Check if any of the StructureBase instances are dependents of another StructureBase</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">are_dependents</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if any of the StructureBase instances are dependents of another StructureBase&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">struct</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">struct</span><span class="o">.</span><span class="n">is_dependent</span><span class="p">():</span>
            <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.StructureBaseContainer.append" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">append</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">append</span><span class="p">(</span><span class="n">new_structures</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><span title="structure.base._StructType">_StructType</span></span><span class="p">]</span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Append additional StructureBase instances to the StructureBaseContainer</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>new_structures</code></b>
            (<code>list[<span title="structure.base._StructType">_StructType</span>] | <span title="numpy.ndarray">ndarray</span></code>)
        
        <div class="doc-md-description">
          <p>The Structure instances to append</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1635</span>
<span class="normal">1636</span>
<span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">append</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_structures</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">_StructType</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Append additional StructureBase instances to the StructureBaseContainer</span>

<span class="sd">    Args:</span>
<span class="sd">        new_structures: The Structure instances to append</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">structs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="p">,</span> <span class="n">new_structures</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.StructureBaseContainer.delete" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">delete</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">delete</span><span class="p">(</span><span class="n">indices</span><span class="p">:</span> <span class="n"><span title="collections.abc.Sequence">Sequence</span></span><span class="p">[</span><span class="n">int</span><span class="p">])</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Delete StructureBase instances from the StructureBaseContainer</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>indices</code></b>
            (<code><span title="collections.abc.Sequence">Sequence</span>[int]</code>)
        
        <div class="doc-md-description">
          <p>The indices to delete</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Delete StructureBase instances from the StructureBaseContainer</span>

<span class="sd">    Args:</span>
<span class="sd">        indices: The indices to delete</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">structs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="p">,</span> <span class="n">indices</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.StructureBaseContainer.insert" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">insert</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">insert</span><span class="p">(</span><span class="n">at</span><span class="p">:</span> <span class="n">int</span><span class="p">,</span> <span class="n">new_structures</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><span title="structure.base._StructType">_StructType</span></span><span class="p">]</span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Insert StructureBase instances into the StructureBaseContainer</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>at</code></b>
            (<code>int</code>)
        
        <div class="doc-md-description">
          <p>The index to perform the insert at</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>new_structures</code></b>
            (<code>list[<span title="structure.base._StructType">_StructType</span>] | <span title="numpy.ndarray">ndarray</span></code>)
        
        <div class="doc-md-description">
          <p>The Structure instances to insert</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">insert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">at</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">new_structures</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">_StructType</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Insert StructureBase instances into the StructureBaseContainer</span>

<span class="sd">    Args:</span>
<span class="sd">        at: The index to perform the insert at</span>
<span class="sd">        new_structures: The Structure instances to insert</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">structs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="p">[:</span><span class="n">at</span><span class="p">],</span>
        <span class="n">new_structures</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">new_structures</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">)</span> <span class="k">else</span> <span class="p">[</span><span class="n">new_structures</span><span class="p">],</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="p">[</span><span class="n">at</span><span class="p">:]</span>
    <span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.StructureBaseContainer.set" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">set</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nb">set</span><span class="p">(</span><span class="n">new_structures</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><span title="structure.base._StructType">_StructType</span></span><span class="p">]</span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Set the StructureBaseContainer with new StructureBase instances</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>new_structures</code></b>
            (<code>list[<span title="structure.base._StructType">_StructType</span>] | <span title="numpy.ndarray">ndarray</span></code>)
        
        <div class="doc-md-description">
          <p>The new instances which should make up the container</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_structures</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">_StructType</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the StructureBaseContainer with new StructureBase instances</span>

<span class="sd">    Args:</span>
<span class="sd">        new_structures: The new instances which should make up the container</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">structs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">new_structures</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reindex</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.StructureBaseContainer.reset_state" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">reset_state</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">reset_state</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Remove any attributes from the Structure instances that are part of the current state</p>
<p>This is useful for transfer of ownership, or changes in the state that need to be overwritten</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reset_state</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove any attributes from the Structure instances that are part of the current state</span>

<span class="sd">    This is useful for transfer of ownership, or changes in the state that need to be overwritten</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">struct</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="n">struct</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.StructureBaseContainer.set_attributes" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">set_attributes</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">set_attributes</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Set Structure attributes passed by keyword to their corresponding value</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set Structure attributes passed by keyword to their corresponding value&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">struct</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">struct</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="structure.base.Atoms" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Atoms</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">Atoms</span><span class="p">(</span><span class="n">structs</span><span class="p">:</span> <span class="n"><span title="collections.abc.Sequence">Sequence</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.StructureBase" href="#structure.base.StructureBase">StructureBase</a></span><span class="p">]</span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="structure.base.StructureBaseContainer" href="#structure.base.StructureBaseContainer">StructureBaseContainer</a></code></p>

  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>structs</code></b>
            (<code><span title="collections.abc.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="structure.base.StructureBase" href="#structure.base.StructureBase">StructureBase</a>] | <span title="numpy.ndarray">ndarray</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The StructureBase instances to store. Should be a homogeneous Sequence</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>symdesign/structure/base.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structs</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">StructureBase</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the instance</span>

<span class="sd">    Args:</span>
<span class="sd">        structs: The StructureBase instances to store. Should be a homogeneous Sequence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">structs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">structs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">structs</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="n">structs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">structs</span><span class="p">)</span>
        <span class="c1"># raise TypeError(</span>
        <span class="c1">#     f&quot;Can&#39;t initialize {self.__class__.__name__} with {type(structs).__name__}. Type must be a &quot;</span>
        <span class="c1">#     f&#39;numpy.ndarray or list[{StructureBase.__name__}]&#39;)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">structs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">structs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">object_</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="structure.base.Atoms.reindex" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">reindex</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">reindex</span><span class="p">(</span><span class="n">start_at</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Set each Atom instance index according to incremental Atoms/Coords index</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>start_at</code></b>
            (<code>int</code>, default:
                <code>0</code>
)
        
        <div class="doc-md-description">
          <p>The index to start reindexing at. Must be [0, 'inf']</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span>
<span class="normal">1755</span>
<span class="normal">1756</span>
<span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reindex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_at</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set each Atom instance index according to incremental Atoms/Coords index</span>

<span class="sd">    Args:</span>
<span class="sd">        start_at: The index to start reindexing at. Must be [0, &#39;inf&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">start_at</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">_start_at</span> <span class="o">=</span> <span class="n">start_at</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_start_at</span> <span class="o">=</span> <span class="n">start_at</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">start_at</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">_start_at</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">prior_struct</span><span class="p">,</span> <span class="o">*</span><span class="n">other_structs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="p">[</span><span class="n">_start_at</span><span class="p">:]</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># Not enough values to unpack as the index didn&#39;t slice anything</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">reindex</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">start_at</span><span class="si">=}</span><span class="s1"> is outside of the </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> indices with &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;size </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">start_at</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prior_struct</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">struct</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">other_structs</span><span class="p">,</span> <span class="n">prior_struct</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">struct</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">idx</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="structure.base.ContainsAtoms" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ContainsAtoms</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ContainsAtoms</span><span class="p">(</span><span class="n">atoms</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">]</span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atoms" href="#structure.base.Atoms">Atoms</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">atom_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="structure.base.StructureBase" href="#structure.base.StructureBase">StructureBase</a></code>, <code><span title="abc.ABC">ABC</span></code></p>

  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>atoms</code></b>
            (<code>list[<a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a>] | <a class="autorefs autorefs-internal" title="structure.base.Atoms" href="#structure.base.Atoms">Atoms</a></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>Atom instances to initialize the instance</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>symdesign/structure/base.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1880</span>
<span class="normal">1881</span>
<span class="normal">1882</span>
<span class="normal">1883</span>
<span class="normal">1884</span>
<span class="normal">1885</span>
<span class="normal">1886</span>
<span class="normal">1887</span>
<span class="normal">1888</span>
<span class="normal">1889</span>
<span class="normal">1890</span>
<span class="normal">1891</span>
<span class="normal">1892</span>
<span class="normal">1893</span>
<span class="normal">1894</span>
<span class="normal">1895</span>
<span class="normal">1896</span>
<span class="normal">1897</span>
<span class="normal">1898</span>
<span class="normal">1899</span>
<span class="normal">1900</span>
<span class="normal">1901</span>
<span class="normal">1902</span>
<span class="normal">1903</span>
<span class="normal">1904</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atoms</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Atom</span><span class="p">]</span> <span class="o">|</span> <span class="n">Atoms</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">atom_indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the instance</span>

<span class="sd">    Args:</span>
<span class="sd">        atoms: Atom instances to initialize the instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># ContainsAtoms</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parent</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">atoms</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_assign_atoms</span><span class="p">(</span><span class="n">atoms</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># Create an empty container</span>
            <span class="c1"># try:</span>
            <span class="c1">#     self._atoms</span>
            <span class="c1"># except AttributeError:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_atoms</span> <span class="o">=</span> <span class="n">Atoms</span><span class="p">()</span>
    <span class="k">elif</span> <span class="n">atom_indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">atom_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="p">(</span><span class="ne">TypeError</span><span class="p">,</span> <span class="ne">IndexError</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> wasn&#39;t passed &#39;atom_indices&#39; which are required for initialization&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">atom_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_indices</span> <span class="o">=</span> <span class="n">atom_indices</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.atoms" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">atoms</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">atoms</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the Atom instances in the StructureBase</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.atom_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">atom_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">atom_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The Atoms/Coords indices which the StructureBase has access to</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.number_of_atoms" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">number_of_atoms</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">number_of_atoms</span><span class="p">:</span> <span class="n">int</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The number of atoms/coordinates in the StructureBase</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.backbone_and_cb_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">backbone_and_cb_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">backbone_and_cb_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The indices that index the StructureBase backbone and CB Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.backbone_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">backbone_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">backbone_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The indices that index the StructureBase backbone and CB Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.ca_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">ca_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ca_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The indices that index the StructureBase CA Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.cb_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">cb_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">cb_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The indices that index the StructureBase CB Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.heavy_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">heavy_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">heavy_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The indices that index the StructureBase heavy (non-hydrogen) Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.side_chain_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">side_chain_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">side_chain_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The indices that index the StructureBase side-chain Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.backbone_atoms" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">backbone_atoms</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">backbone_atoms</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns backbone Atom instances from the StructureBase</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.backbone_and_cb_atoms" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">backbone_and_cb_atoms</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">backbone_and_cb_atoms</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns backbone and CB Atom instances from the StructureBase</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.ca_atoms" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">ca_atoms</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ca_atoms</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns CA Atom instances from the StructureBase</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.cb_atoms" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">cb_atoms</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">cb_atoms</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns CB Atom instances from the StructureBase</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.heavy_atoms" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">heavy_atoms</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">heavy_atoms</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns heavy Atom instances from the StructureBase</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.side_chain_atoms" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">side_chain_atoms</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">side_chain_atoms</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns side chain Atom instances from the StructureBase</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.center_of_mass" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">center_of_mass</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">center_of_mass</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The center of mass for the Atom coordinates</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.radius" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">radius</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">radius</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The furthest point from the center of mass of the StructureBase</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.radius_of_gyration" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">radius_of_gyration</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">radius_of_gyration</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The measurement of the implied radius (Angstroms) affecting how the StructureBase diffuses through solution</p>

<details class="satisfies-the-equation" open>
  <summary>Satisfies the equation</summary>
  <p>Rg = SQRT(SUM|i-&gt;N(Ri**2)/N)</p>
</details>      <p>Where:
    - Ri is the radius of the point i from the center of mass point
    - N is the total number of points</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.backbone_coords" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">backbone_coords</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">backbone_coords</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return a view of the Coords from the StructureBase with backbone atom coordinates</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.backbone_and_cb_coords" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">backbone_and_cb_coords</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">backbone_and_cb_coords</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return a view of the Coords from the StructureBase with backbone and CB atom coordinates. Includes glycine CA</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.ca_coords" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">ca_coords</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ca_coords</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return a view of the Coords from the Structure with CA atom coordinates</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.cb_coords" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">cb_coords</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">cb_coords</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return a view of the Coords from the Structure with CB atom coordinates</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.heavy_coords" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">heavy_coords</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">heavy_coords</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return a view of the Coords from the StructureBase with heavy atom coordinates</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.side_chain_coords" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">side_chain_coords</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">side_chain_coords</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return a view of the Coords from the StructureBase with side chain atom coordinates</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.start_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">start_index</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">start_index</span><span class="p">:</span> <span class="n">int</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The first atomic index of the StructureBase</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsAtoms.end_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">end_index</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">end_index</span><span class="p">:</span> <span class="n">int</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The last atomic index of the StructureBase</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsAtoms.make_parent" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make_parent</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">make_parent</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Remove this instance from its parent, making it a parent in the process</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1913</span>
<span class="normal">1914</span>
<span class="normal">1915</span>
<span class="normal">1916</span>
<span class="normal">1917</span>
<span class="normal">1918</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">make_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove this instance from its parent, making it a parent in the process&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">make_parent</span><span class="p">()</span>
    <span class="c1"># Populate the Structure with its existing instances removed of any indexing</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_assign_atoms</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsAtoms.get_base_containers" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_base_containers</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_base_containers</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Access each of the constituent structure container attributes</p>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>dict[str, <span title="typing.Any">Any</span>]</code>
        
        <div class="doc-md-description">
          <p>The instance structural containers as a dictionary with attribute as key and container as value</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1920</span>
<span class="normal">1921</span>
<span class="normal">1922</span>
<span class="normal">1923</span>
<span class="normal">1924</span>
<span class="normal">1925</span>
<span class="normal">1926</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_base_containers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Access each of the constituent structure container attributes</span>

<span class="sd">    Returns:</span>
<span class="sd">        The instance structural containers as a dictionary with attribute as key and container as value</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">coords</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_coords</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_atoms</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsAtoms.neighboring_atom_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">neighboring_atom_indices</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">neighboring_atom_indices</span><span class="p">(</span><span class="n">distance</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="mf">8.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the Atom instances in the Structure</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>distance</code></b>
            (<code>float</code>, default:
                <code>8.0</code>
)
        
        <div class="doc-md-description">
          <p>The distance to measure neighbors by</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[int]</code>
        
        <div class="doc-md-description">
          <p>The sorted atom_indices which are in contact with this instance, however, do not belong to the instance</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2033</span>
<span class="normal">2034</span>
<span class="normal">2035</span>
<span class="normal">2036</span>
<span class="normal">2037</span>
<span class="normal">2038</span>
<span class="normal">2039</span>
<span class="normal">2040</span>
<span class="normal">2041</span>
<span class="normal">2042</span>
<span class="normal">2043</span>
<span class="normal">2044</span>
<span class="normal">2045</span>
<span class="normal">2046</span>
<span class="normal">2047</span>
<span class="normal">2048</span>
<span class="normal">2049</span>
<span class="normal">2050</span>
<span class="normal">2051</span>
<span class="normal">2052</span>
<span class="normal">2053</span>
<span class="normal">2054</span>
<span class="normal">2055</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">neighboring_atom_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">8.</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>  <span class="c1"># np.ndarray:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the Atom instances in the Structure</span>

<span class="sd">    Args:</span>
<span class="sd">        distance: The distance to measure neighbors by</span>

<span class="sd">    Returns:</span>
<span class="sd">        The sorted atom_indices which are in contact with this instance, however, do not belong to the instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parent_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_coords</span><span class="o">.</span><span class="n">coords</span>
    <span class="n">atom_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atom_indices</span>

    <span class="c1"># Create a &quot;self.coords&quot; and modify only coordinates in the ContainsAtoms instance</span>
    <span class="n">modified_self_coords</span> <span class="o">=</span> <span class="n">parent_coords</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1"># Translate each self coordinate</span>
    <span class="n">modified_self_coords</span><span class="p">[</span><span class="n">atom_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">parent_coords</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">]</span>
    <span class="n">modified_coords_balltree</span> <span class="o">=</span> <span class="n">BallTree</span><span class="p">(</span><span class="n">modified_self_coords</span><span class="p">)</span>

    <span class="c1"># Query for neighbors of the self coordinates but excluding the self indices</span>
    <span class="n">coords</span> <span class="o">=</span> <span class="n">parent_coords</span><span class="p">[</span><span class="n">atom_indices</span><span class="p">]</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">modified_coords_balltree</span><span class="o">.</span><span class="n">query_radius</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">distance</span><span class="p">)</span>

    <span class="k">return</span> <span class="nb">sorted</span><span class="p">({</span><span class="n">idx</span> <span class="k">for</span> <span class="n">contacts</span> <span class="ow">in</span> <span class="n">query</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">contacts</span><span class="o">.</span><span class="n">tolist</span><span class="p">()})</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsAtoms.atom" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">atom</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">atom</span><span class="p">(</span><span class="n">atom_number</span><span class="p">:</span> <span class="n">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the Atom specified by atom number if a matching Atom is found, otherwise None</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2142</span>
<span class="normal">2143</span>
<span class="normal">2144</span>
<span class="normal">2145</span>
<span class="normal">2146</span>
<span class="normal">2147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">atom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atom_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Atom</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the Atom specified by atom number if a matching Atom is found, otherwise None&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">number</span> <span class="o">==</span> <span class="n">atom_number</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">atom</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsAtoms.renumber_atoms" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">renumber_atoms</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">renumber_atoms</span><span class="p">(</span><span class="n">at</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Renumber all Atom objects sequentially starting with 1</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>at</code></b>
            (<code>int</code>, default:
                <code>1</code>
)
        
        <div class="doc-md-description">
          <p>The number to start renumbering at</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2207</span>
<span class="normal">2208</span>
<span class="normal">2209</span>
<span class="normal">2210</span>
<span class="normal">2211</span>
<span class="normal">2212</span>
<span class="normal">2213</span>
<span class="normal">2214</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">renumber_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">at</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Renumber all Atom objects sequentially starting with 1</span>

<span class="sd">    Args:</span>
<span class="sd">        at: The number to start renumbering at</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">,</span> <span class="n">at</span><span class="p">):</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">idx</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsAtoms.reset_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">reset_indices</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">reset_indices</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Reset the indices attached to the instance</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2226</span>
<span class="normal">2227</span>
<span class="normal">2228</span>
<span class="normal">2229</span>
<span class="normal">2230</span>
<span class="normal">2231</span>
<span class="normal">2232</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reset_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reset the indices attached to the instance&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">attr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_indices_attributes</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="nb">delattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
            <span class="k">continue</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsAtoms.format_header" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">format_header</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">format_header</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">str</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the base .pdb formatted header</p>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>str</code>
        
        <div class="doc-md-description">
          <p>The .pdb file header string</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2234</span>
<span class="normal">2235</span>
<span class="normal">2236</span>
<span class="normal">2237</span>
<span class="normal">2238</span>
<span class="normal">2239</span>
<span class="normal">2240</span>
<span class="normal">2241</span>
<span class="normal">2242</span>
<span class="normal">2243</span>
<span class="normal">2244</span>
<span class="normal">2245</span>
<span class="normal">2246</span>
<span class="normal">2247</span>
<span class="normal">2248</span>
<span class="normal">2249</span>
<span class="normal">2250</span>
<span class="normal">2251</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">format_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the base .pdb formatted header</span>

<span class="sd">    Returns:</span>
<span class="sd">        The .pdb file header string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># XXXX should be substituted for the PDB code. Ex:</span>
    <span class="c1"># f&#39;HEADER    VIRAL PROTEIN                           28-MAY-21   7OP2              \n&#39;</span>
    <span class="c1"># f&#39;HEADER    VIRAL PROTEIN/DE NOVO PROTEIN           11-MAY-12   4ATZ              \n&#39;</span>
    <span class="k">return</span> \
        <span class="sa">f</span><span class="s1">&#39;HEADER    </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[:</span><span class="mi">40</span><span class="p">]</span><span class="si">:</span><span class="s1">&lt;40s</span><span class="si">}{</span><span class="n">utils</span><span class="o">.</span><span class="n">short_start_date</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">:</span><span class="s1">&lt;12s</span><span class="si">}{</span><span class="s2">&quot;XXXX&quot;</span><span class="si">:</span><span class="s1">&lt;18s</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span> \
        <span class="s1">&#39;EXPDTA    THEORETICAL MODEL                                                     </span><span class="se">\n</span><span class="s1">&#39;</span> \
        <span class="s1">&#39;REMARK 220                                                                      </span><span class="se">\n</span><span class="s1">&#39;</span> \
        <span class="s1">&#39;REMARK 220 EXPERIMENTAL DETAILS                                                 </span><span class="se">\n</span><span class="s1">&#39;</span> \
        <span class="s1">&#39;REMARK 220  EXPERIMENT TYPE                : THEORETICAL MODELLING              </span><span class="se">\n</span><span class="s1">&#39;</span> \
        <span class="sa">f</span><span class="s1">&#39;REMARK 220  DATE OF DATA COLLECTION        : </span><span class="si">{</span><span class="n">utils</span><span class="o">.</span><span class="n">long_start_date</span><span class="si">:</span><span class="s1">&lt;35s</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span> \
        <span class="sa">f</span><span class="s1">&#39;REMARK 220 REMARK: MODEL GENERATED BY </span><span class="si">{</span><span class="n">putils</span><span class="o">.</span><span class="n">program_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">:</span><span class="s1">&lt;50s</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span> \
        <span class="sa">f</span><span class="s1">&#39;REMARK 220         VERSION </span><span class="si">{</span><span class="n">putils</span><span class="o">.</span><span class="n">commit_short</span><span class="si">:</span><span class="s1">&lt;61s</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsAtoms.get_atom_record" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_atom_record</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_atom_record</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">str</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Provide the Structure Atom instances as a .pdb file string</p>



  <p>Other Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>chain_id</code></b>
        
        <div class="doc-md-description">
          <p>str = None - The chain ID to use</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>atom_offset</code></b>
        
        <div class="doc-md-description">
          <p>int = 0 - How much to offset the atom number by. Default returns one-indexed</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>str</code>
        
        <div class="doc-md-description">
          <p>The archived .pdb formatted ATOM records for the Structure</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2253</span>
<span class="normal">2254</span>
<span class="normal">2255</span>
<span class="normal">2256</span>
<span class="normal">2257</span>
<span class="normal">2258</span>
<span class="normal">2259</span>
<span class="normal">2260</span>
<span class="normal">2261</span>
<span class="normal">2262</span>
<span class="normal">2263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span> <span class="nf">get_atom_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provide the Structure Atom instances as a .pdb file string</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        chain_id: str = None - The chain ID to use</span>
<span class="sd">        atom_offset: int = 0 - How much to offset the atom number by. Default returns one-indexed</span>

<span class="sd">    Returns:</span>
<span class="sd">        The archived .pdb formatted ATOM records for the Structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsAtoms.write" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">write</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">write</span><span class="p">(</span><span class="n">out_path</span><span class="p">:</span> <span class="n">bytes</span> <span class="o">|</span> <span class="n">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">file_handle</span><span class="p">:</span> <span class="n"><span title="typing.IO">IO</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">header</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.AnyStr">AnyStr</span></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Write Atom instances to a file specified by out_path or with a passed file_handle</p>
<p>If a file_handle is passed, no header information will be written. Arguments are mutually exclusive</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>out_path</code></b>
            (<code>bytes | str</code>, default:
                <code><span title="os.getcwd">getcwd</span>()</code>
)
        
        <div class="doc-md-description">
          <p>The location where the Structure object should be written to disk</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>file_handle</code></b>
            (<code><span title="typing.IO">IO</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>Used to write Structure details to an open FileObject</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>header</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>A string that is desired at the top of the file</p>
        </div>
      </li>
  </ul>
      <p>Keyword Args
    chain_id: str = None - The chain ID to use
    atom_offset: int = 0 - How much to offset the atom index by. Default uses one-indexed atom numbers</p>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="typing.AnyStr">AnyStr</span> | None</code>
        
        <div class="doc-md-description">
          <p>The name of the written file if out_path is used</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2265</span>
<span class="normal">2266</span>
<span class="normal">2267</span>
<span class="normal">2268</span>
<span class="normal">2269</span>
<span class="normal">2270</span>
<span class="normal">2271</span>
<span class="normal">2272</span>
<span class="normal">2273</span>
<span class="normal">2274</span>
<span class="normal">2275</span>
<span class="normal">2276</span>
<span class="normal">2277</span>
<span class="normal">2278</span>
<span class="normal">2279</span>
<span class="normal">2280</span>
<span class="normal">2281</span>
<span class="normal">2282</span>
<span class="normal">2283</span>
<span class="normal">2284</span>
<span class="normal">2285</span>
<span class="normal">2286</span>
<span class="normal">2287</span>
<span class="normal">2288</span>
<span class="normal">2289</span>
<span class="normal">2290</span>
<span class="normal">2291</span>
<span class="normal">2292</span>
<span class="normal">2293</span>
<span class="normal">2294</span>
<span class="normal">2295</span>
<span class="normal">2296</span>
<span class="normal">2297</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">write</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">out_path</span><span class="p">:</span> <span class="nb">bytes</span> <span class="o">|</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">file_handle</span><span class="p">:</span> <span class="n">IO</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">header</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnyStr</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Write Atom instances to a file specified by out_path or with a passed file_handle</span>

<span class="sd">    If a file_handle is passed, no header information will be written. Arguments are mutually exclusive</span>

<span class="sd">    Args:</span>
<span class="sd">        out_path: The location where the Structure object should be written to disk</span>
<span class="sd">        file_handle: Used to write Structure details to an open FileObject</span>
<span class="sd">        header: A string that is desired at the top of the file</span>

<span class="sd">    Keyword Args</span>
<span class="sd">        chain_id: str = None - The chain ID to use</span>
<span class="sd">        atom_offset: int = 0 - How much to offset the atom index by. Default uses one-indexed atom numbers</span>

<span class="sd">    Returns:</span>
<span class="sd">        The name of the written file if out_path is used</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">file_handle</span><span class="p">:</span>
        <span class="n">file_handle</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_atom_record</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># out_path always has default argument current working directory</span>
        <span class="n">_header</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_header</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">header</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">header</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">header</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
            <span class="n">_header</span> <span class="o">+=</span> <span class="p">(</span><span class="n">header</span> <span class="k">if</span> <span class="n">header</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:]</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">header</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">outfile</span><span class="p">:</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">_header</span><span class="p">)</span>
            <span class="n">outfile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_atom_record</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">out_path</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsAtoms.get_atoms" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_atoms</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_atoms</span><span class="p">(</span><span class="n">numbers</span><span class="p">:</span> <span class="n"><span title="collections.abc.Container">Container</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Retrieves Atom instances. Returns all by default unless a list of numbers is specified</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>numbers</code></b>
            (<code><span title="collections.abc.Container">Container</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The Atom numbers of interest</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[<a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a>]</code>
        
        <div class="doc-md-description">
          <p>The requested Atom objects</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2299</span>
<span class="normal">2300</span>
<span class="normal">2301</span>
<span class="normal">2302</span>
<span class="normal">2303</span>
<span class="normal">2304</span>
<span class="normal">2305</span>
<span class="normal">2306</span>
<span class="normal">2307</span>
<span class="normal">2308</span>
<span class="normal">2309</span>
<span class="normal">2310</span>
<span class="normal">2311</span>
<span class="normal">2312</span>
<span class="normal">2313</span>
<span class="normal">2314</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numbers</span><span class="p">:</span> <span class="n">Container</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Atom</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieves Atom instances. Returns all by default unless a list of numbers is specified</span>

<span class="sd">    Args:</span>
<span class="sd">        numbers: The Atom numbers of interest</span>

<span class="sd">    Returns:</span>
<span class="sd">        The requested Atom objects</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">numbers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">atom</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span> <span class="k">if</span> <span class="n">atom</span><span class="o">.</span><span class="n">number</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The passed numbers type &quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&quot; must be a Container. Returning&#39;</span>
                           <span class="sa">f</span><span class="s1">&#39; all Atom instances instead&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsAtoms.set_atoms_attributes" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">set_atoms_attributes</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">set_atoms_attributes</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Set attributes specified by key, value pairs for Atoms in the Structure</p>



  <p>Other Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>numbers</code></b>
        
        <div class="doc-md-description">
          <p>Container[int] = None - The Atom numbers of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>pdb</code></b>
        
        <div class="doc-md-description">
          <p>bool = False - Whether to search for numbers as they were parsed (if True)</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2316</span>
<span class="normal">2317</span>
<span class="normal">2318</span>
<span class="normal">2319</span>
<span class="normal">2320</span>
<span class="normal">2321</span>
<span class="normal">2322</span>
<span class="normal">2323</span>
<span class="normal">2324</span>
<span class="normal">2325</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_atoms_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set attributes specified by key, value pairs for Atoms in the Structure</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        numbers: Container[int] = None - The Atom numbers of interest</span>
<span class="sd">        pdb: bool = False - Whether to search for numbers as they were parsed (if True)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_atoms</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">kwarg</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="n">kwarg</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="structure.base.Residue" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Residue</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">Residue</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="structure.base.ContainsAtoms" href="#structure.base.ContainsAtoms">ContainsAtoms</a></code>, <code><a class="autorefs autorefs-internal" title="structure.fragment.ResidueFragment" href="../fragment/#structure.fragment.ResidueFragment">ResidueFragment</a></code></p>

  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>**kwargs</code></b>
        
        <div class="doc-md-description">
          
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>symdesign/structure/base.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2387</span>
<span class="normal">2388</span>
<span class="normal">2389</span>
<span class="normal">2390</span>
<span class="normal">2391</span>
<span class="normal">2392</span>
<span class="normal">2393</span>
<span class="normal">2394</span>
<span class="normal">2395</span>
<span class="normal">2396</span>
<span class="normal">2397</span>
<span class="normal">2398</span>
<span class="normal">2399</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the instance</span>

<span class="sd">    Args:</span>
<span class="sd">        **kwargs:</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># Residue</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parent</span><span class="p">():</span>
        <span class="c1"># Setting up a parent (independent) Residue</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_ensure_valid_residue</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_index</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">delegate_atoms</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.index" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">index</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">index</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The Residue index in a Residues container</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.range" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">range</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nb">range</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The range of indices corresponding to the Residue atoms</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.type1" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">type1</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">type1</span><span class="p">:</span> <span class="n">str</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Access the one character representation of the amino acid type</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.backbone_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">backbone_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">backbone_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The indices that index the Residue backbone Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.backbone_and_cb_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">backbone_and_cb_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">backbone_and_cb_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The indices that index the Residue backbone and CB Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.ca_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">ca_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ca_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the index of the CA Atom as a list in the Residue Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.cb_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">cb_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">cb_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the index of the CB Atom as a list in the Residue Atoms/Coords. Will return CA index if Glycine</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.side_chain_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">side_chain_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">side_chain_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The indices that index the Residue side chain Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.heavy_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">heavy_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">heavy_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The indices that index the Residue heavy (non-hydrogen) Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.n" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">n</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">n</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the amide N Atom object</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.n_coords" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">n_coords</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">n_coords</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the amide N Atom coordinate</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.n_atom_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">n_atom_index</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">n_atom_index</span><span class="p">:</span> <span class="n">int</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the index of the amide N Atom in the Structure Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.n_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">n_index</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">n_index</span><span class="p">:</span> <span class="n">int</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the index of the amide N Atom in the Residue Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.h" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">h</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">h</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the amide H Atom object</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.h_coords" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">h_coords</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">h_coords</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the amide H Atom coordinate</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.h_atom_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">h_atom_index</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">h_atom_index</span><span class="p">:</span> <span class="n">int</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the index of the amide H Atom in the Structure Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.h_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">h_index</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">h_index</span><span class="p">:</span> <span class="n">int</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the index of the amide H Atom in the Residue Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.ca" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">ca</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ca</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the CA Atom object</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.ca_coords" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">ca_coords</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ca_coords</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the CA Atom coordinate</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.ca_atom_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">ca_atom_index</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ca_atom_index</span><span class="p">:</span> <span class="n">int</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the index of the CA Atom in the Structure Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.ca_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">ca_index</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ca_index</span><span class="p">:</span> <span class="n">int</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the index of the CA Atom in the Residue Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.cb" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">cb</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">cb</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the CB Atom object</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.cb_coords" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">cb_coords</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">cb_coords</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the CB Atom coordinate</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.cb_atom_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">cb_atom_index</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">cb_atom_index</span><span class="p">:</span> <span class="n">int</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the index of the CB Atom in the Structure Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.cb_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">cb_index</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">cb_index</span><span class="p">:</span> <span class="n">int</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the index of the CB Atom in the Residue Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.c" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">c</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">c</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the carbonyl C Atom object</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.c_coords" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">c_coords</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">c_coords</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the carbonyl C Atom coordinate</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.c_atom_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">c_atom_index</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">c_atom_index</span><span class="p">:</span> <span class="n">int</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the index of the carbonyl C Atom in the Structure Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.c_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">c_index</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">c_index</span><span class="p">:</span> <span class="n">int</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the index of the carbonyl C Atom in the Residue Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.o" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">o</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">o</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the carbonyl O Atom object</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.o_coords" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">o_coords</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">o_coords</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the carbonyl O Atom coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.o_atom_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">o_atom_index</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">o_atom_index</span><span class="p">:</span> <span class="n">int</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the index of the carbonyl C Atom in the Structure Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.o_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">o_index</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">o_index</span><span class="p">:</span> <span class="n">int</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the index of the carbonyl O Atom in the Residue Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.prev_residue" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">prev_residue</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">prev_residue</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The previous Residue in the Structure if this Residue is part of a polymer</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.next_residue" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">next_residue</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">next_residue</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The next Residue in the Structure if this Residue is part of a polymer</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.local_density" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">local_density</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">local_density</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Describes how many heavy Atoms are within a distance (default = 12 Angstroms) of Residue heavy Atoms</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.secondary_structure" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">secondary_structure</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">secondary_structure</span><span class="p">:</span> <span class="n">str</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the secondary structure designation as defined by a secondary structure calculation</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.sasa" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">sasa</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">sasa</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the solvent accessible surface area as calculated by a solvent accessible surface area calculator</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.sasa_apolar" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">sasa_apolar</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">sasa_apolar</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return apolar solvent accessible surface area as calculated by a solvent accessible surface area calculator</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.sasa_polar" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">sasa_polar</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">sasa_polar</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return polar solvent accessible surface area as calculated by a solvent accessible surface area calculator</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.relative_sasa" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">relative_sasa</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">relative_sasa</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The solvent accessible surface area relative to the standard surface accessibility of the Residue type</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.spatial_aggregation_propensity" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">spatial_aggregation_propensity</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">spatial_aggregation_propensity</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The Residue contact order, which describes how far away each Residue makes contacts in the polymer chain</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Residue.contact_order" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">contact_order</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">contact_order</span><span class="p">:</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The Residue contact order, which describes how far away each Residue makes contacts in the polymer chain</p>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="structure.base.Residue.start_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">start_index</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">start_index</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="n">int</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Set Residue atom_indices starting with atom_indices[0] as start_index. Creates remainder incrementally and
updates individual Atom instance .index accordingly</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2450</span>
<span class="normal">2451</span>
<span class="normal">2452</span>
<span class="normal">2453</span>
<span class="normal">2454</span>
<span class="normal">2455</span>
<span class="normal">2456</span>
<span class="normal">2457</span>
<span class="normal">2458</span>
<span class="normal">2459</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@ContainsAtoms</span><span class="o">.</span><span class="n">start_index</span><span class="o">.</span><span class="n">setter</span>
<span class="k">def</span> <span class="nf">start_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set Residue atom_indices starting with atom_indices[0] as start_index. Creates remainder incrementally and</span>
<span class="sd">    updates individual Atom instance .index accordingly</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_atom_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_atoms</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">atom</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_atoms</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_atom_indices</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_indices</span><span class="p">):</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">index</span>
    <span class="c1"># Clear all the indices attributes for this Residue</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reset_indices</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Residue.delegate_atoms" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">delegate_atoms</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">delegate_atoms</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Set the Residue atoms from a parent StructureBase</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2466</span>
<span class="normal">2467</span>
<span class="normal">2468</span>
<span class="normal">2469</span>
<span class="normal">2470</span>
<span class="normal">2471</span>
<span class="normal">2472</span>
<span class="normal">2473</span>
<span class="normal">2474</span>
<span class="normal">2475</span>
<span class="normal">2476</span>
<span class="normal">2477</span>
<span class="normal">2478</span>
<span class="normal">2479</span>
<span class="normal">2480</span>
<span class="normal">2481</span>
<span class="normal">2482</span>
<span class="normal">2483</span>
<span class="normal">2484</span>
<span class="normal">2485</span>
<span class="normal">2486</span>
<span class="normal">2487</span>
<span class="normal">2488</span>
<span class="normal">2489</span>
<span class="normal">2490</span>
<span class="normal">2491</span>
<span class="normal">2492</span>
<span class="normal">2493</span>
<span class="normal">2494</span>
<span class="normal">2495</span>
<span class="normal">2496</span>
<span class="normal">2497</span>
<span class="normal">2498</span>
<span class="normal">2499</span>
<span class="normal">2500</span>
<span class="normal">2501</span>
<span class="normal">2502</span>
<span class="normal">2503</span>
<span class="normal">2504</span>
<span class="normal">2505</span>
<span class="normal">2506</span>
<span class="normal">2507</span>
<span class="normal">2508</span>
<span class="normal">2509</span>
<span class="normal">2510</span>
<span class="normal">2511</span>
<span class="normal">2512</span>
<span class="normal">2513</span>
<span class="normal">2514</span>
<span class="normal">2515</span>
<span class="normal">2516</span>
<span class="normal">2517</span>
<span class="normal">2518</span>
<span class="normal">2519</span>
<span class="normal">2520</span>
<span class="normal">2521</span>
<span class="normal">2522</span>
<span class="normal">2523</span>
<span class="normal">2524</span>
<span class="normal">2525</span>
<span class="normal">2526</span>
<span class="normal">2527</span>
<span class="normal">2528</span>
<span class="normal">2529</span>
<span class="normal">2530</span>
<span class="normal">2531</span>
<span class="normal">2532</span>
<span class="normal">2533</span>
<span class="normal">2534</span>
<span class="normal">2535</span>
<span class="normal">2536</span>
<span class="normal">2537</span>
<span class="normal">2538</span>
<span class="normal">2539</span>
<span class="normal">2540</span>
<span class="normal">2541</span>
<span class="normal">2542</span>
<span class="normal">2543</span>
<span class="normal">2544</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delegate_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the Residue atoms from a parent StructureBase&quot;&quot;&quot;</span>
    <span class="n">side_chain_indices</span><span class="p">,</span> <span class="n">heavy_indices</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="c1"># try:</span>
    <span class="c1">#     for idx, atom in enumerate(self.atoms):</span>
    <span class="c1">#         match atom.type:  # Todo python 3.10</span>
    <span class="c1">#             case &#39;N&#39;:</span>
    <span class="c1">#                 self._n_index = idx</span>
    <span class="c1">#                 if self.number is None:</span>
    <span class="c1">#                     self.chain_id = atom.chain_id</span>
    <span class="c1">#                     self.number = atom.residue_number</span>
    <span class="c1">#                     self.type = atom.residue_type</span>
    <span class="c1">#                else:</span>
    <span class="c1">#                    raise stutils.ConstructionError(</span>
    <span class="c1">#                        f&quot;Couldn&#39;t create a {self.__class__.__name__} with multiple &#39;N&#39; Atom instances&quot;</span>
    <span class="c1">#                    )</span>
    <span class="c1">#             case &#39;CA&#39;:</span>
    <span class="c1">#                 self._ca_index = idx</span>
    <span class="c1">#             case &#39;CB&#39;:</span>
    <span class="c1">#                 self._cb_index = idx</span>
    <span class="c1">#             case &#39;C&#39;:</span>
    <span class="c1">#                 self._c_index = idx</span>
    <span class="c1">#             case &#39;O&#39;:</span>
    <span class="c1">#                 self._o_index = idx</span>
    <span class="c1">#             case &#39;H&#39;:</span>
    <span class="c1">#                 self._h_index = idx</span>
    <span class="c1">#             case _:</span>
    <span class="c1">#                 side_chain_indices.append(idx)</span>
    <span class="c1">#                 if &#39;H&#39; not in atom.type:</span>
    <span class="c1">#                     heavy_indices.append(idx)</span>
    <span class="c1"># except SyntaxError:  # python version not 3.10</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">):</span>
        <span class="n">atom_type</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">type</span>
        <span class="k">if</span> <span class="n">atom_type</span> <span class="o">==</span> <span class="s1">&#39;N&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_n_index</span> <span class="o">=</span> <span class="n">idx</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">chain_id</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">residue_number</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">atom</span><span class="o">.</span><span class="n">residue_type</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">stutils</span><span class="o">.</span><span class="n">ConstructionError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Couldn&#39;t create a </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> with multiple &#39;N&#39; Atom instances&quot;</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="n">atom_type</span> <span class="o">==</span> <span class="s1">&#39;CA&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_ca_index</span> <span class="o">=</span> <span class="n">idx</span>
        <span class="k">elif</span> <span class="n">atom_type</span> <span class="o">==</span> <span class="s1">&#39;CB&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cb_index</span> <span class="o">=</span> <span class="n">idx</span>
        <span class="k">elif</span> <span class="n">atom_type</span> <span class="o">==</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_c_index</span> <span class="o">=</span> <span class="n">idx</span>
        <span class="k">elif</span> <span class="n">atom_type</span> <span class="o">==</span> <span class="s1">&#39;O&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_o_index</span> <span class="o">=</span> <span class="n">idx</span>
        <span class="k">elif</span> <span class="n">atom_type</span> <span class="o">==</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span>  <span class="c1"># 1H or H1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_h_index</span> <span class="o">=</span> <span class="n">idx</span>
        <span class="c1"># elif atom_type == &#39;OXT&#39;:</span>
        <span class="c1">#     self._oxt_index = idx</span>
        <span class="c1"># elif atom_type == &#39;H2&#39;:</span>
        <span class="c1">#     self._h2_index = idx</span>
        <span class="c1"># elif atom_type == &#39;H3&#39;:</span>
        <span class="c1">#     self._h3_index = idx</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">side_chain_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;H&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">atom_type</span><span class="p">:</span>
                <span class="n">heavy_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>

    <span class="c1"># Construction ensures proper order for _bb_indices even if out of order</span>
    <span class="c1"># Important this order is correct for ProteinMPNN</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">backbone_indices</span> <span class="o">=</span> <span class="p">[</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;_</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s1">_index&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="s1">&#39;ca&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">]]</span>
    <span class="n">cb_index</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_cb_index&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cb_index</span><span class="p">:</span>
        <span class="n">cb_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">cb_index</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;GLY&#39;</span><span class="p">:</span>  <span class="c1"># Set _cb_index, but don&#39;t include in backbone_and_cb_indices</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_cb_index</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;_ca_index&#39;</span><span class="p">)</span>
        <span class="n">cb_indices</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># By using private backbone_indices variable v, None is removed</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">backbone_and_cb_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bb_indices</span> <span class="o">+</span> <span class="n">cb_indices</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">heavy_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_bb_and_cb_indices</span> <span class="o">+</span> <span class="n">heavy_indices</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">side_chain_indices</span> <span class="o">=</span> <span class="n">side_chain_indices</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Residue.contains_hydrogen" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">contains_hydrogen</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">contains_hydrogen</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns whether the Residue contains hydrogen atoms</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2626</span>
<span class="normal">2627</span>
<span class="normal">2628</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">contains_hydrogen</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># in Structure too</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns whether the Residue contains hydrogen atoms&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">heavy_indices</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_indices</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Residue.is_n_termini" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">is_n_termini</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">is_n_termini</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns whether the Residue is the n-termini of the parent Structure</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2863</span>
<span class="normal">2864</span>
<span class="normal">2865</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_n_termini</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns whether the Residue is the n-termini of the parent Structure&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev_residue</span> <span class="ow">is</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Residue.is_c_termini" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">is_c_termini</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">is_c_termini</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns whether the Residue is the c-termini of the parent Structure</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2875</span>
<span class="normal">2876</span>
<span class="normal">2877</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_c_termini</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns whether the Residue is the c-termini of the parent Structure&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_residue</span> <span class="ow">is</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Residue.get_upstream" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_upstream</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_upstream</span><span class="p">(</span><span class="n">number</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Get the Residues upstream of (n-terminal to) the current Residue</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>number</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The number of residues to retrieve. If not provided gets all</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>
        
        <div class="doc-md-description">
          <p>The Residue instances in n- to c-terminal order</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2879</span>
<span class="normal">2880</span>
<span class="normal">2881</span>
<span class="normal">2882</span>
<span class="normal">2883</span>
<span class="normal">2884</span>
<span class="normal">2885</span>
<span class="normal">2886</span>
<span class="normal">2887</span>
<span class="normal">2888</span>
<span class="normal">2889</span>
<span class="normal">2890</span>
<span class="normal">2891</span>
<span class="normal">2892</span>
<span class="normal">2893</span>
<span class="normal">2894</span>
<span class="normal">2895</span>
<span class="normal">2896</span>
<span class="normal">2897</span>
<span class="normal">2898</span>
<span class="normal">2899</span>
<span class="normal">2900</span>
<span class="normal">2901</span>
<span class="normal">2902</span>
<span class="normal">2903</span>
<span class="normal">2904</span>
<span class="normal">2905</span>
<span class="normal">2906</span>
<span class="normal">2907</span>
<span class="normal">2908</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_upstream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Residue</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the Residues upstream of (n-terminal to) the current Residue</span>

<span class="sd">    Args:</span>
<span class="sd">        number: The number of residues to retrieve. If not provided gets all</span>

<span class="sd">    Returns:</span>
<span class="sd">        The Residue instances in n- to c-terminal order</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">number</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">number</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
    <span class="k">elif</span> <span class="n">number</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t get 0 upstream residues. 1 or more must be specified&quot;</span><span class="p">)</span>

    <span class="n">last_prev_residue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">prev_residue</span>
    <span class="n">prev_residues</span> <span class="o">=</span> <span class="p">[</span><span class="n">last_prev_residue</span><span class="p">]</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">number</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">prev_residue</span> <span class="o">=</span> <span class="n">last_prev_residue</span><span class="o">.</span><span class="n">prev_residue</span>
            <span class="n">prev_residues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prev_residue</span><span class="p">)</span>
            <span class="n">last_prev_residue</span> <span class="o">=</span> <span class="n">prev_residue</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># Hit a termini, where prev_residue is None</span>
        <span class="c1"># logger.debug(f&#39;Stopped at {idx=} with {repr(prev_residues)}. Popping the last&#39;)</span>
        <span class="n">prev_residues</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># For the edge case where the last added residue is a termini, strip from results</span>
        <span class="k">if</span> <span class="n">last_prev_residue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">prev_residues</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">prev_residues</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Residue.get_downstream" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_downstream</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_downstream</span><span class="p">(</span><span class="n">number</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Get the Residues downstream of (c-terminal to) the current Residue</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>number</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The number of residues to retrieve. If not provided gets all</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>
        
        <div class="doc-md-description">
          <p>The Residue instances in n- to c-terminal order</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2910</span>
<span class="normal">2911</span>
<span class="normal">2912</span>
<span class="normal">2913</span>
<span class="normal">2914</span>
<span class="normal">2915</span>
<span class="normal">2916</span>
<span class="normal">2917</span>
<span class="normal">2918</span>
<span class="normal">2919</span>
<span class="normal">2920</span>
<span class="normal">2921</span>
<span class="normal">2922</span>
<span class="normal">2923</span>
<span class="normal">2924</span>
<span class="normal">2925</span>
<span class="normal">2926</span>
<span class="normal">2927</span>
<span class="normal">2928</span>
<span class="normal">2929</span>
<span class="normal">2930</span>
<span class="normal">2931</span>
<span class="normal">2932</span>
<span class="normal">2933</span>
<span class="normal">2934</span>
<span class="normal">2935</span>
<span class="normal">2936</span>
<span class="normal">2937</span>
<span class="normal">2938</span>
<span class="normal">2939</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_downstream</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Residue</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the Residues downstream of (c-terminal to) the current Residue</span>

<span class="sd">    Args:</span>
<span class="sd">        number: The number of residues to retrieve. If not provided gets all</span>

<span class="sd">    Returns:</span>
<span class="sd">        The Residue instances in n- to c-terminal order</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">number</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">number</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">maxsize</span>
    <span class="k">elif</span> <span class="n">number</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t get 0 downstream residues. 1 or more must be specified&quot;</span><span class="p">)</span>

    <span class="n">last_next_residue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">next_residue</span>
    <span class="n">next_residues</span> <span class="o">=</span> <span class="p">[</span><span class="n">last_next_residue</span><span class="p">]</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">number</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">next_residue</span> <span class="o">=</span> <span class="n">last_next_residue</span><span class="o">.</span><span class="n">next_residue</span>
            <span class="n">next_residues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">next_residue</span><span class="p">)</span>
            <span class="n">last_next_residue</span> <span class="o">=</span> <span class="n">next_residue</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># Hit a termini, where next_residue is None</span>
        <span class="c1"># logger.debug(f&#39;Stopped at {idx=} with {repr(next_residues)}. Popping the last&#39;)</span>
        <span class="n">next_residues</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># For the edge case where the last added residue is a termini, strip from results</span>
        <span class="k">if</span> <span class="n">last_next_residue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">next_residues</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">next_residues</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Residue.get_neighbors" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_neighbors</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_neighbors</span><span class="p">(</span><span class="n">distance</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="mf">8.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>If this Residue instance is part of a polymer, find neighboring Residue instances defined by a distance</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>distance</code></b>
            (<code>float</code>, default:
                <code>8.0</code>
)
        
        <div class="doc-md-description">
          <p>The distance to measure neighbors by</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>
        
        <div class="doc-md-description">
          <p>The Residue instances that are within the distance to this Residue</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">2941</span>
<span class="normal">2942</span>
<span class="normal">2943</span>
<span class="normal">2944</span>
<span class="normal">2945</span>
<span class="normal">2946</span>
<span class="normal">2947</span>
<span class="normal">2948</span>
<span class="normal">2949</span>
<span class="normal">2950</span>
<span class="normal">2951</span>
<span class="normal">2952</span>
<span class="normal">2953</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_neighbors</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">8.</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Residue</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;If this Residue instance is part of a polymer, find neighboring Residue instances defined by a distance</span>

<span class="sd">    Args:</span>
<span class="sd">        distance: The distance to measure neighbors by</span>

<span class="sd">    Returns:</span>
<span class="sd">        The Residue instances that are within the distance to this Residue</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">get_residues_by_atom_indices</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">neighboring_atom_indices</span><span class="p">(</span><span class="n">distance</span><span class="o">=</span><span class="n">distance</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># This Residue is the parent</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Residue.mutation_possibilities_from_directive" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">mutation_possibilities_from_directive</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">mutation_possibilities_from_directive</span><span class="p">(</span><span class="n">directive</span><span class="p">:</span> <span class="n"><span title="structure.base.directives">directives</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">background</span><span class="p">:</span> <span class="n">set</span><span class="p">[</span><span class="n">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">special</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">set</span><span class="p">[</span><span class="n"><span title="symdesign.sequence.protein_letters3_alph1_literal">protein_letters3_alph1_literal</span></span><span class="p">]</span> <span class="o">|</span> <span class="n">set</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Select mutational possibilities for each Residue based on the Residue and a directive</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>directive</code></b>
            (<code><span title="structure.base.directives">directives</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>Where the choice is one of 'special', 'same', 'different', 'charged', 'polar', 'apolar',
'hydrophobic', 'aromatic', 'hbonding', 'branched'</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>background</code></b>
            (<code>set[str]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The background amino acids to compare possibilities against</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>special</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        
        <div class="doc-md-description">
          <p>Whether to include special residues</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>set[<span title="symdesign.sequence.protein_letters3_alph1_literal">protein_letters3_alph1_literal</span>] | set</code>
        
        <div class="doc-md-description">
          <p>The possible amino acid types available given the mutational directive</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3147</span>
<span class="normal">3148</span>
<span class="normal">3149</span>
<span class="normal">3150</span>
<span class="normal">3151</span>
<span class="normal">3152</span>
<span class="normal">3153</span>
<span class="normal">3154</span>
<span class="normal">3155</span>
<span class="normal">3156</span>
<span class="normal">3157</span>
<span class="normal">3158</span>
<span class="normal">3159</span>
<span class="normal">3160</span>
<span class="normal">3161</span>
<span class="normal">3162</span>
<span class="normal">3163</span>
<span class="normal">3164</span>
<span class="normal">3165</span>
<span class="normal">3166</span>
<span class="normal">3167</span>
<span class="normal">3168</span>
<span class="normal">3169</span>
<span class="normal">3170</span>
<span class="normal">3171</span>
<span class="normal">3172</span>
<span class="normal">3173</span>
<span class="normal">3174</span>
<span class="normal">3175</span>
<span class="normal">3176</span>
<span class="normal">3177</span>
<span class="normal">3178</span>
<span class="normal">3179</span>
<span class="normal">3180</span>
<span class="normal">3181</span>
<span class="normal">3182</span>
<span class="normal">3183</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">mutation_possibilities_from_directive</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">directive</span><span class="p">:</span> <span class="n">directives</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">background</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">special</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="n">protein_letters3_alph1_literal</span><span class="p">]</span> <span class="o">|</span> <span class="nb">set</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Select mutational possibilities for each Residue based on the Residue and a directive</span>

<span class="sd">    Args:</span>
<span class="sd">        directive: Where the choice is one of &#39;special&#39;, &#39;same&#39;, &#39;different&#39;, &#39;charged&#39;, &#39;polar&#39;, &#39;apolar&#39;,</span>
<span class="sd">            &#39;hydrophobic&#39;, &#39;aromatic&#39;, &#39;hbonding&#39;, &#39;branched&#39;</span>
<span class="sd">        background: The background amino acids to compare possibilities against</span>
<span class="sd">        special: Whether to include special residues</span>

<span class="sd">    Returns:</span>
<span class="sd">        The possible amino acid types available given the mutational directive</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">directive</span> <span class="ow">or</span> <span class="n">directive</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">mutation_directives</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mutation_possibilities_from_directive</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">: The mutation directive </span><span class="si">{</span><span class="n">directive</span><span class="si">}</span><span class="s1"> &#39;</span>
                       <span class="sa">f</span><span class="s1">&#39;is not a valid directive yet. Possible directives are: </span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">mutation_directives</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">set</span><span class="p">()</span>
        <span class="c1"># raise TypeError(&#39;%s: The mutation directive %s is not a valid directive yet. Possible directives are: %s&#39;</span>
        <span class="c1">#                 % (self.mutation_possibilities_from_directive.__name__, directive,</span>
        <span class="c1">#                    &#39;, &#39;.join(mutation_directives)))</span>

    <span class="n">current_properties</span> <span class="o">=</span> <span class="n">residue_properties</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">directive</span> <span class="o">==</span> <span class="s1">&#39;same&#39;</span><span class="p">:</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="n">current_properties</span>
    <span class="k">elif</span> <span class="n">directive</span> <span class="o">==</span> <span class="s1">&#39;different&#39;</span><span class="p">:</span>  <span class="c1"># hmm not right -&gt; .difference({hbonding, branched}) &lt;- for ex. polar if apolar</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">aa_by_property</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">current_properties</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">properties</span> <span class="o">=</span> <span class="p">[</span><span class="n">directive</span><span class="p">]</span>
    <span class="n">available_aas</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">aa</span> <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">properties</span> <span class="k">for</span> <span class="n">aa</span> <span class="ow">in</span> <span class="n">aa_by_property</span><span class="p">[</span><span class="n">prop</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">directive</span> <span class="o">!=</span> <span class="s1">&#39;special&#39;</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">special</span><span class="p">:</span>
        <span class="n">available_aas</span> <span class="o">=</span> <span class="n">available_aas</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">aa_by_property</span><span class="p">[</span><span class="s1">&#39;special&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">background</span><span class="p">:</span>
        <span class="n">available_aas</span> <span class="o">=</span> <span class="n">background</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">available_aas</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">available_aas</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Residue.distance" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">distance</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">distance</span><span class="p">(</span><span class="n">other</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="s1">&#39;ca&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the distance from this Residue to another specified by atom type "dtype"</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>other</code></b>
            (<code><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></code>)
        
        <div class="doc-md-description">
          <p>The other Residue to measure against</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>dtype</code></b>
            (<code>str</code>, default:
                <code>&#39;ca&#39;</code>
)
        
        <div class="doc-md-description">
          <p>The Atom type to perform the measurement with</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>float</code>
        
        <div class="doc-md-description">
          <p>The Euclidean distance between the specified Atom type</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3185</span>
<span class="normal">3186</span>
<span class="normal">3187</span>
<span class="normal">3188</span>
<span class="normal">3189</span>
<span class="normal">3190</span>
<span class="normal">3191</span>
<span class="normal">3192</span>
<span class="normal">3193</span>
<span class="normal">3194</span>
<span class="normal">3195</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">Residue</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;ca&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the distance from this Residue to another specified by atom type &quot;dtype&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        other: The other Residue to measure against</span>
<span class="sd">        dtype: The Atom type to perform the measurement with</span>

<span class="sd">    Returns:</span>
<span class="sd">        The Euclidean distance between the specified Atom type</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;.</span><span class="si">{</span><span class="n">dtype</span><span class="si">}</span><span class="s1">_coords&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;.</span><span class="si">{</span><span class="n">dtype</span><span class="si">}</span><span class="s1">_coords&#39;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Residue.get_atom_record" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_atom_record</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_atom_record</span><span class="p">(</span><span class="n">chain_id</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">atom_offset</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">str</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Provide the Structure Atoms as a PDB file string</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>chain_id</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The chain ID to use</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>atom_offset</code></b>
            (<code>int</code>, default:
                <code>0</code>
)
        
        <div class="doc-md-description">
          <p>How much to offset the atom number by. Default returns one-indexed</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>str</code>
        
        <div class="doc-md-description">
          <p>The archived .pdb formatted ATOM records for the Structure</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3224</span>
<span class="normal">3225</span>
<span class="normal">3226</span>
<span class="normal">3227</span>
<span class="normal">3228</span>
<span class="normal">3229</span>
<span class="normal">3230</span>
<span class="normal">3231</span>
<span class="normal">3232</span>
<span class="normal">3233</span>
<span class="normal">3234</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_atom_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">atom_offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provide the Structure Atoms as a PDB file string</span>

<span class="sd">    Args:</span>
<span class="sd">        chain_id: The chain ID to use</span>
<span class="sd">        atom_offset: How much to offset the atom number by. Default returns one-indexed</span>

<span class="sd">    Returns:</span>
<span class="sd">        The archived .pdb formatted ATOM records for the Structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(</span><span class="n">chain_id</span><span class="o">=</span><span class="n">chain_id</span><span class="p">,</span><span class="w"> </span><span class="n">atom_offset</span><span class="o">=</span><span class="n">atom_offset</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Residue.__str__" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">__str__</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="fm">__str__</span><span class="p">(</span><span class="n">chain_id</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">atom_offset</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">str</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Format the Residue into the contained Atoms. The Atom number is truncated at 5 digits for PDB compliant
formatting</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>chain_id</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The chain ID to use</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>atom_offset</code></b>
            (<code>int</code>, default:
                <code>0</code>
)
        
        <div class="doc-md-description">
          <p>How much to offset the atom number by. Default returns one-indexed</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>str</code>
        
        <div class="doc-md-description">
          <p>The archived .pdb formatted ATOM records for the Residue</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3236</span>
<span class="normal">3237</span>
<span class="normal">3238</span>
<span class="normal">3239</span>
<span class="normal">3240</span>
<span class="normal">3241</span>
<span class="normal">3242</span>
<span class="normal">3243</span>
<span class="normal">3244</span>
<span class="normal">3245</span>
<span class="normal">3246</span>
<span class="normal">3247</span>
<span class="normal">3248</span>
<span class="normal">3249</span>
<span class="normal">3250</span>
<span class="normal">3251</span>
<span class="normal">3252</span>
<span class="normal">3253</span>
<span class="normal">3254</span>
<span class="normal">3255</span>
<span class="normal">3256</span>
<span class="normal">3257</span>
<span class="normal">3258</span>
<span class="normal">3259</span>
<span class="normal">3260</span>
<span class="normal">3261</span>
<span class="normal">3262</span>
<span class="normal">3263</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">atom_offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="c1">#         type=None, number=None</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Format the Residue into the contained Atoms. The Atom number is truncated at 5 digits for PDB compliant</span>
<span class="sd">    formatting</span>

<span class="sd">    Args:</span>
<span class="sd">        chain_id: The chain ID to use</span>
<span class="sd">        atom_offset: How much to offset the atom number by. Default returns one-indexed</span>

<span class="sd">    Returns:</span>
<span class="sd">        The archived .pdb formatted ATOM records for the Residue</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1">#     pdb: Whether the Residue representation should use the number at file parsing</span>
    <span class="c1"># format the string returned from each Atom, such as</span>
    <span class="c1">#  &#39;ATOM  %s  CG2 %s %s%s    %s  1.00 17.48           C  0&#39;</span>
    <span class="c1">#       AtomIdx  TypeChNumberCoords</span>
    <span class="c1"># To</span>
    <span class="c1">#  &#39;ATOM     32  CG2 VAL A 132       9.902  -5.550   0.695  1.00 17.48           C  0&#39;</span>
    <span class="c1"># self.type, self.alt_location, self.code_for_insertion, self.occupancy, self.b_factor,</span>
    <span class="c1">#                     self.element, self.charge)</span>
    <span class="c1"># res_str = self.residue_string(**kwargs)</span>
    <span class="n">res_str</span> <span class="o">=</span> <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="s1">&#39;3s&#39;</span><span class="p">),</span> <span class="nb">format</span><span class="p">(</span><span class="n">chain_id</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">,</span> <span class="s1">&#39;&gt;2s&#39;</span><span class="p">),</span> <span class="nb">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="s1">&#39;4d&#39;</span><span class="p">)</span>
    <span class="c1"># Add 1 to make index one-indexed</span>
    <span class="n">offset</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">atom_offset</span>
    <span class="c1"># Limit atom_index with atom_index_slice to keep ATOM record correct length v</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">atom</span><span class="o">.</span><span class="fm">__str__</span><span class="p">()</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">atom_idx</span> <span class="o">+</span> <span class="n">offset</span><span class="p">,</span> <span class="s1">&#39;5d&#39;</span><span class="p">)[</span><span class="n">atom_index_slice</span><span class="p">],</span>
                                           <span class="o">*</span><span class="n">res_str</span><span class="p">,</span> <span class="s1">&#39;</span><span class="si">{:8.3f}{:8.3f}{:8.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">coord</span><span class="p">))</span>
                     <span class="k">for</span> <span class="n">atom</span><span class="p">,</span> <span class="n">atom_idx</span><span class="p">,</span> <span class="n">coord</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_indices</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="o">.</span><span class="n">tolist</span><span class="p">()))</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="structure.base.Residues" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Residues</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">Residues</span><span class="p">(</span><span class="n">structs</span><span class="p">:</span> <span class="n"><span title="collections.abc.Sequence">Sequence</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.StructureBase" href="#structure.base.StructureBase">StructureBase</a></span><span class="p">]</span> <span class="o">|</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="structure.base.StructureBaseContainer" href="#structure.base.StructureBaseContainer">StructureBaseContainer</a></code></p>

  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>structs</code></b>
            (<code><span title="collections.abc.Sequence">Sequence</span>[<a class="autorefs autorefs-internal" title="structure.base.StructureBase" href="#structure.base.StructureBase">StructureBase</a>] | <span title="numpy.ndarray">ndarray</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The StructureBase instances to store. Should be a homogeneous Sequence</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>symdesign/structure/base.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structs</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="n">StructureBase</span><span class="p">]</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the instance</span>

<span class="sd">    Args:</span>
<span class="sd">        structs: The StructureBase instances to store. Should be a homogeneous Sequence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">structs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">structs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">structs</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
        <span class="n">structs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">structs</span><span class="p">)</span>
        <span class="c1"># raise TypeError(</span>
        <span class="c1">#     f&quot;Can&#39;t initialize {self.__class__.__name__} with {type(structs).__name__}. Type must be a &quot;</span>
        <span class="c1">#     f&#39;numpy.ndarray or list[{StructureBase.__name__}]&#39;)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">structs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">structs</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">object_</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="structure.base.Residues.reindex" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">reindex</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">reindex</span><span class="p">(</span><span class="n">start_at</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Index the Residue instances and their corresponding Atom/Coords indices according to their position</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>start_at</code></b>
            (<code>int</code>, default:
                <code>0</code>
)
        
        <div class="doc-md-description">
          <p>The index to start reindexing at. Must be [0, 'inf']</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3287</span>
<span class="normal">3288</span>
<span class="normal">3289</span>
<span class="normal">3290</span>
<span class="normal">3291</span>
<span class="normal">3292</span>
<span class="normal">3293</span>
<span class="normal">3294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reindex</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_at</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Index the Residue instances and their corresponding Atom/Coords indices according to their position</span>

<span class="sd">    Args:</span>
<span class="sd">        start_at: The index to start reindexing at. Must be [0, &#39;inf&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">start_at</span><span class="o">=</span><span class="n">start_at</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reindex_atoms</span><span class="p">(</span><span class="n">start_at</span><span class="o">=</span><span class="n">start_at</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Residues.set_index" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">set_index</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">set_index</span><span class="p">(</span><span class="n">start_at</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Index the Residue instances according to their position in the Residues container</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>start_at</code></b>
            (<code>int</code>, default:
                <code>0</code>
)
        
        <div class="doc-md-description">
          <p>The Residue index to start reindexing at</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3296</span>
<span class="normal">3297</span>
<span class="normal">3298</span>
<span class="normal">3299</span>
<span class="normal">3300</span>
<span class="normal">3301</span>
<span class="normal">3302</span>
<span class="normal">3303</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_at</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Index the Residue instances according to their position in the Residues container</span>

<span class="sd">    Args:</span>
<span class="sd">        start_at: The Residue index to start reindexing at</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">struct</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">structs</span><span class="p">[</span><span class="n">start_at</span><span class="p">:]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">start_at</span><span class="p">):</span>
        <span class="n">struct</span><span class="o">.</span><span class="n">_index</span> <span class="o">=</span> <span class="n">idx</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.Residues.reindex_atoms" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">reindex_atoms</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">reindex_atoms</span><span class="p">(</span><span class="n">start_at</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Index the Residue instances Atoms/Coords indices according to incremental Atoms/Coords index. Responsible
for updating member Atom.index attributes as well</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>start_at</code></b>
            (<code>int</code>, default:
                <code>0</code>
)
        
        <div class="doc-md-description">
          <p>The index to start reindexing at. Must be [0, 'inf']</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3305</span>
<span class="normal">3306</span>
<span class="normal">3307</span>
<span class="normal">3308</span>
<span class="normal">3309</span>
<span class="normal">3310</span>
<span class="normal">3311</span>
<span class="normal">3312</span>
<span class="normal">3313</span>
<span class="normal">3314</span>
<span class="normal">3315</span>
<span class="normal">3316</span>
<span class="normal">3317</span>
<span class="normal">3318</span>
<span class="normal">3319</span>
<span class="normal">3320</span>
<span class="normal">3321</span>
<span class="normal">3322</span>
<span class="normal">3323</span>
<span class="normal">3324</span>
<span class="normal">3325</span>
<span class="normal">3326</span>
<span class="normal">3327</span>
<span class="normal">3328</span>
<span class="normal">3329</span>
<span class="normal">3330</span>
<span class="normal">3331</span>
<span class="normal">3332</span>
<span class="normal">3333</span>
<span class="normal">3334</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">reindex_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_at</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Index the Residue instances Atoms/Coords indices according to incremental Atoms/Coords index. Responsible</span>
<span class="sd">    for updating member Atom.index attributes as well</span>

<span class="sd">    Args:</span>
<span class="sd">        start_at: The index to start reindexing at. Must be [0, &#39;inf&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">start_at</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">_start_at</span> <span class="o">=</span> <span class="n">start_at</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_start_at</span> <span class="o">=</span> <span class="n">start_at</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">start_at</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">_start_at</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="n">struct</span><span class="p">:</span> <span class="n">Residue</span>
    <span class="n">prior_struct</span><span class="p">:</span> <span class="n">Residue</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># prior_struct, *other_structs = self.structs[start_at - 1:]</span>
        <span class="n">prior_struct</span><span class="p">,</span> <span class="o">*</span><span class="n">other_structs</span> <span class="o">=</span> <span class="bp">self</span><span class="p">[</span><span class="n">_start_at</span><span class="p">:]</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># Not enough values to unpack as the index didn&#39;t slice anything</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">reindex_atoms</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">start_at</span><span class="si">=}</span><span class="s1"> is outside of the allowed </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;indices with size </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">start_at</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">prior_struct</span><span class="o">.</span><span class="n">start_index</span> <span class="o">=</span> <span class="n">start_at</span>

        <span class="k">for</span> <span class="n">struct</span> <span class="ow">in</span> <span class="n">other_structs</span><span class="p">:</span>
            <span class="n">struct</span><span class="o">.</span><span class="n">start_index</span> <span class="o">=</span> <span class="n">prior_struct</span><span class="o">.</span><span class="n">end_index</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">prior_struct</span> <span class="o">=</span> <span class="n">struct</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="structure.base.StructureIndexMixin" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">StructureIndexMixin</span>


</h2>


  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><span title="abc.ABC">ABC</span></code></p>

  
      


  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">



<h3 id="structure.base.StructureIndexMixin.is_parent" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">is_parent</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">is_parent</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3355</span>
<span class="normal">3356</span>
<span class="normal">3357</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<span class="k">def</span> <span class="nf">is_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;&quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="structure.base.ContainsResidues" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">ContainsResidues</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ContainsResidues</span><span class="p">(</span><span class="n">structure</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.ContainsResidues" href="#structure.base.ContainsResidues">ContainsResidues</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">residues</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residues" href="#structure.base.Residues">Residues</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">residue_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">pose_format</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fragment_db</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.fragment.db.FragmentDatabase" href="../fragment/db/#structure.fragment.db.FragmentDatabase">FragmentDatabase</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="structure.base.ContainsAtoms" href="#structure.base.ContainsAtoms">ContainsAtoms</a></code>, <code><a class="autorefs autorefs-internal" title="structure.base.StructureIndexMixin" href="#structure.base.StructureIndexMixin">StructureIndexMixin</a></code></p>

  
      <p>Structure object handles Atom/Residue/Coords manipulation of all Structure containers.
Must pass parent and residue_indices, atoms and coords, or residues to initialize</p>
<p>Polymer/Chain designation. This designation essentially means it contains Residue instances in a Residues object</p>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>structure</code></b>
            (<code><a class="autorefs autorefs-internal" title="structure.base.ContainsResidues" href="#structure.base.ContainsResidues">ContainsResidues</a></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>Create the instance based on an existing Structure instance</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>residues</code></b>
            (<code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>] | <a class="autorefs autorefs-internal" title="structure.base.Residues" href="#structure.base.Residues">Residues</a></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The Residue instances which should constitute a new Structure instance</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>residue_indices</code></b>
            (<code>list[int]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The indices which specify the particular Residue instances to make this Structure instance.
Used with a parent to specify a subdivision of a larger Structure</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>pose_format</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        
        <div class="doc-md-description">
          <p>Whether to initialize with continuous Residue numbering from 1 to N</p>
        </div>
      </li>
  </ul>



  <p>Other Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>atoms</code></b>
        
        <div class="doc-md-description">
          <p>list[Atom] | Atoms = None - The Atom instances which should constitute a new Structure instance</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>parent</code></b>
        
        <div class="doc-md-description">
          <p>StructureBase = None - If another Structure object created this Structure instance, pass the
'parent' instance. Will take ownership over Structure containers (coords, atoms, residues) for
dependent Structures</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>log</code></b>
        
        <div class="doc-md-description">
          <p>Log | Logger | bool = True - The Log or Logger instance, or the name for the logger to handle parent
Structure logging. None or False prevents logging while any True assignment enables it</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>coords</code></b>
        
        <div class="doc-md-description">
          <p>Coords | np.ndarray | list[list[float]] = None - When setting up a parent Structure instance, the
coordinates of that Structure</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>name</code></b>
        
        <div class="doc-md-description">
          <p>str = None - The identifier for the Structure instance</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>symdesign/structure/base.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3503</span>
<span class="normal">3504</span>
<span class="normal">3505</span>
<span class="normal">3506</span>
<span class="normal">3507</span>
<span class="normal">3508</span>
<span class="normal">3509</span>
<span class="normal">3510</span>
<span class="normal">3511</span>
<span class="normal">3512</span>
<span class="normal">3513</span>
<span class="normal">3514</span>
<span class="normal">3515</span>
<span class="normal">3516</span>
<span class="normal">3517</span>
<span class="normal">3518</span>
<span class="normal">3519</span>
<span class="normal">3520</span>
<span class="normal">3521</span>
<span class="normal">3522</span>
<span class="normal">3523</span>
<span class="normal">3524</span>
<span class="normal">3525</span>
<span class="normal">3526</span>
<span class="normal">3527</span>
<span class="normal">3528</span>
<span class="normal">3529</span>
<span class="normal">3530</span>
<span class="normal">3531</span>
<span class="normal">3532</span>
<span class="normal">3533</span>
<span class="normal">3534</span>
<span class="normal">3535</span>
<span class="normal">3536</span>
<span class="normal">3537</span>
<span class="normal">3538</span>
<span class="normal">3539</span>
<span class="normal">3540</span>
<span class="normal">3541</span>
<span class="normal">3542</span>
<span class="normal">3543</span>
<span class="normal">3544</span>
<span class="normal">3545</span>
<span class="normal">3546</span>
<span class="normal">3547</span>
<span class="normal">3548</span>
<span class="normal">3549</span>
<span class="normal">3550</span>
<span class="normal">3551</span>
<span class="normal">3552</span>
<span class="normal">3553</span>
<span class="normal">3554</span>
<span class="normal">3555</span>
<span class="normal">3556</span>
<span class="normal">3557</span>
<span class="normal">3558</span>
<span class="normal">3559</span>
<span class="normal">3560</span>
<span class="normal">3561</span>
<span class="normal">3562</span>
<span class="normal">3563</span>
<span class="normal">3564</span>
<span class="normal">3565</span>
<span class="normal">3566</span>
<span class="normal">3567</span>
<span class="normal">3568</span>
<span class="normal">3569</span>
<span class="normal">3570</span>
<span class="normal">3571</span>
<span class="normal">3572</span>
<span class="normal">3573</span>
<span class="normal">3574</span>
<span class="normal">3575</span>
<span class="normal">3576</span>
<span class="normal">3577</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structure</span><span class="p">:</span> <span class="n">ContainsResidues</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">residues</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Residue</span><span class="p">]</span> <span class="o">|</span> <span class="n">Residues</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">residue_indices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">pose_format</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">fragment_db</span><span class="p">:</span> <span class="n">fragment</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">FragmentDatabase</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Construct the instance</span>

<span class="sd">    Args:</span>
<span class="sd">        structure: Create the instance based on an existing Structure instance</span>
<span class="sd">        residues: The Residue instances which should constitute a new Structure instance</span>
<span class="sd">        residue_indices: The indices which specify the particular Residue instances to make this Structure instance.</span>
<span class="sd">            Used with a parent to specify a subdivision of a larger Structure</span>
<span class="sd">        pose_format: Whether to initialize with continuous Residue numbering from 1 to N</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        atoms: list[Atom] | Atoms = None - The Atom instances which should constitute a new Structure instance</span>
<span class="sd">        parent: StructureBase = None - If another Structure object created this Structure instance, pass the</span>
<span class="sd">            &#39;parent&#39; instance. Will take ownership over Structure containers (coords, atoms, residues) for</span>
<span class="sd">            dependent Structures</span>
<span class="sd">        log: Log | Logger | bool = True - The Log or Logger instance, or the name for the logger to handle parent</span>
<span class="sd">            Structure logging. None or False prevents logging while any True assignment enables it</span>
<span class="sd">        coords: Coords | np.ndarray | list[list[float]] = None - When setting up a parent Structure instance, the</span>
<span class="sd">            coordinates of that Structure</span>
<span class="sd">        name: str = None - The identifier for the Structure instance</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">structure</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">ContainsResidues</span><span class="p">):</span>
            <span class="n">model_kwargs</span> <span class="o">=</span> <span class="n">structure</span><span class="o">.</span><span class="n">get_base_containers</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">model_kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="n">logger</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Passing an argument for &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; while providing the &#39;model&#39; argument &quot;</span>
                                   <span class="sa">f</span><span class="s2">&quot;overwrites the &#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">&#39; argument from the &#39;model&#39;&quot;</span><span class="p">)</span>
            <span class="n">new_model_kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="n">model_kwargs</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">}</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">new_model_kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Setting </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> with model=</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> isn&#39;t supported&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># ContainsResidues</span>

    <span class="c1"># self._coords_indexed_residues_ = None</span>
    <span class="c1"># self._residue_indices = None</span>
    <span class="c1"># self.secondary_structure = None</span>
    <span class="c1"># self.nucleotides_present = False</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_fragment_db</span> <span class="o">=</span> <span class="n">fragment_db</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sasa</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ss_sequence_indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ss_type_sequence</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dependent</span><span class="p">():</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">residue_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Structures</span><span class="p">):</span>  <span class="c1"># Structures handles this itself</span>
                <span class="k">return</span>
            <span class="k">raise</span> <span class="n">stutils</span><span class="o">.</span><span class="n">ConstructionError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> wasn&#39;t passed &#39;residue_indices&#39; which are required for &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;initialization&quot;</span>
            <span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">residue_indices</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">residue_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">residue_indices</span><span class="p">)</span>
        <span class="c1"># Must set this before setting _atom_indices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_residue_indices</span> <span class="o">=</span> <span class="n">residue_indices</span>
        <span class="c1"># Get the atom_indices from the provided residues</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">residue</span><span class="o">.</span><span class="n">atom_indices</span><span class="p">]</span>
    <span class="c1"># Setting up a parent Structure</span>
    <span class="k">elif</span> <span class="n">residues</span><span class="p">:</span>  <span class="c1"># Assume the passed residues aren&#39;t bound to an existing Structure</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_assign_residues</span><span class="p">(</span><span class="n">residues</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
        <span class="c1"># Assume ContainsAtoms initialized .atoms. Make Residue instances, Residues</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_create_residues</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Set up an empty Structure or let subclass handle population</span>
        <span class="k">return</span>

    <span class="k">if</span> <span class="n">pose_format</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pose_numbering</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.ss_sequence_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">ss_sequence_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ss_sequence_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Index which indicates the Residue membership to the secondary structure type element sequence</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.ss_type_sequence" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">ss_type_sequence</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ss_type_sequence</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The ordered secondary structure type sequence which contains one character/secondary structure element</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.fragment_db" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">fragment_db</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">fragment_db</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.fragment.db.FragmentDatabase" href="../fragment/db/#structure.fragment.db.FragmentDatabase">FragmentDatabase</a></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The FragmentDatabase used to create Fragment instances</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.sequence" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">sequence</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">sequence</span><span class="p">:</span> <span class="n">str</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Holds the Structure amino acid sequence</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.residue_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">residue_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">residue_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the residue indices which belong to the Structure</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.residues" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">residues</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">residues</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the Residue instances in the Structure</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.alphafold_atom_mask" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">alphafold_atom_mask</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">alphafold_atom_mask</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return an Alphafold mask describing which Atom positions have Coord data</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.alphafold_coords" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">alphafold_coords</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">alphafold_coords</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return a view of the Coords from the StructureBase in Alphafold coordinate format</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.coords_indexed_residues" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">coords_indexed_residues</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">coords_indexed_residues</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the Residue associated with each Coord in the Structure</p>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>
        
        <div class="doc-md-description">
          <p>Each Residue which owns the corresponding index in the .atoms/.coords attribute</p>
      </div>
      </li>
  </ul>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.backbone_coords_indexed_residues" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">backbone_coords_indexed_residues</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">backbone_coords_indexed_residues</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the Residue associated with each backbone Atom/Coord in the Structure</p>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>
        
        <div class="doc-md-description">
          <p>Each Residue which owns the corresponding index in the .atoms/.coords attribute</p>
      </div>
      </li>
  </ul>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.backbone_and_cb_coords_indexed_residues" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">backbone_and_cb_coords_indexed_residues</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">backbone_and_cb_coords_indexed_residues</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the Residue associated with each backbone and CB Atom/Coord in the Structure</p>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>
        
        <div class="doc-md-description">
          <p>Each Residue which owns the corresponding index in the .atoms/.coords attribute</p>
      </div>
      </li>
  </ul>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.heavy_coords_indexed_residues" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">heavy_coords_indexed_residues</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">heavy_coords_indexed_residues</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the Residue associated with each heavy Atom/Coord in the Structure</p>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>
        
        <div class="doc-md-description">
          <p>Each Residue which owns the corresponding index in the .atoms/.coords attribute</p>
      </div>
      </li>
  </ul>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.side_chain_coords_indexed_residues" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">side_chain_coords_indexed_residues</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">side_chain_coords_indexed_residues</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the Residue associated with each side chain Atom/Coord in the Structure</p>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>
        
        <div class="doc-md-description">
          <p>Each Residue which owns the corresponding index in the .atoms/.coords attribute</p>
      </div>
      </li>
  </ul>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.number_of_residues" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">number_of_residues</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">number_of_residues</span><span class="p">:</span> <span class="n">int</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Access the number of Residues in the Structure</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.backbone_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">backbone_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">backbone_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The indices that index the Structure backbone Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.backbone_and_cb_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">backbone_and_cb_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">backbone_and_cb_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The indices that index the Structure backbone and CB Atoms. Inherently gets CA of Residue instances missing
CB</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.cb_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">cb_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">cb_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The indices that index the Structure CB Atoms. Inherently gets CA of Residue instances missing CB</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.ca_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">ca_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">ca_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The indices that index the Structure CA Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.heavy_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">heavy_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">heavy_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The indices that index the Structure heavy Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.side_chain_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">side_chain_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">side_chain_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The indices that index the Structure side chain Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.helix_cb_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">helix_cb_indices</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">helix_cb_indices</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The indices that index the Structure helical CB Atoms/Coords</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.n_terminal_residue" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">n_terminal_residue</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">n_terminal_residue</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Retrieve the Residue from the n-termini</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.c_terminal_residue" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">c_terminal_residue</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">c_terminal_residue</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Retrieve the Residue from the c-termini</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.relative_sasa" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">relative_sasa</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">relative_sasa</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return a per-residue array of the relative solvent accessible area for the Structure</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.sasa_apolar" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">sasa_apolar</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">sasa_apolar</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return a per-residue array of the polar (hydrophilic) solvent accessible area for the Structure</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.sasa_polar" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">sasa_polar</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">sasa_polar</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return a per-residue array of the apolar (hydrophobic) solvent accessible area for the Structure</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.surface_residues" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">surface_residues</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">surface_residues</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Get the Residue instances that reside on the surface of the molecule</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>relative_sasa_thresh</code></b>
        
        <div class="doc-md-description">
          <p>The relative area threshold that the Residue should have before it is considered
'surface'. Default cutoff is based on Levy, E. 2010</p>
        </div>
      </li>
  </ul>



  <p>Other Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>atom</code></b>
        
        <div class="doc-md-description">
          <p>bool = True - Whether the output should be generated for each atom.
If False, will be generated for each Residue</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>probe_radius</code></b>
        
        <div class="doc-md-description">
          <p>float = 1.4 - The radius which surface area should be generated</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>
        
        <div class="doc-md-description">
          <p>The surface Residue instances</p>
      </div>
      </li>
  </ul>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.interior_residues" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">interior_residues</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">interior_residues</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Get the Residue instances that reside in the interior of the molecule</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>relative_sasa_thresh</code></b>
        
        <div class="doc-md-description">
          <p>The relative area threshold that the Residue should fall below before it is considered
'interior'. Default cutoff is based on Levy, E. 2010</p>
        </div>
      </li>
  </ul>



  <p>Other Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>atom</code></b>
        
        <div class="doc-md-description">
          <p>bool = True - Whether the output should be generated for each atom.
If False, will be generated for each Residue</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>probe_radius</code></b>
        
        <div class="doc-md-description">
          <p>float = 1.4 - The radius which surface area should be generated</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>
        
        <div class="doc-md-description">
          <p>The interior Residue instances</p>
      </div>
      </li>
  </ul>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.secondary_structure" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">secondary_structure</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">secondary_structure</span><span class="p">:</span> <span class="n">str</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The Structure secondary structure assignment as provided by the DEFAULT_SS_PROGRAM</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.spatial_aggregation_propensity" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">spatial_aggregation_propensity</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">spatial_aggregation_propensity</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the spatial aggregation propensity on a per-residue basis</p>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        
        <div class="doc-md-description">
          <p>The array of floats representing the spatial aggregation propensity for each Residue in the Structure</p>
      </div>
      </li>
  </ul>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.ContainsResidues.contact_order" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">contact_order</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
      <small class="doc doc-label doc-label-writable"><code>writable</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">contact_order</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the contact order on a per-Residue basis</p>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        
        <div class="doc-md-description">
          <p>The array of floats representing the contact order for each Residue in the Structure</p>
      </div>
      </li>
  </ul>
  </div>

</div>




<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.from_residues" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">from_residues</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">from_residues</span><span class="p">(</span><span class="n">residues</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residues" href="#structure.base.Residues">Residues</a></span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Initialize from existing Residue instances</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3493</span>
<span class="normal">3494</span>
<span class="normal">3495</span>
<span class="normal">3496</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_residues</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">residues</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Residue</span><span class="p">]</span> <span class="o">|</span> <span class="n">Residues</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize from existing Residue instances&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">residues</span><span class="o">=</span><span class="n">residues</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.from_structure" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">from_structure</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">from_structure</span><span class="p">(</span><span class="n">structure</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.ContainsResidues" href="#structure.base.ContainsResidues">ContainsResidues</a></span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Initialize from an existing Structure</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3498</span>
<span class="normal">3499</span>
<span class="normal">3500</span>
<span class="normal">3501</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span> <span class="nf">from_structure</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">structure</span><span class="p">:</span> <span class="n">ContainsResidues</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize from an existing Structure&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">structure</span><span class="o">=</span><span class="n">structure</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.assign_residues_from_structures" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">assign_residues_from_structures</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">assign_residues_from_structures</span><span class="p">(</span><span class="n">structures</span><span class="p">:</span> <span class="n"><span title="collections.abc.Iterable">Iterable</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.ContainsResidues" href="#structure.base.ContainsResidues">ContainsResidues</a></span><span class="p">])</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Initialize the instance from existing structure instance attributes, .coords, and .atoms, and .residues</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3579</span>
<span class="normal">3580</span>
<span class="normal">3581</span>
<span class="normal">3582</span>
<span class="normal">3583</span>
<span class="normal">3584</span>
<span class="normal">3585</span>
<span class="normal">3586</span>
<span class="normal">3587</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">assign_residues_from_structures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structures</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">ContainsResidues</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the instance from existing structure instance attributes, .coords, and .atoms, and .residues&quot;&quot;&quot;</span>
    <span class="n">atoms</span><span class="p">,</span> <span class="n">residues</span><span class="p">,</span> <span class="n">coords</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[],</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">structure</span> <span class="ow">in</span> <span class="n">structures</span><span class="p">:</span>
        <span class="n">atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
        <span class="n">residues</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">residues</span><span class="p">)</span>
        <span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_assign_residues</span><span class="p">(</span><span class="n">residues</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="n">atoms</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.make_parent" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make_parent</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">make_parent</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Remove this instance from its parent, making it a parent in the process</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3596</span>
<span class="normal">3597</span>
<span class="normal">3598</span>
<span class="normal">3599</span>
<span class="normal">3600</span>
<span class="normal">3601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">make_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove this instance from its parent, making it a parent in the process&quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">(</span><span class="n">ContainsAtoms</span><span class="p">,</span> <span class="n">ContainsAtoms</span><span class="p">)</span><span class="o">.</span><span class="n">make_parent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="c1"># Populate the Structure with its existing instances removed of any indexing</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_assign_residues</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residues</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.get_base_containers" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_base_containers</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_base_containers</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the instance structural containers as a dictionary with attribute as key and container as value</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3603</span>
<span class="normal">3604</span>
<span class="normal">3605</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_base_containers</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns the instance structural containers as a dictionary with attribute as key and container as value&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">coords</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_coords</span><span class="p">,</span> <span class="n">atoms</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_atoms</span><span class="p">,</span> <span class="n">residues</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_residues</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.contains_hydrogen" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">contains_hydrogen</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">contains_hydrogen</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns whether the Structure contains hydrogen atoms</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3623</span>
<span class="normal">3624</span>
<span class="normal">3625</span>
<span class="normal">3626</span>
<span class="normal">3627</span>
<span class="normal">3628</span>
<span class="normal">3629</span>
<span class="normal">3630</span>
<span class="normal">3631</span>
<span class="normal">3632</span>
<span class="normal">3633</span>
<span class="normal">3634</span>
<span class="normal">3635</span>
<span class="normal">3636</span>
<span class="normal">3637</span>
<span class="normal">3638</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">contains_hydrogen</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>  <span class="c1"># in Residue too</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns whether the Structure contains hydrogen atoms&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_hydrogen</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="c1"># Sample 20 residues from various &quot;locations&quot;.</span>
        <span class="c1"># If H is still present but not found, there is an anomaly in the Structure</span>
        <span class="n">slice_amount</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_residues</span> <span class="o">/</span> <span class="mi">20</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span><span class="p">[::</span><span class="n">slice_amount</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">residue</span><span class="o">.</span><span class="n">contains_hydrogen</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_contains_hydrogen</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_contains_hydrogen</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_contains_hydrogen</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.get_coords_subset" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_coords_subset</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_coords_subset</span><span class="p">(</span><span class="n">residue_numbers</span><span class="p">:</span> <span class="n"><span title="collections.abc.Container">Container</span></span><span class="p">[</span><span class="n">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n"><span title="collections.abc.Iterable">Iterable</span></span><span class="p">[</span><span class="n">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n"><span title="structure.utils.coords_type_literal">coords_type_literal</span></span> <span class="o">=</span> <span class="s1">&#39;ca&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return a view of a subset of the Coords from the Structure specified by a range of Residue numbers</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>residue_numbers</code></b>
            (<code><span title="collections.abc.Container">Container</span>[int]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The Residue numbers to return</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>indices</code></b>
            (<code><span title="collections.abc.Iterable">Iterable</span>[int]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>Residue indices of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>start</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The Residue number to start at. Inclusive</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>end</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The Residue number to end at. Inclusive</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>dtype</code></b>
            (<code><span title="structure.utils.coords_type_literal">coords_type_literal</span></code>, default:
                <code>&#39;ca&#39;</code>
)
        
        <div class="doc-md-description">
          <p>The type of coordinates to get</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="numpy.ndarray">ndarray</span></code>
        
        <div class="doc-md-description">
          <p>The specific coordinates from the Residue instances with the specified dtype</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3865</span>
<span class="normal">3866</span>
<span class="normal">3867</span>
<span class="normal">3868</span>
<span class="normal">3869</span>
<span class="normal">3870</span>
<span class="normal">3871</span>
<span class="normal">3872</span>
<span class="normal">3873</span>
<span class="normal">3874</span>
<span class="normal">3875</span>
<span class="normal">3876</span>
<span class="normal">3877</span>
<span class="normal">3878</span>
<span class="normal">3879</span>
<span class="normal">3880</span>
<span class="normal">3881</span>
<span class="normal">3882</span>
<span class="normal">3883</span>
<span class="normal">3884</span>
<span class="normal">3885</span>
<span class="normal">3886</span>
<span class="normal">3887</span>
<span class="normal">3888</span>
<span class="normal">3889</span>
<span class="normal">3890</span>
<span class="normal">3891</span>
<span class="normal">3892</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_coords_subset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residue_numbers</span><span class="p">:</span> <span class="n">Container</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                      <span class="n">start</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">stutils</span><span class="o">.</span><span class="n">coords_type_literal</span> <span class="o">=</span> <span class="s1">&#39;ca&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return a view of a subset of the Coords from the Structure specified by a range of Residue numbers</span>

<span class="sd">    Args:</span>
<span class="sd">        residue_numbers: The Residue numbers to return</span>
<span class="sd">        indices: Residue indices of interest</span>
<span class="sd">        start: The Residue number to start at. Inclusive</span>
<span class="sd">        end: The Residue number to end at. Inclusive</span>
<span class="sd">        dtype: The type of coordinates to get</span>

<span class="sd">    Returns:</span>
<span class="sd">        The specific coordinates from the Residue instances with the specified dtype</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">indices</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">residue_numbers</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">start</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">end</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">residue_numbers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">get_coords_subset</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: Must provide either &#39;indices&#39;, &#39;residue_numbers&#39; or &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;&#39;start&#39; and &#39;end&#39;&quot;</span><span class="p">)</span>
        <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_residues</span><span class="p">(</span><span class="n">residue_numbers</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_residues</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span>

    <span class="n">coords_type</span> <span class="o">=</span> <span class="s1">&#39;coords&#39;</span> <span class="k">if</span> <span class="n">dtype</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">dtype</span><span class="si">}</span><span class="s1">_coords&#39;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="nb">getattr</span><span class="p">(</span><span class="n">residue</span><span class="p">,</span> <span class="n">coords_type</span><span class="p">)</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.set_residues_attributes" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">set_residues_attributes</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">set_residues_attributes</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Set attributes specified by key, value pairs for Residues in the Structure</p>



  <p>Other Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>numbers</code></b>
        
        <div class="doc-md-description">
          <p>Container[int] = None - The Atom numbers of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>pdb</code></b>
        
        <div class="doc-md-description">
          <p>bool = False - Whether to search for numbers as they were parsed (if True)</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3894</span>
<span class="normal">3895</span>
<span class="normal">3896</span>
<span class="normal">3897</span>
<span class="normal">3898</span>
<span class="normal">3899</span>
<span class="normal">3900</span>
<span class="normal">3901</span>
<span class="normal">3902</span>
<span class="normal">3903</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_residues_attributes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set attributes specified by key, value pairs for Residues in the Structure</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        numbers: Container[int] = None - The Atom numbers of interest</span>
<span class="sd">        pdb: bool = False - Whether to search for numbers as they were parsed (if True)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_residues</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">kwarg</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="n">residue</span><span class="p">,</span> <span class="n">kwarg</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.get_residue_atom_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_residue_atom_indices</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_residue_atom_indices</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns Atom indices for Residue instances. Returns all by default unless numbers are specified, returns only
those Residue instance selected by number.</p>



  <p>Other Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>numbers</code></b>
        
        <div class="doc-md-description">
          <p>Container[int] = None - The Residue numbers of interest</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3912</span>
<span class="normal">3913</span>
<span class="normal">3914</span>
<span class="normal">3915</span>
<span class="normal">3916</span>
<span class="normal">3917</span>
<span class="normal">3918</span>
<span class="normal">3919</span>
<span class="normal">3920</span>
<span class="normal">3921</span>
<span class="normal">3922</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_residue_atom_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns Atom indices for Residue instances. Returns all by default unless numbers are specified, returns only</span>
<span class="sd">    those Residue instance selected by number.</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        numbers: Container[int] = None - The Residue numbers of interest</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">atom_indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_residues</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">atom_indices</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">atom_indices</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">atom_indices</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.get_residues_by_atom_indices" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_residues_by_atom_indices</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_residues_by_atom_indices</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.ArrayIndexer" href="#structure.base.ArrayIndexer">ArrayIndexer</a></span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Retrieve Residues in the Structure specified by Atom indices</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>atom_indices</code></b>
            (<code><a class="autorefs autorefs-internal" title="structure.base.ArrayIndexer" href="#structure.base.ArrayIndexer">ArrayIndexer</a></code>)
        
        <div class="doc-md-description">
          <p>The atom indices to retrieve Residue objects by</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>
        
        <div class="doc-md-description">
          <p>The sorted, unique Residue instances corresponding to the provided atom_indices</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">3924</span>
<span class="normal">3925</span>
<span class="normal">3926</span>
<span class="normal">3927</span>
<span class="normal">3928</span>
<span class="normal">3929</span>
<span class="normal">3930</span>
<span class="normal">3931</span>
<span class="normal">3932</span>
<span class="normal">3933</span>
<span class="normal">3934</span>
<span class="normal">3935</span>
<span class="normal">3936</span>
<span class="normal">3937</span>
<span class="normal">3938</span>
<span class="normal">3939</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_residues_by_atom_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">atom_indices</span><span class="p">:</span> <span class="n">ArrayIndexer</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Residue</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve Residues in the Structure specified by Atom indices</span>

<span class="sd">    Args:</span>
<span class="sd">        atom_indices: The atom indices to retrieve Residue objects by</span>

<span class="sd">    Returns:</span>
<span class="sd">        The sorted, unique Residue instances corresponding to the provided atom_indices</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parent</span><span class="p">():</span>
        <span class="n">_struct</span> <span class="o">=</span> <span class="bp">self</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">_struct</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>

    <span class="n">all_residues</span> <span class="o">=</span> <span class="n">_struct</span><span class="o">.</span><span class="n">_coords_indexed_residues</span><span class="p">[</span><span class="n">atom_indices</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">all_residues</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">residue</span><span class="p">:</span> <span class="n">residue</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.renumber" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">renumber</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">renumber</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Change the Atom and Residue numbering. Access the readtime Residue number in Residue.pdb_number attribute</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4019</span>
<span class="normal">4020</span>
<span class="normal">4021</span>
<span class="normal">4022</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">renumber</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Change the Atom and Residue numbering. Access the readtime Residue number in Residue.pdb_number attribute&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">renumber_atoms</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">pose_numbering</span><span class="p">()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.pose_numbering" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">pose_numbering</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">pose_numbering</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Change the Residue numbering to start at 1. Access the readtime Residue number in .pdb_number attribute</p>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4024</span>
<span class="normal">4025</span>
<span class="normal">4026</span>
<span class="normal">4027</span>
<span class="normal">4028</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">pose_numbering</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Change the Residue numbering to start at 1. Access the readtime Residue number in .pdb_number attribute&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">residue</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residues</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">residue</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">idx</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> was formatted in Pose numbering (residues now 1 to </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_residues</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.renumber_residues" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">renumber_residues</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">renumber_residues</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">at</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Renumber Residue objects sequentially starting with "at"</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>index</code></b>
            (<code>int</code>, default:
                <code>0</code>
)
        
        <div class="doc-md-description">
          <p>The index to start the renumbering process</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>at</code></b>
            (<code>int</code>, default:
                <code>1</code>
)
        
        <div class="doc-md-description">
          <p>The number to start renumbering at</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4030</span>
<span class="normal">4031</span>
<span class="normal">4032</span>
<span class="normal">4033</span>
<span class="normal">4034</span>
<span class="normal">4035</span>
<span class="normal">4036</span>
<span class="normal">4037</span>
<span class="normal">4038</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">renumber_residues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">at</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Renumber Residue objects sequentially starting with &quot;at&quot;</span>

<span class="sd">    Args:</span>
<span class="sd">        index: The index to start the renumbering process</span>
<span class="sd">        at: The number to start renumbering at</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">residue</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residues</span><span class="p">[</span><span class="n">index</span><span class="p">:],</span> <span class="n">at</span><span class="p">):</span>
        <span class="n">residue</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">idx</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.get_residues" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_residues</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_residues</span><span class="p">(</span><span class="n">numbers</span><span class="p">:</span> <span class="n"><span title="collections.abc.Container">Container</span></span><span class="p">[</span><span class="n">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n"><span title="collections.abc.Iterable">Iterable</span></span><span class="p">[</span><span class="n">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns Residue instances as specified. Returns all by default</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>numbers</code></b>
            (<code><span title="collections.abc.Container">Container</span>[int]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>Residue numbers of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>indices</code></b>
            (<code><span title="collections.abc.Iterable">Iterable</span>[int]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>Residue indices of interest for the Structure</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>
        
        <div class="doc-md-description">
          <p>The requested Residue instances, sorted in the order they appear in the Structure</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4040</span>
<span class="normal">4041</span>
<span class="normal">4042</span>
<span class="normal">4043</span>
<span class="normal">4044</span>
<span class="normal">4045</span>
<span class="normal">4046</span>
<span class="normal">4047</span>
<span class="normal">4048</span>
<span class="normal">4049</span>
<span class="normal">4050</span>
<span class="normal">4051</span>
<span class="normal">4052</span>
<span class="normal">4053</span>
<span class="normal">4054</span>
<span class="normal">4055</span>
<span class="normal">4056</span>
<span class="normal">4057</span>
<span class="normal">4058</span>
<span class="normal">4059</span>
<span class="normal">4060</span>
<span class="normal">4061</span>
<span class="normal">4062</span>
<span class="normal">4063</span>
<span class="normal">4064</span>
<span class="normal">4065</span>
<span class="normal">4066</span>
<span class="normal">4067</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_residues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numbers</span><span class="p">:</span> <span class="n">Container</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Residue</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Returns Residue instances as specified. Returns all by default</span>

<span class="sd">    Args:</span>
<span class="sd">        numbers: Residue numbers of interest</span>
<span class="sd">        indices: Residue indices of interest for the Structure</span>

<span class="sd">    Returns:</span>
<span class="sd">        The requested Residue instances, sorted in the order they appear in the Structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span>
    <span class="k">if</span> <span class="n">numbers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">Container</span><span class="p">):</span>
            <span class="n">residues</span> <span class="o">=</span> <span class="p">[</span><span class="n">residue</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span> <span class="k">if</span> <span class="n">residue</span><span class="o">.</span><span class="n">number</span> <span class="ow">in</span> <span class="n">numbers</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The passed numbers type &quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">numbers</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">&quot; must be a Container. Returning &#39;</span>
                             <span class="sa">f</span><span class="s1">&#39;all Residue instances instead&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">residues</span> <span class="o">=</span> <span class="p">[</span><span class="n">residues</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="n">number_of_residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_residues</span>
            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">idx</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">idx</span> <span class="o">&gt;=</span> <span class="n">number_of_residues</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s1">&#39;The residue index </span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1"> is out of bounds for the </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> &#39;</span>
                        <span class="sa">f</span><span class="s1">&#39;with size of </span><span class="si">{</span><span class="n">number_of_residues</span><span class="si">}</span><span class="s1"> residues&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">residues</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.residue" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">residue</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">residue</span><span class="p">(</span><span class="n">residue_number</span><span class="p">:</span> <span class="n">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span> <span class="o">|</span> <span class="kc">None</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Retrieve the specified Residue</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>residue_number</code></b>
            (<code>int</code>)
        
        <div class="doc-md-description">
          <p>The number of the Residue to search for</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4177</span>
<span class="normal">4178</span>
<span class="normal">4179</span>
<span class="normal">4180</span>
<span class="normal">4181</span>
<span class="normal">4182</span>
<span class="normal">4183</span>
<span class="normal">4184</span>
<span class="normal">4185</span>
<span class="normal">4186</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">residue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residue_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Residue</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Retrieve the specified Residue</span>

<span class="sd">    Args:</span>
<span class="sd">        residue_number: The number of the Residue to search for</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">residue</span><span class="o">.</span><span class="n">number</span> <span class="o">==</span> <span class="n">residue_number</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">residue</span>
    <span class="k">return</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.add_ideal_helix" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">add_ideal_helix</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">add_ideal_helix</span><span class="p">(</span><span class="n">termini</span><span class="p">:</span> <span class="n"><span title="structure.utils.termini_literal">termini_literal</span></span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">alignment_length</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Add an ideal helix to a termini given by a certain length</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>termini</code></b>
            (<code><span title="structure.utils.termini_literal">termini_literal</span></code>, default:
                <code>&#39;n&#39;</code>
)
        
        <div class="doc-md-description">
          <p>The termini to add the ideal helix to</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>length</code></b>
            (<code>int</code>, default:
                <code>5</code>
)
        
        <div class="doc-md-description">
          <p>The length of the addition, where viable values are [1-10] residues additions</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>alignment_length</code></b>
            (<code>int</code>, default:
                <code>5</code>
)
        
        <div class="doc-md-description">
          <p>The number of residues used to calculation overlap of the target to the ideal helix</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4198</span>
<span class="normal">4199</span>
<span class="normal">4200</span>
<span class="normal">4201</span>
<span class="normal">4202</span>
<span class="normal">4203</span>
<span class="normal">4204</span>
<span class="normal">4205</span>
<span class="normal">4206</span>
<span class="normal">4207</span>
<span class="normal">4208</span>
<span class="normal">4209</span>
<span class="normal">4210</span>
<span class="normal">4211</span>
<span class="normal">4212</span>
<span class="normal">4213</span>
<span class="normal">4214</span>
<span class="normal">4215</span>
<span class="normal">4216</span>
<span class="normal">4217</span>
<span class="normal">4218</span>
<span class="normal">4219</span>
<span class="normal">4220</span>
<span class="normal">4221</span>
<span class="normal">4222</span>
<span class="normal">4223</span>
<span class="normal">4224</span>
<span class="normal">4225</span>
<span class="normal">4226</span>
<span class="normal">4227</span>
<span class="normal">4228</span>
<span class="normal">4229</span>
<span class="normal">4230</span>
<span class="normal">4231</span>
<span class="normal">4232</span>
<span class="normal">4233</span>
<span class="normal">4234</span>
<span class="normal">4235</span>
<span class="normal">4236</span>
<span class="normal">4237</span>
<span class="normal">4238</span>
<span class="normal">4239</span>
<span class="normal">4240</span>
<span class="normal">4241</span>
<span class="normal">4242</span>
<span class="normal">4243</span>
<span class="normal">4244</span>
<span class="normal">4245</span>
<span class="normal">4246</span>
<span class="normal">4247</span>
<span class="normal">4248</span>
<span class="normal">4249</span>
<span class="normal">4250</span>
<span class="normal">4251</span>
<span class="normal">4252</span>
<span class="normal">4253</span>
<span class="normal">4254</span>
<span class="normal">4255</span>
<span class="normal">4256</span>
<span class="normal">4257</span>
<span class="normal">4258</span>
<span class="normal">4259</span>
<span class="normal">4260</span>
<span class="normal">4261</span>
<span class="normal">4262</span>
<span class="normal">4263</span>
<span class="normal">4264</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">add_ideal_helix</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">termini</span><span class="p">:</span> <span class="n">stutils</span><span class="o">.</span><span class="n">termini_literal</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">alignment_length</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Add an ideal helix to a termini given by a certain length</span>

<span class="sd">    Args:</span>
<span class="sd">        termini: The termini to add the ideal helix to</span>
<span class="sd">        length: The length of the addition, where viable values are [1-10] residues additions</span>
<span class="sd">        alignment_length: The number of residues used to calculation overlap of the target to the ideal helix</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">maximum_extension_length</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">-</span> <span class="n">alignment_length</span>
    <span class="k">if</span> <span class="n">length</span> <span class="o">&gt;</span> <span class="n">maximum_extension_length</span><span class="p">:</span>
        <span class="n">number_of_iterations</span><span class="p">,</span> <span class="n">length</span> <span class="o">=</span> <span class="nb">divmod</span><span class="p">(</span><span class="n">length</span><span class="p">,</span> <span class="n">maximum_extension_length</span><span class="p">)</span>
        <span class="c1"># First add the remainder &#39;length&#39; with the specified alignment length,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_ideal_helix</span><span class="p">(</span><span class="n">termini</span><span class="o">=</span><span class="n">termini</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="n">length</span><span class="p">,</span> <span class="n">alignment_length</span><span class="o">=</span><span class="n">alignment_length</span><span class="p">)</span>
        <span class="c1"># Then perform 10 residue extensions until complete</span>
        <span class="c1"># Using the default 10 and 5 alignment to prevent any errors from alignment of shorter amount from</span>
        <span class="c1"># propagating to the ideal addition and creating ideal &quot;kinks&quot;</span>
        <span class="n">addition_count</span> <span class="o">=</span> <span class="n">count</span><span class="p">()</span>
        <span class="k">while</span> <span class="nb">next</span><span class="p">(</span><span class="n">addition_count</span><span class="p">)</span> <span class="o">!=</span> <span class="n">number_of_iterations</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_ideal_helix</span><span class="p">(</span><span class="n">termini</span><span class="o">=</span><span class="n">termini</span><span class="p">,</span> <span class="n">length</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

        <span class="k">return</span>
    <span class="k">elif</span> <span class="n">length</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Adding </span><span class="si">{</span><span class="n">length</span><span class="si">}</span><span class="s1"> residue ideal helix to </span><span class="si">{</span><span class="n">termini</span><span class="si">}</span><span class="s1">-terminus of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">alpha_helix_15_struct</span> <span class="o">=</span> <span class="n">ContainsResidues</span><span class="o">.</span><span class="n">from_atoms</span><span class="p">(</span><span class="n">alpha_helix_15_atoms</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">termini</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
        <span class="n">residue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_terminal_residue</span>
        <span class="n">residue_index</span> <span class="o">=</span> <span class="n">residue</span><span class="o">.</span><span class="n">index</span>
        <span class="n">fixed_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_coords_subset</span><span class="p">(</span>
            <span class="n">indices</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">residue_index</span><span class="p">,</span> <span class="n">residue_index</span> <span class="o">+</span> <span class="n">alignment_length</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;backbone&#39;</span><span class="p">)</span>

        <span class="n">ideal_end_index</span> <span class="o">=</span> <span class="n">alpha_helix_15_struct</span><span class="o">.</span><span class="n">c_terminal_residue</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">ideal_start_index</span> <span class="o">=</span> <span class="n">ideal_end_index</span> <span class="o">-</span> <span class="n">alignment_length</span>
        <span class="n">moving_coords</span> <span class="o">=</span> <span class="n">alpha_helix_15_struct</span><span class="o">.</span><span class="n">get_coords_subset</span><span class="p">(</span>
            <span class="n">indices</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">ideal_start_index</span><span class="p">,</span> <span class="n">ideal_end_index</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;backbone&#39;</span><span class="p">)</span>
        <span class="n">rmsd</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">tx</span> <span class="o">=</span> <span class="n">superposition3d</span><span class="p">(</span><span class="n">fixed_coords</span><span class="p">,</span> <span class="n">moving_coords</span><span class="p">)</span>
        <span class="n">alpha_helix_15_struct</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="n">rot</span><span class="p">,</span> <span class="n">translation</span><span class="o">=</span><span class="n">tx</span><span class="p">)</span>

        <span class="c1"># Add residues</span>
        <span class="n">helix_add_start</span> <span class="o">=</span> <span class="n">ideal_start_index</span> <span class="o">-</span> <span class="n">length</span>
        <span class="c1"># Exclude ideal_start_index from residue selection</span>
        <span class="n">add_residues</span> <span class="o">=</span> <span class="n">alpha_helix_15_struct</span><span class="o">.</span><span class="n">get_residues</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">helix_add_start</span><span class="p">,</span> <span class="n">ideal_start_index</span><span class="p">)))</span>
    <span class="k">elif</span> <span class="n">termini</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span>
        <span class="n">residue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_terminal_residue</span>
        <span class="n">residue_index</span> <span class="o">=</span> <span class="n">residue</span><span class="o">.</span><span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">fixed_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_coords_subset</span><span class="p">(</span>
            <span class="n">indices</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">residue_index</span> <span class="o">-</span> <span class="n">alignment_length</span><span class="p">,</span> <span class="n">residue_index</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;backbone&#39;</span><span class="p">)</span>

        <span class="n">ideal_start_index</span> <span class="o">=</span> <span class="n">alpha_helix_15_struct</span><span class="o">.</span><span class="n">n_terminal_residue</span><span class="o">.</span><span class="n">index</span>
        <span class="n">ideal_end_index</span> <span class="o">=</span> <span class="n">ideal_start_index</span> <span class="o">+</span> <span class="n">alignment_length</span>
        <span class="n">moving_coords</span> <span class="o">=</span> <span class="n">alpha_helix_15_struct</span><span class="o">.</span><span class="n">get_coords_subset</span><span class="p">(</span>
            <span class="n">indices</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">ideal_start_index</span><span class="p">,</span> <span class="n">ideal_end_index</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;backbone&#39;</span><span class="p">)</span>
        <span class="n">rmsd</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">tx</span> <span class="o">=</span> <span class="n">superposition3d</span><span class="p">(</span><span class="n">fixed_coords</span><span class="p">,</span> <span class="n">moving_coords</span><span class="p">)</span>
        <span class="n">alpha_helix_15_struct</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="n">rot</span><span class="p">,</span> <span class="n">translation</span><span class="o">=</span><span class="n">tx</span><span class="p">)</span>

        <span class="c1"># Add residues</span>
        <span class="n">helix_add_end</span> <span class="o">=</span> <span class="n">ideal_end_index</span> <span class="o">+</span> <span class="n">length</span>
        <span class="c1"># Leave out the residue with ideal_end_index, and include the helix_add_end number</span>
        <span class="n">add_residues</span> <span class="o">=</span> <span class="n">alpha_helix_15_struct</span><span class="o">.</span><span class="n">get_residues</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">ideal_end_index</span><span class="p">,</span> <span class="n">helix_add_end</span><span class="p">)))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;termini&#39; must be either &#39;n&#39; or &#39;c&#39;, not </span><span class="si">{</span><span class="n">termini</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">insert_residues</span><span class="p">(</span><span class="n">residue_index</span><span class="p">,</span> <span class="n">add_residues</span><span class="p">,</span> <span class="n">chain_id</span><span class="o">=</span><span class="n">residue</span><span class="o">.</span><span class="n">chain_id</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.get_residue_atoms" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_residue_atoms</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_residue_atoms</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the Atoms contained in the Residue objects matching a set of residue numbers</p>



  <p>Other Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>numbers</code></b>
        
        <div class="doc-md-description">
          <p>Container[int] = None  Residue numbers of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>indices</code></b>
        
        <div class="doc-md-description">
          <p>Iterable[int] = None  Residue indices of interest for the Structure</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[<a class="autorefs autorefs-internal" title="structure.base.Atom" href="#structure.base.Atom">Atom</a>]</code>
        
        <div class="doc-md-description">
          <p>The Atom instances belonging to the Residue instances</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4266</span>
<span class="normal">4267</span>
<span class="normal">4268</span>
<span class="normal">4269</span>
<span class="normal">4270</span>
<span class="normal">4271</span>
<span class="normal">4272</span>
<span class="normal">4273</span>
<span class="normal">4274</span>
<span class="normal">4275</span>
<span class="normal">4276</span>
<span class="normal">4277</span>
<span class="normal">4278</span>
<span class="normal">4279</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_residue_atoms</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Atom</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the Atoms contained in the Residue objects matching a set of residue numbers</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        numbers: Container[int] = None  Residue numbers of interest</span>
<span class="sd">        indices: Iterable[int] = None  Residue indices of interest for the Structure</span>

<span class="sd">    Returns:</span>
<span class="sd">        The Atom instances belonging to the Residue instances</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">atoms</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_residues</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">atoms</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">atoms</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.mutate_residue" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">mutate_residue</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">mutate_residue</span><span class="p">(</span><span class="n">residue</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">to</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span> <span class="o">|</span> <span class="n">list</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Mutate a specific Residue to a new residue type. Type can be 1 or 3 letter format</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>residue</code></b>
            (<code><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>A Residue instance to mutate</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>index</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>A Residue index to select the Residue instance of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>number</code></b>
            (<code>int</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>A Residue number to select the Residue instance of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>to</code></b>
            (<code>str</code>, default:
                <code>&#39;A&#39;</code>
)
        
        <div class="doc-md-description">
          <p>The type of amino acid to mutate to</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[int] | list</code>
        
        <div class="doc-md-description">
          <p>The indices of the Atoms being removed from the Structure</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4281</span>
<span class="normal">4282</span>
<span class="normal">4283</span>
<span class="normal">4284</span>
<span class="normal">4285</span>
<span class="normal">4286</span>
<span class="normal">4287</span>
<span class="normal">4288</span>
<span class="normal">4289</span>
<span class="normal">4290</span>
<span class="normal">4291</span>
<span class="normal">4292</span>
<span class="normal">4293</span>
<span class="normal">4294</span>
<span class="normal">4295</span>
<span class="normal">4296</span>
<span class="normal">4297</span>
<span class="normal">4298</span>
<span class="normal">4299</span>
<span class="normal">4300</span>
<span class="normal">4301</span>
<span class="normal">4302</span>
<span class="normal">4303</span>
<span class="normal">4304</span>
<span class="normal">4305</span>
<span class="normal">4306</span>
<span class="normal">4307</span>
<span class="normal">4308</span>
<span class="normal">4309</span>
<span class="normal">4310</span>
<span class="normal">4311</span>
<span class="normal">4312</span>
<span class="normal">4313</span>
<span class="normal">4314</span>
<span class="normal">4315</span>
<span class="normal">4316</span>
<span class="normal">4317</span>
<span class="normal">4318</span>
<span class="normal">4319</span>
<span class="normal">4320</span>
<span class="normal">4321</span>
<span class="normal">4322</span>
<span class="normal">4323</span>
<span class="normal">4324</span>
<span class="normal">4325</span>
<span class="normal">4326</span>
<span class="normal">4327</span>
<span class="normal">4328</span>
<span class="normal">4329</span>
<span class="normal">4330</span>
<span class="normal">4331</span>
<span class="normal">4332</span>
<span class="normal">4333</span>
<span class="normal">4334</span>
<span class="normal">4335</span>
<span class="normal">4336</span>
<span class="normal">4337</span>
<span class="normal">4338</span>
<span class="normal">4339</span>
<span class="normal">4340</span>
<span class="normal">4341</span>
<span class="normal">4342</span>
<span class="normal">4343</span>
<span class="normal">4344</span>
<span class="normal">4345</span>
<span class="normal">4346</span>
<span class="normal">4347</span>
<span class="normal">4348</span>
<span class="normal">4349</span>
<span class="normal">4350</span>
<span class="normal">4351</span>
<span class="normal">4352</span>
<span class="normal">4353</span>
<span class="normal">4354</span>
<span class="normal">4355</span>
<span class="normal">4356</span>
<span class="normal">4357</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">mutate_residue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residue</span><span class="p">:</span> <span class="n">Residue</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">number</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">to</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> \
        <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Mutate a specific Residue to a new residue type. Type can be 1 or 3 letter format</span>

<span class="sd">    Args:</span>
<span class="sd">        residue: A Residue instance to mutate</span>
<span class="sd">        index: A Residue index to select the Residue instance of interest</span>
<span class="sd">        number: A Residue number to select the Residue instance of interest</span>
<span class="sd">        to: The type of amino acid to mutate to</span>

<span class="sd">    Returns:</span>
<span class="sd">        The indices of the Atoms being removed from the Structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">residue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;The residue index </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s1"> is out of bounds for the </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> &#39;</span>
                <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> with size of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_residues</span><span class="si">}</span><span class="s1"> residues&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">number</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">residue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residue</span><span class="p">(</span><span class="n">number</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">residue</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Can&#39;t </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mutate_residue</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> without Residue instance, index, or number&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dependent</span><span class="p">():</span>
        <span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">mutate_residue</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> can&#39;t be performed on a dependent StructureBase. &quot;</span>
                       <span class="sa">f</span><span class="s2">&quot;Calling on the </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.parent </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">_parent</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Ensure the deletion is done by the Structure parent to account for everything correctly</span>
        <span class="k">return</span> <span class="n">_parent</span><span class="o">.</span><span class="n">mutate_residue</span><span class="p">(</span><span class="n">residue</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="n">to</span><span class="p">)</span>

    <span class="n">to</span> <span class="o">=</span> <span class="n">protein_letters_1to3</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">to</span><span class="o">.</span><span class="n">upper</span><span class="p">(),</span> <span class="n">to</span><span class="o">.</span><span class="n">upper</span><span class="p">())</span>
    <span class="k">if</span> <span class="n">residue</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">to</span><span class="p">:</span>  <span class="c1"># No mutation necessary</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">protein_letters_3to1_extended</span><span class="p">[</span><span class="n">to</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The mutation type &#39;</span><span class="si">{</span><span class="n">to</span><span class="si">}</span><span class="s2">&#39; isn&#39;t a viable Residue type&quot;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Mutating </span><span class="si">{</span><span class="n">residue</span><span class="o">.</span><span class="n">type</span><span class="si">}{</span><span class="n">residue</span><span class="o">.</span><span class="n">number</span><span class="si">}{</span><span class="n">to</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">residue</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">to</span>
    <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">residue</span><span class="o">.</span><span class="n">atoms</span><span class="p">:</span>
        <span class="n">atom</span><span class="o">.</span><span class="n">residue_type</span> <span class="o">=</span> <span class="n">to</span>

    <span class="c1"># Find the corresponding Residue Atom indices to delete</span>
    <span class="n">delete_indices</span> <span class="o">=</span> <span class="n">residue</span><span class="o">.</span><span class="n">side_chain_indices</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">delete_indices</span><span class="p">:</span>  <span class="c1"># There are no indices</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Clear all state variables for all Residue instances</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_residues</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
        <span class="c1"># residue.side_chain_indices = []</span>

    <span class="c1"># Remove indices from the Residue, and Structure atom_indices</span>
    <span class="n">residue_atom_indices</span> <span class="o">=</span> <span class="n">residue</span><span class="o">.</span><span class="n">atom_indices</span>
    <span class="n">residue_atom_delete_index</span> <span class="o">=</span> <span class="n">residue_atom_indices</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">delete_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">_atom_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_atom_indices</span>
    <span class="n">structure_atom_delete_index</span> <span class="o">=</span> <span class="n">_atom_indices</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">delete_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="n">delete_indices</span><span class="p">):</span>
        <span class="n">residue_atom_indices</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">residue_atom_delete_index</span><span class="p">)</span>
        <span class="n">_atom_indices</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">structure_atom_delete_index</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_offset_indices</span><span class="p">(</span><span class="n">start_at</span><span class="o">=</span><span class="n">structure_atom_delete_index</span><span class="p">,</span> <span class="n">offset</span><span class="o">=-</span><span class="nb">len</span><span class="p">(</span><span class="n">delete_indices</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;atom&#39;</span><span class="p">)</span>

    <span class="c1"># Re-index all succeeding Atom and Residue instance indices</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_coords</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">delete_indices</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_atoms</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">delete_indices</span><span class="p">)</span>
    <span class="c1"># self._atoms.reindex(start_at=structure_atom_delete_index)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_residues</span><span class="o">.</span><span class="n">reindex_atoms</span><span class="p">(</span><span class="n">start_at</span><span class="o">=</span><span class="n">residue</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="c1"># Reissue the atom assignments for the Residue</span>
    <span class="n">residue</span><span class="o">.</span><span class="n">delegate_atoms</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">delete_indices</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.delete_residues" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">delete_residues</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">delete_residues</span><span class="p">(</span><span class="n">residues</span><span class="p">:</span> <span class="n"><span title="collections.abc.Iterable">Iterable</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n"><span title="collections.abc.Iterable">Iterable</span></span><span class="p">[</span><span class="n">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">numbers</span><span class="p">:</span> <span class="n"><span title="collections.abc.Container">Container</span></span><span class="p">[</span><span class="n">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span> <span class="o">|</span> <span class="n">list</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Deletes Residue instances from the Structure</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>residues</code></b>
            (<code><span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>Residue instances to delete</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>indices</code></b>
            (<code><span title="collections.abc.Iterable">Iterable</span>[int]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>Residue indices to select the Residue instances of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>numbers</code></b>
            (<code><span title="collections.abc.Container">Container</span>[int]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>Residue numbers to select the Residue instances of interest</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>] | list</code>
        
        <div class="doc-md-description">
          <p>Each deleted Residue</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4359</span>
<span class="normal">4360</span>
<span class="normal">4361</span>
<span class="normal">4362</span>
<span class="normal">4363</span>
<span class="normal">4364</span>
<span class="normal">4365</span>
<span class="normal">4366</span>
<span class="normal">4367</span>
<span class="normal">4368</span>
<span class="normal">4369</span>
<span class="normal">4370</span>
<span class="normal">4371</span>
<span class="normal">4372</span>
<span class="normal">4373</span>
<span class="normal">4374</span>
<span class="normal">4375</span>
<span class="normal">4376</span>
<span class="normal">4377</span>
<span class="normal">4378</span>
<span class="normal">4379</span>
<span class="normal">4380</span>
<span class="normal">4381</span>
<span class="normal">4382</span>
<span class="normal">4383</span>
<span class="normal">4384</span>
<span class="normal">4385</span>
<span class="normal">4386</span>
<span class="normal">4387</span>
<span class="normal">4388</span>
<span class="normal">4389</span>
<span class="normal">4390</span>
<span class="normal">4391</span>
<span class="normal">4392</span>
<span class="normal">4393</span>
<span class="normal">4394</span>
<span class="normal">4395</span>
<span class="normal">4396</span>
<span class="normal">4397</span>
<span class="normal">4398</span>
<span class="normal">4399</span>
<span class="normal">4400</span>
<span class="normal">4401</span>
<span class="normal">4402</span>
<span class="normal">4403</span>
<span class="normal">4404</span>
<span class="normal">4405</span>
<span class="normal">4406</span>
<span class="normal">4407</span>
<span class="normal">4408</span>
<span class="normal">4409</span>
<span class="normal">4410</span>
<span class="normal">4411</span>
<span class="normal">4412</span>
<span class="normal">4413</span>
<span class="normal">4414</span>
<span class="normal">4415</span>
<span class="normal">4416</span>
<span class="normal">4417</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete_residues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residues</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Residue</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                    <span class="n">numbers</span><span class="p">:</span> <span class="n">Container</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Residue</span><span class="p">]</span> <span class="o">|</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Deletes Residue instances from the Structure</span>

<span class="sd">    Args:</span>
<span class="sd">        residues: Residue instances to delete</span>
<span class="sd">        indices: Residue indices to select the Residue instances of interest</span>
<span class="sd">        numbers: Residue numbers to select the Residue instances of interest</span>

<span class="sd">    Returns:</span>
<span class="sd">        Each deleted Residue</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_residues</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">numbers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_residues</span><span class="p">(</span><span class="n">numbers</span><span class="o">=</span><span class="n">numbers</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">residues</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Can&#39;t </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">delete_residues</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> without Residue instances. Provide with indices, numbers, or &quot;</span>
            <span class="s2">&quot;residues&quot;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="ow">not</span> <span class="n">residues</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">delete_residues</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">: No residues found&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[]</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dependent</span><span class="p">():</span>  <span class="c1"># Call on the parent</span>
        <span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">delete_residues</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> can&#39;t be performed on a dependent StructureBase. &quot;</span>
                       <span class="sa">f</span><span class="s2">&quot;Calling on the </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.parent </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">_parent</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Ensure the deletion is done by the Structure parent to account for everything correctly</span>
        <span class="k">return</span> <span class="n">_parent</span><span class="o">.</span><span class="n">delete_residues</span><span class="p">(</span><span class="n">residues</span><span class="o">=</span><span class="n">residues</span><span class="p">)</span>

    <span class="c1"># Find the Residue, Atom indices to delete</span>
    <span class="n">atom_indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Deleting </span><span class="si">{</span><span class="n">residue</span><span class="o">.</span><span class="n">type</span><span class="si">}{</span><span class="n">residue</span><span class="o">.</span><span class="n">number</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">atom_indices</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">atom_indices</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">atom_indices</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>  <span class="c1"># There are no indices for the Residue instances</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Find the Residue indices to delete</span>
        <span class="n">residue_indices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
            <span class="n">residue_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>

    <span class="c1"># Remove indices from the Residue, and Structure atom_indices</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_delete_indices</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;atom&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_delete_indices</span><span class="p">(</span><span class="n">residue_indices</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;residue&#39;</span><span class="p">)</span>
    <span class="c1"># Re-index all succeeding Atom and Residue instance indices</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_coords</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_atoms</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">atom_indices</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_residues</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">residue_indices</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_residues</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">start_at</span><span class="o">=</span><span class="n">residue_indices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Clear state variables for remaining Residue instances. Residue deletion affected remaining attrs and indices</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_residues</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>
    <span class="c1"># Reindex the coords/residues map</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">residues</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.insert_residue_type" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">insert_residue_type</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">insert_residue_type</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="n">int</span><span class="p">,</span> <span class="n">residue_type</span><span class="p">:</span> <span class="n">str</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Insert a standard Residue type into the Structure at the origin. No structural alignment is performed!</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>index</code></b>
            (<code>int</code>)
        
        <div class="doc-md-description">
          <p>The residue index where a new Residue should be inserted into the Structure</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>residue_type</code></b>
            (<code>str</code>)
        
        <div class="doc-md-description">
          <p>Either the 1 or 3 letter amino acid code for the residue in question</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>chain_id</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The chain identifier to associate the new Residue with</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></code>
        
        <div class="doc-md-description">
          <p>The newly inserted Residue object</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4419</span>
<span class="normal">4420</span>
<span class="normal">4421</span>
<span class="normal">4422</span>
<span class="normal">4423</span>
<span class="normal">4424</span>
<span class="normal">4425</span>
<span class="normal">4426</span>
<span class="normal">4427</span>
<span class="normal">4428</span>
<span class="normal">4429</span>
<span class="normal">4430</span>
<span class="normal">4431</span>
<span class="normal">4432</span>
<span class="normal">4433</span>
<span class="normal">4434</span>
<span class="normal">4435</span>
<span class="normal">4436</span>
<span class="normal">4437</span>
<span class="normal">4438</span>
<span class="normal">4439</span>
<span class="normal">4440</span>
<span class="normal">4441</span>
<span class="normal">4442</span>
<span class="normal">4443</span>
<span class="normal">4444</span>
<span class="normal">4445</span>
<span class="normal">4446</span>
<span class="normal">4447</span>
<span class="normal">4448</span>
<span class="normal">4449</span>
<span class="normal">4450</span>
<span class="normal">4451</span>
<span class="normal">4452</span>
<span class="normal">4453</span>
<span class="normal">4454</span>
<span class="normal">4455</span>
<span class="normal">4456</span>
<span class="normal">4457</span>
<span class="normal">4458</span>
<span class="normal">4459</span>
<span class="normal">4460</span>
<span class="normal">4461</span>
<span class="normal">4462</span>
<span class="normal">4463</span>
<span class="normal">4464</span>
<span class="normal">4465</span>
<span class="normal">4466</span>
<span class="normal">4467</span>
<span class="normal">4468</span>
<span class="normal">4469</span>
<span class="normal">4470</span>
<span class="normal">4471</span>
<span class="normal">4472</span>
<span class="normal">4473</span>
<span class="normal">4474</span>
<span class="normal">4475</span>
<span class="normal">4476</span>
<span class="normal">4477</span>
<span class="normal">4478</span>
<span class="normal">4479</span>
<span class="normal">4480</span>
<span class="normal">4481</span>
<span class="normal">4482</span>
<span class="normal">4483</span>
<span class="normal">4484</span>
<span class="normal">4485</span>
<span class="normal">4486</span>
<span class="normal">4487</span>
<span class="normal">4488</span>
<span class="normal">4489</span>
<span class="normal">4490</span>
<span class="normal">4491</span>
<span class="normal">4492</span>
<span class="normal">4493</span>
<span class="normal">4494</span>
<span class="normal">4495</span>
<span class="normal">4496</span>
<span class="normal">4497</span>
<span class="normal">4498</span>
<span class="normal">4499</span>
<span class="normal">4500</span>
<span class="normal">4501</span>
<span class="normal">4502</span>
<span class="normal">4503</span>
<span class="normal">4504</span>
<span class="normal">4505</span>
<span class="normal">4506</span>
<span class="normal">4507</span>
<span class="normal">4508</span>
<span class="normal">4509</span>
<span class="normal">4510</span>
<span class="normal">4511</span>
<span class="normal">4512</span>
<span class="normal">4513</span>
<span class="normal">4514</span>
<span class="normal">4515</span>
<span class="normal">4516</span>
<span class="normal">4517</span>
<span class="normal">4518</span>
<span class="normal">4519</span>
<span class="normal">4520</span>
<span class="normal">4521</span>
<span class="normal">4522</span>
<span class="normal">4523</span>
<span class="normal">4524</span>
<span class="normal">4525</span>
<span class="normal">4526</span>
<span class="normal">4527</span>
<span class="normal">4528</span>
<span class="normal">4529</span>
<span class="normal">4530</span>
<span class="normal">4531</span>
<span class="normal">4532</span>
<span class="normal">4533</span>
<span class="normal">4534</span>
<span class="normal">4535</span>
<span class="normal">4536</span>
<span class="normal">4537</span>
<span class="normal">4538</span>
<span class="normal">4539</span>
<span class="normal">4540</span>
<span class="normal">4541</span>
<span class="normal">4542</span>
<span class="normal">4543</span>
<span class="normal">4544</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">insert_residue_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">residue_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Residue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Insert a standard Residue type into the Structure at the origin. No structural alignment is performed!</span>

<span class="sd">    Args:</span>
<span class="sd">        index: The residue index where a new Residue should be inserted into the Structure</span>
<span class="sd">        residue_type: Either the 1 or 3 letter amino acid code for the residue in question</span>
<span class="sd">        chain_id: The chain identifier to associate the new Residue with</span>

<span class="sd">    Returns:</span>
<span class="sd">        The newly inserted Residue object</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dependent</span><span class="p">():</span>  <span class="c1"># Call on the parent</span>
        <span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">insert_residue_type</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> can&#39;t be performed on a dependent StructureBase. &quot;</span>
                       <span class="sa">f</span><span class="s2">&quot;Calling on the </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.parent </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">_parent</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Ensure the deletion is done by the Structure parent to account for everything correctly</span>
        <span class="k">if</span> <span class="n">chain_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">chain_id</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;chain_id&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_parent</span><span class="o">.</span><span class="n">insert_residue_type</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">residue_type</span><span class="p">,</span> <span class="n">chain_id</span><span class="o">=</span><span class="n">chain_id</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Inserting </span><span class="si">{</span><span class="n">residue_type</span><span class="si">}</span><span class="s1"> into index </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s1"> of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Convert incoming amino acid to an index to select the stutils.reference_residue.</span>
    <span class="c1"># protein_letters_alph1 has a matching index</span>
    <span class="n">reference_index</span> <span class="o">=</span> \
        <span class="n">protein_letters_alph1</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">protein_letters_3to1_extended</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">residue_type</span><span class="p">,</span> <span class="n">residue_type</span><span class="o">.</span><span class="n">upper</span><span class="p">()))</span>
    <span class="k">if</span> <span class="n">reference_index</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">insert_residue_type</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> of residue_type &#39;</span><span class="si">{</span><span class="n">residue_type</span><span class="si">}</span><span class="s2">&#39; isn&#39;t allowed&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">IndexError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">insert_residue_type</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> at index </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2"> &lt; 0 isn&#39;t allowed&quot;</span><span class="p">)</span>

    <span class="c1"># Grab the reference atom coordinates and push into the atom list</span>
    <span class="n">new_residue</span> <span class="o">=</span> <span class="n">reference_residues</span><span class="p">[</span><span class="n">reference_index</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

    <span class="c1"># Find the prior and next Residue, atom_start_index (starting atom in new Residue index)</span>
    <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># n-termini = True</span>
        <span class="n">prev_residue</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">atom_start_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">prev_residue</span> <span class="o">=</span> <span class="n">residues</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">atom_start_index</span> <span class="o">=</span> <span class="n">prev_residue</span><span class="o">.</span><span class="n">end_index</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">next_residue</span> <span class="o">=</span> <span class="n">residues</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>  <span class="c1"># c_termini = True</span>
        <span class="n">next_residue</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">prev_residue</span><span class="p">:</span>  <span class="c1"># Insertion on an empty Structure? block for now to simplify chain identification</span>
            <span class="k">raise</span> <span class="n">stutils</span><span class="o">.</span><span class="n">DesignError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Can&#39;t </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">insert_residue_type</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> for an empty </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> class&quot;</span><span class="p">)</span>

    <span class="c1"># Set found attributes</span>
    <span class="n">new_residue</span><span class="o">.</span><span class="n">_insert</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># Insert the new_residue coords, atoms, and residues into the Structure</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_coords</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">atom_start_index</span><span class="p">,</span> <span class="n">new_residue</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_atoms</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">atom_start_index</span><span class="p">,</span> <span class="n">new_residue</span><span class="o">.</span><span class="n">atoms</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_residues</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="p">[</span><span class="n">new_residue</span><span class="p">])</span>
    <span class="c1"># After coords, atoms, residues insertion into &quot;_&quot; containers, set parent to self</span>
    <span class="n">new_residue</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="c1"># Reformat indices</span>
    <span class="c1"># new_residue.start_index = atom_start_index</span>
    <span class="c1"># self._atoms.reindex(start_at=atom_start_index)  # Called in self._residues.reindex</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_residues</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">start_at</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>  <span class="c1"># .set_index()</span>
    <span class="c1"># Insert new_residue index and atom_indices into Structure indices</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_insert_indices</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;residue&#39;</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_insert_indices</span><span class="p">(</span><span class="n">atom_start_index</span><span class="p">,</span> <span class="n">new_residue</span><span class="o">.</span><span class="n">atom_indices</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;atom&#39;</span><span class="p">)</span>

    <span class="c1"># Set the new chain_id. Must occur after self._residue_indices update if chain isn&#39;t provided</span>
    <span class="k">if</span> <span class="n">chain_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Try to solve without it...</span>
        <span class="k">if</span> <span class="n">prev_residue</span> <span class="ow">and</span> <span class="n">next_residue</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prev_residue</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">==</span> <span class="n">next_residue</span><span class="o">.</span><span class="n">chain_id</span><span class="p">:</span>
                <span class="n">chain_id</span> <span class="o">=</span> <span class="n">prev_residue</span><span class="o">.</span><span class="n">chain_id</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># There is a discrepancy which means this is an internal termini</span>
                <span class="k">raise</span> <span class="n">stutils</span><span class="o">.</span><span class="n">DesignError</span><span class="p">(</span><span class="n">chain_assignment_error</span><span class="p">)</span>
        <span class="c1"># This can be solved as it represents an absolute termini case</span>
        <span class="k">elif</span> <span class="n">prev_residue</span><span class="p">:</span>
            <span class="n">chain_id</span> <span class="o">=</span> <span class="n">prev_residue</span><span class="o">.</span><span class="n">chain_id</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chain_id</span> <span class="o">=</span> <span class="n">next_residue</span><span class="o">.</span><span class="n">chain_id</span>
    <span class="n">new_residue</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">=</span> <span class="n">chain_id</span>

    <span class="c1"># Solve the Residue number and renumber Structure if there is overlap</span>
    <span class="k">if</span> <span class="n">prev_residue</span> <span class="ow">and</span> <span class="n">next_residue</span><span class="p">:</span>
        <span class="n">tentative_number</span> <span class="o">=</span> <span class="n">prev_residue</span><span class="o">.</span><span class="n">number</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">tentative_number</span> <span class="o">==</span> <span class="n">next_residue</span><span class="o">.</span><span class="n">number</span><span class="p">:</span>
            <span class="c1"># There is a conflicting insertion</span>
            <span class="c1"># The prev_residue could also be inserted and needed to be numbered lower</span>
            <span class="k">try</span><span class="p">:</span>  <span class="c1"># Check residue._insert</span>
                <span class="n">prev_residue</span><span class="o">.</span><span class="n">_insert</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># Not inserted. Renumber all subsequent</span>
                <span class="c1"># self.renumber_residues()</span>
                <span class="n">residues_renumber</span> <span class="o">=</span> <span class="n">residues</span><span class="p">[</span><span class="n">index</span><span class="p">:]</span>
                <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues_renumber</span><span class="p">:</span>
                    <span class="n">residue</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">residue</span><span class="o">.</span><span class="n">number</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">prev_residue</span><span class="o">.</span><span class="n">get_upstream</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">prev_residue</span><span class="p">]:</span>
                    <span class="n">residue</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">residue</span><span class="o">.</span><span class="n">number</span> <span class="o">-</span> <span class="mi">1</span>

        <span class="n">new_residue</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">tentative_number</span>
    <span class="k">elif</span> <span class="n">prev_residue</span><span class="p">:</span>
        <span class="n">new_residue</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">prev_residue</span><span class="o">.</span><span class="n">number</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># next_residue</span>
        <span class="c1"># This cautionary note may not apply anymore</span>
        <span class="c1">#  Subtracting one may not be enough if this insert_residue_type() is part of a set of inserts and all</span>
        <span class="c1">#  n-terminal insertions are being conducted before this next_residue. Clean this in the first check of</span>
        <span class="c1">#  this logic block</span>
        <span class="n">new_residue</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">next_residue</span><span class="o">.</span><span class="n">number</span> <span class="o">-</span> <span class="mi">1</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">secondary_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_secondary_structure</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># When not set yet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate_secondary_structure</span><span class="p">()</span>  <span class="c1"># The new_residue will be included</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Insert the new ss with a coiled assumption</span>
        <span class="c1"># ASSUME the insertion is disordered and coiled segment</span>
        <span class="n">new_residue</span><span class="o">.</span><span class="n">secondary_structure</span> <span class="o">=</span> <span class="n">DEFAULT_SS_COIL_IDENTIFIER</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_secondary_structure</span> <span class="o">=</span> \
            <span class="n">secondary_structure</span><span class="p">[:</span><span class="n">index</span><span class="p">]</span> <span class="o">+</span> <span class="n">DEFAULT_SS_COIL_IDENTIFIER</span> <span class="o">+</span> <span class="n">secondary_structure</span><span class="p">[</span><span class="n">index</span><span class="p">:]</span>

    <span class="c1"># Reindex the coords/residues map</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">new_residue</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.insert_residues" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">insert_residues</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">insert_residues</span><span class="p">(</span><span class="n">index</span><span class="p">:</span> <span class="n">int</span><span class="p">,</span> <span class="n">new_residues</span><span class="p">:</span> <span class="n"><span title="collections.abc.Iterable">Iterable</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">],</span> <span class="n">chain_id</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Insert Residue instances into the Structure at the origin. No structural alignment is performed!</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>index</code></b>
            (<code>int</code>)
        
        <div class="doc-md-description">
          <p>The index to perform the insertion at</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>new_residues</code></b>
            (<code><span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>)
        
        <div class="doc-md-description">
          <p>The Residue instances to insert</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>chain_id</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The chain identifier to associate the new Residue instances with</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>
        
        <div class="doc-md-description">
          <p>The inserted Residue instances</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4546</span>
<span class="normal">4547</span>
<span class="normal">4548</span>
<span class="normal">4549</span>
<span class="normal">4550</span>
<span class="normal">4551</span>
<span class="normal">4552</span>
<span class="normal">4553</span>
<span class="normal">4554</span>
<span class="normal">4555</span>
<span class="normal">4556</span>
<span class="normal">4557</span>
<span class="normal">4558</span>
<span class="normal">4559</span>
<span class="normal">4560</span>
<span class="normal">4561</span>
<span class="normal">4562</span>
<span class="normal">4563</span>
<span class="normal">4564</span>
<span class="normal">4565</span>
<span class="normal">4566</span>
<span class="normal">4567</span>
<span class="normal">4568</span>
<span class="normal">4569</span>
<span class="normal">4570</span>
<span class="normal">4571</span>
<span class="normal">4572</span>
<span class="normal">4573</span>
<span class="normal">4574</span>
<span class="normal">4575</span>
<span class="normal">4576</span>
<span class="normal">4577</span>
<span class="normal">4578</span>
<span class="normal">4579</span>
<span class="normal">4580</span>
<span class="normal">4581</span>
<span class="normal">4582</span>
<span class="normal">4583</span>
<span class="normal">4584</span>
<span class="normal">4585</span>
<span class="normal">4586</span>
<span class="normal">4587</span>
<span class="normal">4588</span>
<span class="normal">4589</span>
<span class="normal">4590</span>
<span class="normal">4591</span>
<span class="normal">4592</span>
<span class="normal">4593</span>
<span class="normal">4594</span>
<span class="normal">4595</span>
<span class="normal">4596</span>
<span class="normal">4597</span>
<span class="normal">4598</span>
<span class="normal">4599</span>
<span class="normal">4600</span>
<span class="normal">4601</span>
<span class="normal">4602</span>
<span class="normal">4603</span>
<span class="normal">4604</span>
<span class="normal">4605</span>
<span class="normal">4606</span>
<span class="normal">4607</span>
<span class="normal">4608</span>
<span class="normal">4609</span>
<span class="normal">4610</span>
<span class="normal">4611</span>
<span class="normal">4612</span>
<span class="normal">4613</span>
<span class="normal">4614</span>
<span class="normal">4615</span>
<span class="normal">4616</span>
<span class="normal">4617</span>
<span class="normal">4618</span>
<span class="normal">4619</span>
<span class="normal">4620</span>
<span class="normal">4621</span>
<span class="normal">4622</span>
<span class="normal">4623</span>
<span class="normal">4624</span>
<span class="normal">4625</span>
<span class="normal">4626</span>
<span class="normal">4627</span>
<span class="normal">4628</span>
<span class="normal">4629</span>
<span class="normal">4630</span>
<span class="normal">4631</span>
<span class="normal">4632</span>
<span class="normal">4633</span>
<span class="normal">4634</span>
<span class="normal">4635</span>
<span class="normal">4636</span>
<span class="normal">4637</span>
<span class="normal">4638</span>
<span class="normal">4639</span>
<span class="normal">4640</span>
<span class="normal">4641</span>
<span class="normal">4642</span>
<span class="normal">4643</span>
<span class="normal">4644</span>
<span class="normal">4645</span>
<span class="normal">4646</span>
<span class="normal">4647</span>
<span class="normal">4648</span>
<span class="normal">4649</span>
<span class="normal">4650</span>
<span class="normal">4651</span>
<span class="normal">4652</span>
<span class="normal">4653</span>
<span class="normal">4654</span>
<span class="normal">4655</span>
<span class="normal">4656</span>
<span class="normal">4657</span>
<span class="normal">4658</span>
<span class="normal">4659</span>
<span class="normal">4660</span>
<span class="normal">4661</span>
<span class="normal">4662</span>
<span class="normal">4663</span>
<span class="normal">4664</span>
<span class="normal">4665</span>
<span class="normal">4666</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">insert_residues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">new_residues</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">Residue</span><span class="p">],</span> <span class="n">chain_id</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">Residue</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Insert Residue instances into the Structure at the origin. No structural alignment is performed!</span>

<span class="sd">    Args:</span>
<span class="sd">        index: The index to perform the insertion at</span>
<span class="sd">        new_residues: The Residue instances to insert</span>
<span class="sd">        chain_id: The chain identifier to associate the new Residue instances with</span>

<span class="sd">    Returns:</span>
<span class="sd">        The inserted Residue instances</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">new_residues</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_dependent</span><span class="p">():</span>  <span class="c1"># Call on the parent</span>
        <span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">insert_residues</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> can&#39;t be performed on a dependent StructureBase. &quot;</span>
                       <span class="sa">f</span><span class="s2">&quot;Calling on the </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">.parent </span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">_parent</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># Ensure the deletion is done by the Structure parent to account for everything correctly</span>
        <span class="k">if</span> <span class="n">chain_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">chain_id</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;chain_id&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">_parent</span><span class="o">.</span><span class="n">insert_residues</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">new_residues</span><span class="p">,</span> <span class="n">chain_id</span><span class="o">=</span><span class="n">chain_id</span><span class="p">)</span>

    <span class="c1"># Make a copy of the Residue instances</span>
    <span class="n">new_residues</span> <span class="o">=</span> <span class="p">[</span><span class="n">residue</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">new_residues</span><span class="p">]</span>
    <span class="n">number_new_residues</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_residues</span><span class="p">)</span>

    <span class="c1"># Find the prior and next Residue, atom_start_index (starting atom in new Residue index)</span>
    <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># n-termini = True</span>
        <span class="n">prev_residue</span> <span class="o">=</span> <span class="n">_prev_residue</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">atom_start_index</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">prev_residue</span> <span class="o">=</span> <span class="n">_prev_residue</span> <span class="o">=</span> <span class="n">residues</span><span class="p">[</span><span class="n">index</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">atom_start_index</span> <span class="o">=</span> <span class="n">prev_residue</span><span class="o">.</span><span class="n">end_index</span> <span class="o">+</span> <span class="mi">1</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">next_residue</span> <span class="o">=</span> <span class="n">residues</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>  <span class="c1"># c_termini = True</span>
        <span class="n">next_residue</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">prev_residue</span><span class="p">:</span>  <span class="c1"># Insertion on an empty Structure? block for now to simplify chain identification</span>
            <span class="k">raise</span> <span class="n">stutils</span><span class="o">.</span><span class="n">DesignError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Can&#39;t </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">insert_residue_type</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> for an empty </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> class&quot;</span><span class="p">)</span>

    <span class="c1"># Set found attributes</span>
    <span class="c1"># prev_residue, *other_residues = new_residues</span>
    <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">new_residues</span><span class="p">:</span>
        <span class="n">residue</span><span class="o">.</span><span class="n">_insert</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># Insert the new_residue coords, atoms, and residues into the Structure</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_coords</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">atom_start_index</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">residue</span><span class="o">.</span><span class="n">coords</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">new_residues</span><span class="p">]))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_atoms</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">atom_start_index</span><span class="p">,</span> <span class="p">[</span><span class="n">atom</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">new_residues</span> <span class="k">for</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">residue</span><span class="o">.</span><span class="n">atoms</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_residues</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">new_residues</span><span class="p">)</span>
    <span class="c1"># After coords, atoms, residues insertion into &quot;_&quot; containers, set parent to self</span>
    <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">new_residues</span><span class="p">:</span>
        <span class="n">residue</span><span class="o">.</span><span class="n">_parent</span> <span class="o">=</span> <span class="bp">self</span>

    <span class="c1"># Reformat indices</span>
    <span class="c1"># new_residue.start_index = atom_start_index</span>
    <span class="c1"># self._atoms.reindex(start_at=atom_start_index)  # Called in self._residues.reindex</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_residues</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">start_at</span><span class="o">=</span><span class="n">index</span><span class="p">)</span>  <span class="c1"># .set_index()</span>
    <span class="c1"># Insert new_residue index and atom_indices into Structure indices</span>
    <span class="n">new_residue_atom_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">atom_start_index</span><span class="p">,</span> <span class="n">new_residues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">end_index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_insert_indices</span><span class="p">(</span><span class="n">atom_start_index</span><span class="p">,</span> <span class="n">new_residue_atom_indices</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;atom&#39;</span><span class="p">)</span>
    <span class="n">new_residue_indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">index</span> <span class="o">+</span> <span class="n">number_new_residues</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_insert_indices</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">new_residue_indices</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;residue&#39;</span><span class="p">)</span>

    <span class="c1"># Set the new chain_id. Must occur after self._residue_indices update if chain isn&#39;t provided</span>
    <span class="k">if</span> <span class="n">chain_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Try to solve without it...</span>
        <span class="k">if</span> <span class="n">prev_residue</span> <span class="ow">and</span> <span class="n">next_residue</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">prev_residue</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">==</span> <span class="n">next_residue</span><span class="o">.</span><span class="n">chain_id</span><span class="p">:</span>
                <span class="n">chain_id</span> <span class="o">=</span> <span class="n">prev_residue</span><span class="o">.</span><span class="n">chain_id</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># There is a discrepancy which means this is an internal termini</span>
                <span class="k">raise</span> <span class="n">stutils</span><span class="o">.</span><span class="n">DesignError</span><span class="p">(</span><span class="n">chain_assignment_error</span><span class="p">)</span>
        <span class="c1"># This can be solved as it represents an absolute termini case</span>
        <span class="k">elif</span> <span class="n">prev_residue</span><span class="p">:</span>
            <span class="n">chain_id</span> <span class="o">=</span> <span class="n">prev_residue</span><span class="o">.</span><span class="n">chain_id</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chain_id</span> <span class="o">=</span> <span class="n">next_residue</span><span class="o">.</span><span class="n">chain_id</span>
    <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">new_residues</span><span class="p">:</span>
        <span class="n">residue</span><span class="o">.</span><span class="n">chain_id</span> <span class="o">=</span> <span class="n">chain_id</span>

    <span class="c1"># Solve the Residue number and renumber Structure if there is overlap</span>
    <span class="k">if</span> <span class="n">prev_residue</span> <span class="ow">and</span> <span class="n">next_residue</span><span class="p">:</span>
        <span class="n">first_number</span> <span class="o">=</span> <span class="n">prev_residue</span><span class="o">.</span><span class="n">number</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">tentative_residue_numbers</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">first_number</span><span class="p">,</span> <span class="n">first_number</span> <span class="o">+</span> <span class="n">number_new_residues</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">next_residue</span><span class="o">.</span><span class="n">number</span> <span class="ow">in</span> <span class="n">tentative_residue_numbers</span><span class="p">:</span>
            <span class="c1"># There is a conflicting insertion. Correct existing residue numbers</span>
            <span class="c1"># The prev_residue could also be inserted and needed to be numbered lower</span>
            <span class="k">try</span><span class="p">:</span>  <span class="c1"># Check residue._insert</span>
                <span class="n">prev_residue</span><span class="o">.</span><span class="n">_insert</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># Not inserted. Renumber all subsequent</span>
                <span class="c1"># self.renumber_residues()</span>
                <span class="n">residues_renumber</span> <span class="o">=</span> <span class="n">residues</span><span class="p">[</span><span class="n">index</span><span class="p">:]</span>
                <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues_renumber</span><span class="p">:</span>
                    <span class="n">residue</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">residue</span><span class="o">.</span><span class="n">number</span> <span class="o">+</span> <span class="n">number_new_residues</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">prev_residue</span><span class="o">.</span><span class="n">get_upstream</span><span class="p">()</span> <span class="o">+</span> <span class="p">[</span><span class="n">prev_residue</span><span class="p">]:</span>
                    <span class="n">residue</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">residue</span><span class="o">.</span><span class="n">number</span> <span class="o">-</span> <span class="n">number_new_residues</span>
        <span class="c1"># Set the new numbers</span>
        <span class="k">for</span> <span class="n">residue</span><span class="p">,</span> <span class="n">new_number</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">new_residues</span><span class="p">,</span> <span class="n">tentative_residue_numbers</span><span class="p">):</span>
            <span class="n">residue</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">new_number</span>
    <span class="k">elif</span> <span class="n">prev_residue</span><span class="p">:</span>
        <span class="n">_prev_residue</span> <span class="o">=</span> <span class="n">prev_residue</span>
        <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">new_residues</span><span class="p">:</span>
            <span class="n">residue</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">_prev_residue</span><span class="o">.</span><span class="n">number</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">_prev_residue</span> <span class="o">=</span> <span class="n">residue</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># next_residue</span>
        <span class="c1"># This cautionary note may not apply to insert_residues(</span>
        <span class="c1">#  Subtracting one may not be enough if insert_residues() is part of a set of inserts and all</span>
        <span class="c1">#  n-terminal insertions are being conducted before this next_residue. Clean this in the first check of</span>
        <span class="c1">#  this logic block</span>
        <span class="n">_prev_residue</span> <span class="o">=</span> <span class="n">next_residue</span>
        <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">new_residues</span><span class="p">):</span>
            <span class="n">residue</span><span class="o">.</span><span class="n">number</span> <span class="o">=</span> <span class="n">_prev_residue</span><span class="o">.</span><span class="n">number</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">_prev_residue</span> <span class="o">=</span> <span class="n">residue</span>

    <span class="c1"># Reindex the coords/residues map</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">reset_state</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">new_residues</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.delete_termini" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">delete_termini</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">delete_termini</span><span class="p">(</span><span class="n">how</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="s1">&#39;unstructured&#39;</span><span class="p">,</span> <span class="n">termini</span><span class="p">:</span> <span class="n"><span title="structure.utils.termini_literal">termini_literal</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Remove Residue instances from the Structure termini that are not helices</p>
<p>Uses the default secondary structure prediction program's SS_HELIX_IDENTIFIERS (typically 'H') to search for
non-conforming secondary structure</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>how</code></b>
            (<code>str</code>, default:
                <code>&#39;unstructured&#39;</code>
)
        
        <div class="doc-md-description">
          <p>How should termini be trimmed? Either 'unstructured' (default) or 'to_helices' can be used.
If 'unstructured',
    will use 'SS_DISORDER_IDENTIFIERS' (typically coil) to detect disorder. Function will then remove any
    disordered segments, as well as turns ('T') that exist between disordered segments
If 'to_helices',
    will use 'SS_HELIX_IDENTIFIERS' (typically 'H') to remove any non-conforming secondary structure
    elements until a helix is reached</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>termini</code></b>
            (<code><span title="structure.utils.termini_literal">termini_literal</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>If a specific termini should be targeted, which one?</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4668</span>
<span class="normal">4669</span>
<span class="normal">4670</span>
<span class="normal">4671</span>
<span class="normal">4672</span>
<span class="normal">4673</span>
<span class="normal">4674</span>
<span class="normal">4675</span>
<span class="normal">4676</span>
<span class="normal">4677</span>
<span class="normal">4678</span>
<span class="normal">4679</span>
<span class="normal">4680</span>
<span class="normal">4681</span>
<span class="normal">4682</span>
<span class="normal">4683</span>
<span class="normal">4684</span>
<span class="normal">4685</span>
<span class="normal">4686</span>
<span class="normal">4687</span>
<span class="normal">4688</span>
<span class="normal">4689</span>
<span class="normal">4690</span>
<span class="normal">4691</span>
<span class="normal">4692</span>
<span class="normal">4693</span>
<span class="normal">4694</span>
<span class="normal">4695</span>
<span class="normal">4696</span>
<span class="normal">4697</span>
<span class="normal">4698</span>
<span class="normal">4699</span>
<span class="normal">4700</span>
<span class="normal">4701</span>
<span class="normal">4702</span>
<span class="normal">4703</span>
<span class="normal">4704</span>
<span class="normal">4705</span>
<span class="normal">4706</span>
<span class="normal">4707</span>
<span class="normal">4708</span>
<span class="normal">4709</span>
<span class="normal">4710</span>
<span class="normal">4711</span>
<span class="normal">4712</span>
<span class="normal">4713</span>
<span class="normal">4714</span>
<span class="normal">4715</span>
<span class="normal">4716</span>
<span class="normal">4717</span>
<span class="normal">4718</span>
<span class="normal">4719</span>
<span class="normal">4720</span>
<span class="normal">4721</span>
<span class="normal">4722</span>
<span class="normal">4723</span>
<span class="normal">4724</span>
<span class="normal">4725</span>
<span class="normal">4726</span>
<span class="normal">4727</span>
<span class="normal">4728</span>
<span class="normal">4729</span>
<span class="normal">4730</span>
<span class="normal">4731</span>
<span class="normal">4732</span>
<span class="normal">4733</span>
<span class="normal">4734</span>
<span class="normal">4735</span>
<span class="normal">4736</span>
<span class="normal">4737</span>
<span class="normal">4738</span>
<span class="normal">4739</span>
<span class="normal">4740</span>
<span class="normal">4741</span>
<span class="normal">4742</span>
<span class="normal">4743</span>
<span class="normal">4744</span>
<span class="normal">4745</span>
<span class="normal">4746</span>
<span class="normal">4747</span>
<span class="normal">4748</span>
<span class="normal">4749</span>
<span class="normal">4750</span>
<span class="normal">4751</span>
<span class="normal">4752</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">delete_termini</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">how</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s1">&#39;unstructured&#39;</span><span class="p">,</span> <span class="n">termini</span><span class="p">:</span> <span class="n">stutils</span><span class="o">.</span><span class="n">termini_literal</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Remove Residue instances from the Structure termini that are not helices</span>

<span class="sd">    Uses the default secondary structure prediction program&#39;s SS_HELIX_IDENTIFIERS (typically &#39;H&#39;) to search for</span>
<span class="sd">    non-conforming secondary structure</span>

<span class="sd">    Args:</span>
<span class="sd">        how: How should termini be trimmed? Either &#39;unstructured&#39; (default) or &#39;to_helices&#39; can be used.</span>
<span class="sd">            If &#39;unstructured&#39;,</span>
<span class="sd">                will use &#39;SS_DISORDER_IDENTIFIERS&#39; (typically coil) to detect disorder. Function will then remove any</span>
<span class="sd">                disordered segments, as well as turns (&#39;T&#39;) that exist between disordered segments</span>
<span class="sd">            If &#39;to_helices&#39;,</span>
<span class="sd">                will use &#39;SS_HELIX_IDENTIFIERS&#39; (typically &#39;H&#39;) to remove any non-conforming secondary structure</span>
<span class="sd">                elements until a helix is reached</span>
<span class="sd">        termini: If a specific termini should be targeted, which one?</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">termini</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">termini</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;nc&#39;</span><span class="p">:</span>
        <span class="n">termini_</span> <span class="o">=</span> <span class="s1">&#39;nc&#39;</span>
    <span class="k">elif</span> <span class="n">termini</span> <span class="ow">in</span> <span class="s1">&#39;NnCc&#39;</span><span class="p">:</span>  <span class="c1"># Only one of the two</span>
        <span class="n">termini_</span> <span class="o">=</span> <span class="n">termini</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;termini&#39; must be one of &#39;n&#39; or &#39;c&#39;, not &#39;</span><span class="si">{</span><span class="n">termini</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">secondary_structure</span> <span class="o">=</span> <span class="n">working_secondary_structure</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondary_structure</span>
    <span class="n">number_of_residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_residues</span>
    <span class="c1"># no_nterm_disorder_ss = secondary_structure.lstrip(SS_DISORDER_IDENTIFIERS)</span>
    <span class="c1"># n_removed_nterm_res = number_of_residues - len(no_nterm_disorder_ss)</span>
    <span class="c1"># no_cterm_disorder_ss = secondary_structure.rstrip(SS_DISORDER_IDENTIFIERS)</span>
    <span class="c1"># n_removed_cterm_res = number_of_residues - len(no_cterm_disorder_ss)</span>
    <span class="c1"># sasa = self.relative_sasa</span>
    <span class="c1"># self.log.debug(f&#39;Found n-term relative sasa {sasa[:n_removed_nterm_res + 10]}&#39;)</span>
    <span class="c1"># self.log.debug(f&#39;Found c-term relative sasa {sasa[-(n_removed_cterm_res + 10):]}&#39;)</span>

    <span class="n">n_removed_nterm_res</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c1"># Remove coils. Find the next coil. If only ss present is (T)urn, then remove that as well and start again</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">termini</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="s1">&#39;NC&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># n-termini</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Starting N-term is: </span><span class="si">{</span><span class="n">working_secondary_structure</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">possible_secondary_structure</span> <span class="o">=</span> <span class="n">working_secondary_structure</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># c-termini</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;N-term is: </span><span class="si">{</span><span class="n">working_secondary_structure</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="c1"># Get the number of n-termini removed</span>
            <span class="n">n_removed_nterm_res</span> <span class="o">=</span> <span class="n">number_of_residues</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">working_secondary_structure</span><span class="p">)</span>
            <span class="c1"># Reverse the sequence to get the c-termini first</span>
            <span class="n">possible_secondary_structure</span> <span class="o">=</span> <span class="n">working_secondary_structure</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Starting C-term (reversed) is: </span><span class="si">{</span><span class="n">possible_secondary_structure</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">how</span> <span class="o">==</span> <span class="s1">&#39;to_helices&#39;</span><span class="p">:</span>
            <span class="n">ss_helix_index</span> <span class="o">=</span> <span class="n">possible_secondary_structure</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">SS_HELIX_IDENTIFIERS</span><span class="p">)</span>
            <span class="n">working_secondary_structure</span> <span class="o">=</span> <span class="n">working_secondary_structure</span><span class="p">[</span><span class="n">ss_helix_index</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># how == &#39;unstructured&#39;</span>
            <span class="n">ss_disorder_index</span> <span class="o">=</span> <span class="n">possible_secondary_structure</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">SS_DISORDER_IDENTIFIERS</span><span class="p">)</span>
            <span class="k">while</span> <span class="n">ss_disorder_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Go again</span>
                <span class="c1"># Remove DISORDER ss</span>
                <span class="n">working_secondary_structure</span> <span class="o">=</span> <span class="n">possible_secondary_structure</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="n">SS_DISORDER_IDENTIFIERS</span><span class="p">)</span>
                <span class="c1"># Next try to remove TURN ss. Only remove if it is between DISORDER segments</span>
                <span class="n">possible_secondary_structure</span> <span class="o">=</span> <span class="n">working_secondary_structure</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="n">SS_TURN_IDENTIFIERS</span><span class="p">)</span>
                <span class="n">ss_disorder_index</span> <span class="o">=</span> <span class="n">possible_secondary_structure</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">SS_DISORDER_IDENTIFIERS</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;C-term (reversed) is: </span><span class="si">{</span><span class="n">working_secondary_structure</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span>
    <span class="n">_delete_residues</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">context_length</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="k">if</span> <span class="s1">&#39;n&#39;</span> <span class="ow">in</span> <span class="n">termini_</span> <span class="ow">and</span> <span class="n">n_removed_nterm_res</span><span class="p">:</span>
        <span class="n">old_ss</span> <span class="o">=</span> <span class="n">secondary_structure</span><span class="p">[:</span><span class="n">n_removed_nterm_res</span> <span class="o">+</span> <span class="n">context_length</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Found N-term secondary_structure </span><span class="si">{</span><span class="n">secondary_structure</span><span class="p">[:</span><span class="n">n_removed_nterm_res</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing </span><span class="si">{</span><span class="n">n_removed_nterm_res</span><span class="si">}</span><span class="s2"> N-terminal residues. Resulting secondary structure:</span><span class="se">\n</span><span class="s2">&quot;</span>
                      <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">old : </span><span class="si">{</span><span class="n">old_ss</span><span class="si">}</span><span class="s2">...</span><span class="se">\n</span><span class="s2">&quot;</span>
                      <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">new : </span><span class="si">{</span><span class="s1">&#39;-&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n_removed_nterm_res</span><span class="si">}{</span><span class="n">old_ss</span><span class="p">[</span><span class="n">n_removed_nterm_res</span><span class="p">:]</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
        <span class="n">_delete_residues</span> <span class="o">+=</span> <span class="n">residues</span><span class="p">[:</span><span class="n">n_removed_nterm_res</span><span class="p">]</span>

    <span class="c1"># Get the number of c-termini removed</span>
    <span class="n">n_removed_cterm_res</span> <span class="o">=</span> <span class="n">number_of_residues</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">working_secondary_structure</span><span class="p">)</span> <span class="o">-</span> <span class="n">n_removed_nterm_res</span>
    <span class="k">if</span> <span class="s1">&#39;c&#39;</span> <span class="ow">in</span> <span class="n">termini_</span> <span class="ow">and</span> <span class="n">n_removed_cterm_res</span><span class="p">:</span>
        <span class="n">c_term_index</span> <span class="o">=</span> <span class="n">number_of_residues</span> <span class="o">-</span> <span class="n">n_removed_cterm_res</span>
        <span class="n">old_ss</span> <span class="o">=</span> <span class="n">secondary_structure</span><span class="p">[</span><span class="n">c_term_index</span> <span class="o">-</span> <span class="n">context_length</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Found C-term secondary_structure </span><span class="si">{</span><span class="n">secondary_structure</span><span class="p">[</span><span class="o">-</span><span class="p">(</span><span class="n">n_removed_cterm_res</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">5</span><span class="p">):]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Removing </span><span class="si">{</span><span class="n">n_removed_cterm_res</span><span class="si">}</span><span class="s2"> C-terminal residues. Resulting secondary structure:</span><span class="se">\n</span><span class="s2">&quot;</span>
                      <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">old :...</span><span class="si">{</span><span class="n">old_ss</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span>
                      <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">new :...</span><span class="si">{</span><span class="n">old_ss</span><span class="p">[:</span><span class="o">-</span><span class="n">n_removed_cterm_res</span><span class="p">]</span><span class="si">}{</span><span class="s1">&#39;-&#39;</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">n_removed_cterm_res</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">_delete_residues</span> <span class="o">+=</span> <span class="n">residues</span><span class="p">[</span><span class="n">c_term_index</span><span class="p">:]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">delete_residues</span><span class="p">(</span><span class="n">_delete_residues</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.local_density" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">local_density</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">local_density</span><span class="p">(</span><span class="n">residues</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">residue_numbers</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="mf">12.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Return the number of Atoms within 'distance' Angstroms of each Atom in the requested Residues</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>residues</code></b>
            (<code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The Residues to include in the calculation</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>residue_numbers</code></b>
            (<code>list[int]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The numbers of the Residues to include in the calculation</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>distance</code></b>
            (<code>float</code>, default:
                <code>12.0</code>
)
        
        <div class="doc-md-description">
          <p>The cutoff distance with which Atoms should be included in local density</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[float]</code>
        
        <div class="doc-md-description">
          <p>An array like containing the local density around each requested Residue</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4754</span>
<span class="normal">4755</span>
<span class="normal">4756</span>
<span class="normal">4757</span>
<span class="normal">4758</span>
<span class="normal">4759</span>
<span class="normal">4760</span>
<span class="normal">4761</span>
<span class="normal">4762</span>
<span class="normal">4763</span>
<span class="normal">4764</span>
<span class="normal">4765</span>
<span class="normal">4766</span>
<span class="normal">4767</span>
<span class="normal">4768</span>
<span class="normal">4769</span>
<span class="normal">4770</span>
<span class="normal">4771</span>
<span class="normal">4772</span>
<span class="normal">4773</span>
<span class="normal">4774</span>
<span class="normal">4775</span>
<span class="normal">4776</span>
<span class="normal">4777</span>
<span class="normal">4778</span>
<span class="normal">4779</span>
<span class="normal">4780</span>
<span class="normal">4781</span>
<span class="normal">4782</span>
<span class="normal">4783</span>
<span class="normal">4784</span>
<span class="normal">4785</span>
<span class="normal">4786</span>
<span class="normal">4787</span>
<span class="normal">4788</span>
<span class="normal">4789</span>
<span class="normal">4790</span>
<span class="normal">4791</span>
<span class="normal">4792</span>
<span class="normal">4793</span>
<span class="normal">4794</span>
<span class="normal">4795</span>
<span class="normal">4796</span>
<span class="normal">4797</span>
<span class="normal">4798</span>
<span class="normal">4799</span>
<span class="normal">4800</span>
<span class="normal">4801</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">local_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residues</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Residue</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">residue_numbers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">12.</span><span class="p">)</span> \
        <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Return the number of Atoms within &#39;distance&#39; Angstroms of each Atom in the requested Residues</span>

<span class="sd">    Args:</span>
<span class="sd">        residues: The Residues to include in the calculation</span>
<span class="sd">        residue_numbers: The numbers of the Residues to include in the calculation</span>
<span class="sd">        distance: The cutoff distance with which Atoms should be included in local density</span>

<span class="sd">    Returns:</span>
<span class="sd">        An array like containing the local density around each requested Residue</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">residues</span><span class="p">:</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
            <span class="n">coords</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">heavy_coords</span><span class="p">)</span>
        <span class="n">coords_indexed_residues</span> <span class="o">=</span> <span class="p">[</span><span class="n">residue</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">residue</span><span class="o">.</span><span class="n">heavy_indices</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">residue_numbers</span><span class="p">:</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_residues</span><span class="p">(</span><span class="n">numbers</span><span class="o">=</span><span class="n">residue_numbers</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
            <span class="n">coords</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">heavy_coords</span><span class="p">)</span>
        <span class="n">coords_indexed_residues</span> <span class="o">=</span> <span class="p">[</span><span class="n">residue</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">residue</span><span class="o">.</span><span class="n">heavy_indices</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># use all Residue instances</span>
        <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span>
        <span class="n">coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">heavy_coords</span>
        <span class="n">coords_indexed_residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">heavy_coords_indexed_residues</span>

    <span class="c1"># in case this was already called, we should set all to 0.</span>
    <span class="k">if</span> <span class="n">residues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">local_density</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
            <span class="n">residue</span><span class="o">.</span><span class="n">local_density</span> <span class="o">=</span> <span class="mf">0.</span>

    <span class="n">all_atom_tree</span> <span class="o">=</span> <span class="n">BallTree</span><span class="p">(</span><span class="n">coords</span><span class="p">)</span>
    <span class="n">all_atom_counts_query</span> <span class="o">=</span> <span class="n">all_atom_tree</span><span class="o">.</span><span class="n">query_radius</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">distance</span><span class="p">,</span> <span class="n">count_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># residue_neighbor_counts, current_residue = 0, coords_indexed_residues[0]</span>
    <span class="n">current_residue</span> <span class="o">=</span> <span class="n">coords_indexed_residues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">residue</span><span class="p">,</span> <span class="n">atom_neighbor_counts</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">coords_indexed_residues</span><span class="p">,</span> <span class="n">all_atom_counts_query</span><span class="o">.</span><span class="n">tolist</span><span class="p">()):</span>
        <span class="k">if</span> <span class="n">residue</span> <span class="o">==</span> <span class="n">current_residue</span><span class="p">:</span>
            <span class="n">current_residue</span><span class="o">.</span><span class="n">local_density</span> <span class="o">+=</span> <span class="n">atom_neighbor_counts</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># We have a new residue, find the average</span>
            <span class="n">current_residue</span><span class="o">.</span><span class="n">local_density</span> <span class="o">/=</span> <span class="n">current_residue</span><span class="o">.</span><span class="n">number_of_heavy_atoms</span>
            <span class="n">current_residue</span> <span class="o">=</span> <span class="n">residue</span>
            <span class="n">current_residue</span><span class="o">.</span><span class="n">local_density</span> <span class="o">+=</span> <span class="n">atom_neighbor_counts</span>
    <span class="c1"># Ensure the last residue is calculated</span>
    <span class="n">current_residue</span><span class="o">.</span><span class="n">local_density</span> <span class="o">/=</span> <span class="n">current_residue</span><span class="o">.</span><span class="n">number_of_heavy_atoms</span>  <span class="c1"># Find the average</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">residue</span><span class="o">.</span><span class="n">local_density</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.is_clash" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">is_clash</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">is_clash</span><span class="p">(</span><span class="n">measure</span><span class="p">:</span> <span class="n"><span title="structure.utils.coords_type_literal">coords_type_literal</span></span> <span class="o">=</span> <span class="n">stutils</span><span class="o">.</span><span class="n">default_clash_criteria</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="n">stutils</span><span class="o">.</span><span class="n">default_clash_distance</span><span class="p">,</span> <span class="n">warn</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">silence_exceptions</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">report_hydrogen</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Check if the Structure contains any self clashes. If clashes occur with the Backbone, return True. Reports
the Residue where the clash occurred and the clashing Atoms</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>measure</code></b>
            (<code><span title="structure.utils.coords_type_literal">coords_type_literal</span></code>, default:
                <code><span title="structure.utils.default_clash_criteria">default_clash_criteria</span></code>
)
        
        <div class="doc-md-description">
          <p>The atom type to measure clashing by</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>distance</code></b>
            (<code>float</code>, default:
                <code><span title="structure.utils.default_clash_distance">default_clash_distance</span></code>
)
        
        <div class="doc-md-description">
          <p>The distance which clashes should be checked</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>warn</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        
        <div class="doc-md-description">
          <p>Whether to emit warnings about identified clashes. Output grouped into measure vs non-measure</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>silence_exceptions</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        
        <div class="doc-md-description">
          <p>Whether to silence the raised ClashError and Return True instead</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>report_hydrogen</code></b>
            (<code>bool</code>, default:
                <code>False</code>
)
        
        <div class="doc-md-description">
          <p>Whether to report clashing hydrogen atoms</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>bool</code>
        
        <div class="doc-md-description">
          <p>True if the Structure clashes, False if not</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4803</span>
<span class="normal">4804</span>
<span class="normal">4805</span>
<span class="normal">4806</span>
<span class="normal">4807</span>
<span class="normal">4808</span>
<span class="normal">4809</span>
<span class="normal">4810</span>
<span class="normal">4811</span>
<span class="normal">4812</span>
<span class="normal">4813</span>
<span class="normal">4814</span>
<span class="normal">4815</span>
<span class="normal">4816</span>
<span class="normal">4817</span>
<span class="normal">4818</span>
<span class="normal">4819</span>
<span class="normal">4820</span>
<span class="normal">4821</span>
<span class="normal">4822</span>
<span class="normal">4823</span>
<span class="normal">4824</span>
<span class="normal">4825</span>
<span class="normal">4826</span>
<span class="normal">4827</span>
<span class="normal">4828</span>
<span class="normal">4829</span>
<span class="normal">4830</span>
<span class="normal">4831</span>
<span class="normal">4832</span>
<span class="normal">4833</span>
<span class="normal">4834</span>
<span class="normal">4835</span>
<span class="normal">4836</span>
<span class="normal">4837</span>
<span class="normal">4838</span>
<span class="normal">4839</span>
<span class="normal">4840</span>
<span class="normal">4841</span>
<span class="normal">4842</span>
<span class="normal">4843</span>
<span class="normal">4844</span>
<span class="normal">4845</span>
<span class="normal">4846</span>
<span class="normal">4847</span>
<span class="normal">4848</span>
<span class="normal">4849</span>
<span class="normal">4850</span>
<span class="normal">4851</span>
<span class="normal">4852</span>
<span class="normal">4853</span>
<span class="normal">4854</span>
<span class="normal">4855</span>
<span class="normal">4856</span>
<span class="normal">4857</span>
<span class="normal">4858</span>
<span class="normal">4859</span>
<span class="normal">4860</span>
<span class="normal">4861</span>
<span class="normal">4862</span>
<span class="normal">4863</span>
<span class="normal">4864</span>
<span class="normal">4865</span>
<span class="normal">4866</span>
<span class="normal">4867</span>
<span class="normal">4868</span>
<span class="normal">4869</span>
<span class="normal">4870</span>
<span class="normal">4871</span>
<span class="normal">4872</span>
<span class="normal">4873</span>
<span class="normal">4874</span>
<span class="normal">4875</span>
<span class="normal">4876</span>
<span class="normal">4877</span>
<span class="normal">4878</span>
<span class="normal">4879</span>
<span class="normal">4880</span>
<span class="normal">4881</span>
<span class="normal">4882</span>
<span class="normal">4883</span>
<span class="normal">4884</span>
<span class="normal">4885</span>
<span class="normal">4886</span>
<span class="normal">4887</span>
<span class="normal">4888</span>
<span class="normal">4889</span>
<span class="normal">4890</span>
<span class="normal">4891</span>
<span class="normal">4892</span>
<span class="normal">4893</span>
<span class="normal">4894</span>
<span class="normal">4895</span>
<span class="normal">4896</span>
<span class="normal">4897</span>
<span class="normal">4898</span>
<span class="normal">4899</span>
<span class="normal">4900</span>
<span class="normal">4901</span>
<span class="normal">4902</span>
<span class="normal">4903</span>
<span class="normal">4904</span>
<span class="normal">4905</span>
<span class="normal">4906</span>
<span class="normal">4907</span>
<span class="normal">4908</span>
<span class="normal">4909</span>
<span class="normal">4910</span>
<span class="normal">4911</span>
<span class="normal">4912</span>
<span class="normal">4913</span>
<span class="normal">4914</span>
<span class="normal">4915</span>
<span class="normal">4916</span>
<span class="normal">4917</span>
<span class="normal">4918</span>
<span class="normal">4919</span>
<span class="normal">4920</span>
<span class="normal">4921</span>
<span class="normal">4922</span>
<span class="normal">4923</span>
<span class="normal">4924</span>
<span class="normal">4925</span>
<span class="normal">4926</span>
<span class="normal">4927</span>
<span class="normal">4928</span>
<span class="normal">4929</span>
<span class="normal">4930</span>
<span class="normal">4931</span>
<span class="normal">4932</span>
<span class="normal">4933</span>
<span class="normal">4934</span>
<span class="normal">4935</span>
<span class="normal">4936</span>
<span class="normal">4937</span>
<span class="normal">4938</span>
<span class="normal">4939</span>
<span class="normal">4940</span>
<span class="normal">4941</span>
<span class="normal">4942</span>
<span class="normal">4943</span>
<span class="normal">4944</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_clash</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">measure</span><span class="p">:</span> <span class="n">stutils</span><span class="o">.</span><span class="n">coords_type_literal</span> <span class="o">=</span> <span class="n">stutils</span><span class="o">.</span><span class="n">default_clash_criteria</span><span class="p">,</span>
             <span class="n">distance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">stutils</span><span class="o">.</span><span class="n">default_clash_distance</span><span class="p">,</span>
             <span class="n">warn</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">silence_exceptions</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
             <span class="n">report_hydrogen</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Check if the Structure contains any self clashes. If clashes occur with the Backbone, return True. Reports</span>
<span class="sd">    the Residue where the clash occurred and the clashing Atoms</span>

<span class="sd">    Args:</span>
<span class="sd">        measure: The atom type to measure clashing by</span>
<span class="sd">        distance: The distance which clashes should be checked</span>
<span class="sd">        warn: Whether to emit warnings about identified clashes. Output grouped into measure vs non-measure</span>
<span class="sd">        silence_exceptions: Whether to silence the raised ClashError and Return True instead</span>
<span class="sd">        report_hydrogen: Whether to report clashing hydrogen atoms</span>

<span class="sd">    Raises:</span>
<span class="sd">        ClashError if the Structure has an identified clash</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the Structure clashes, False if not</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">measure</span> <span class="o">==</span> <span class="s1">&#39;backbone_and_cb&#39;</span><span class="p">:</span>
        <span class="n">other</span> <span class="o">=</span> <span class="s1">&#39;non-cb sidechain&#39;</span>
    <span class="k">elif</span> <span class="n">measure</span> <span class="o">==</span> <span class="s1">&#39;heavy&#39;</span><span class="p">:</span>
        <span class="n">other</span> <span class="o">=</span> <span class="s1">&#39;hydrogen&#39;</span>
        <span class="n">report_hydrogen</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">elif</span> <span class="n">measure</span> <span class="o">==</span> <span class="s1">&#39;backbone&#39;</span><span class="p">:</span>
        <span class="n">other</span> <span class="o">=</span> <span class="s1">&#39;sidechain&#39;</span>
    <span class="k">elif</span> <span class="n">measure</span> <span class="o">==</span> <span class="s1">&#39;cb&#39;</span><span class="p">:</span>
        <span class="n">other</span> <span class="o">=</span> <span class="s1">&#39;non-cb&#39;</span>
    <span class="k">elif</span> <span class="n">measure</span> <span class="o">==</span> <span class="s1">&#39;ca&#39;</span><span class="p">:</span>
        <span class="n">other</span> <span class="o">=</span> <span class="s1">&#39;non-ca&#39;</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># measure == &#39;all&#39;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="s1">&#39;solvent&#39;</span>  <span class="c1"># this should never appear unless someone added solvent parsing</span>

    <span class="n">coords_type</span> <span class="o">=</span> <span class="s1">&#39;coords&#39;</span> <span class="k">if</span> <span class="n">measure</span> <span class="o">==</span> <span class="s1">&#39;all&#39;</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">measure</span><span class="si">}</span><span class="s1">_coords&#39;</span>
    <span class="c1"># cant use heavy_coords as the Residue.atom_indices aren&#39;t offset for the BallTree made from them...</span>
    <span class="c1"># another option is to only care about heavy atoms on the residues...</span>
    <span class="c1"># if self.contains_hydrogen():</span>
    <span class="c1">#     atom_tree = BallTree(self.heavy_coords)</span>
    <span class="c1">#     coords_indexed_residues = self.heavy_coords_indexed_residues</span>
    <span class="c1">#     atoms = self.heavy_atoms</span>
    <span class="c1"># else:</span>

    <span class="c1"># Set up the query indices. BallTree is faster upon timeit with 131 msec/loop</span>
    <span class="n">atom_tree</span> <span class="o">=</span> <span class="n">BallTree</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coords</span><span class="p">)</span>
    <span class="n">atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>
    <span class="n">measured_clashes</span><span class="p">,</span> <span class="n">other_clashes</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>

    <span class="k">def</span> <span class="nf">return_true</span><span class="p">():</span> <span class="k">return</span> <span class="kc">True</span>

    <span class="n">clashes</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">_any_clashes</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">]],</span> <span class="nb">bool</span><span class="p">]</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Local helper to separate clash reporting from clash generation&quot;&quot;&quot;</span>
    <span class="n">clash_msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> contains Residue </span><span class="si">{</span><span class="n">measure</span><span class="si">}</span><span class="s1"> atom clashes at a </span><span class="si">{</span><span class="n">distance</span><span class="si">}</span><span class="s1"> A distance&#39;</span>
    <span class="k">if</span> <span class="n">warn</span><span class="p">:</span>

        <span class="k">def</span> <span class="nf">_any_clashes</span><span class="p">(</span><span class="n">_clash_indices</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="n">new_clashes</span> <span class="o">=</span> <span class="nb">any</span><span class="p">(</span><span class="n">_clash_indices</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">new_clashes</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">clashing_idx</span> <span class="ow">in</span> <span class="n">_clash_indices</span><span class="p">:</span>
                    <span class="n">atom</span> <span class="o">=</span> <span class="n">atoms</span><span class="p">[</span><span class="n">clashing_idx</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">atom</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;is_</span><span class="si">{</span><span class="n">measure</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">return_true</span><span class="p">)():</span>
                        <span class="n">measured_clashes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">residue</span><span class="p">,</span> <span class="n">atom</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="n">report_hydrogen</span><span class="p">:</span>  <span class="c1"># Report all clashes, no need to check</span>
                        <span class="n">other_clashes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">residue</span><span class="p">,</span> <span class="n">atom</span><span class="p">))</span>
                    <span class="k">elif</span> <span class="n">atom</span><span class="o">.</span><span class="n">is_heavy</span><span class="p">():</span>  <span class="c1"># Check if atom is a heavy atom then report if it is</span>
                        <span class="n">other_clashes</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">residue</span><span class="p">,</span> <span class="n">atom</span><span class="p">))</span>

            <span class="k">return</span> <span class="n">clashes</span> <span class="ow">or</span> <span class="n">new_clashes</span>

        <span class="c1"># Using _any_clashes to set the global clashes</span>
        <span class="c1">#     clashes = _any_clashes(): ... return clashes</span>
        <span class="c1"># While checking global clashes against new_clashes</span>
    <span class="k">else</span><span class="p">:</span>  <span class="c1"># Raise a ClashError to defer to caller</span>
        <span class="k">def</span> <span class="nf">_any_clashes</span><span class="p">(</span><span class="n">_clash_indices</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">clashing_idx</span> <span class="ow">in</span> <span class="n">_clash_indices</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">atoms</span><span class="p">[</span><span class="n">clashing_idx</span><span class="p">],</span> <span class="sa">f</span><span class="s1">&#39;is_</span><span class="si">{</span><span class="n">measure</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">return_true</span><span class="p">)():</span>
                    <span class="k">raise</span> <span class="n">stutils</span><span class="o">.</span><span class="n">ClashError</span><span class="p">(</span><span class="n">clash_msg</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">clashes</span>

    <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span>
    <span class="c1"># Check first and last residue with different considerations given covalent bonding</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">residue</span><span class="p">,</span> <span class="n">next_residue</span> <span class="o">=</span> <span class="n">residues</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
        <span class="c1"># residue, next_residue, *other_residues = self.residues</span>
    <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># Can&#39;t unpack</span>
        <span class="c1"># residues &lt; 2. Insufficient to check clashing</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="c1"># Query each residue with requested coords_type against the atom_tree</span>
    <span class="n">residue_atom_contacts</span> <span class="o">=</span> <span class="n">atom_tree</span><span class="o">.</span><span class="n">query_radius</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">residue</span><span class="p">,</span> <span class="n">coords_type</span><span class="p">),</span> <span class="n">distance</span><span class="p">)</span>
    <span class="c1"># residue_atom_contacts returns as ragged nested array, (array of different sized array)</span>
    <span class="c1"># Reduce the dimensions to all contacts</span>
    <span class="n">all_contacts</span> <span class="o">=</span> <span class="p">{</span><span class="n">atom_contact</span> <span class="k">for</span> <span class="n">residue_contacts</span> <span class="ow">in</span> <span class="n">residue_atom_contacts</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                    <span class="k">for</span> <span class="n">atom_contact</span> <span class="ow">in</span> <span class="n">residue_contacts</span><span class="o">.</span><span class="n">tolist</span><span class="p">()}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># Subtract the N and C atoms from the adjacent residues for each residue as these are within a bond</span>
        <span class="n">clashes</span> <span class="o">=</span> <span class="n">_any_clashes</span><span class="p">(</span>
            <span class="n">all_contacts</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">atom_indices</span> <span class="o">+</span> <span class="p">[</span><span class="n">next_residue</span><span class="o">.</span><span class="n">n_atom_index</span><span class="p">]))</span>
        <span class="n">prev_residue</span> <span class="o">=</span> <span class="n">residue</span>
        <span class="n">residue</span> <span class="o">=</span> <span class="n">next_residue</span>

        <span class="c1"># Perform routine for all middle residues</span>
        <span class="k">for</span> <span class="n">next_residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">[</span><span class="mi">2</span><span class="p">:]:</span>
            <span class="n">residue_atom_contacts</span> <span class="o">=</span> <span class="n">atom_tree</span><span class="o">.</span><span class="n">query_radius</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">residue</span><span class="p">,</span> <span class="n">coords_type</span><span class="p">),</span> <span class="n">distance</span><span class="p">)</span>
            <span class="n">all_contacts</span> <span class="o">=</span> <span class="p">{</span><span class="n">atom_contact</span> <span class="k">for</span> <span class="n">residue_contacts</span> <span class="ow">in</span> <span class="n">residue_atom_contacts</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                            <span class="k">for</span> <span class="n">atom_contact</span> <span class="ow">in</span> <span class="n">residue_contacts</span><span class="o">.</span><span class="n">tolist</span><span class="p">()}</span>
            <span class="n">clashes</span> <span class="o">=</span> <span class="n">_any_clashes</span><span class="p">(</span>
                <span class="n">all_contacts</span><span class="o">.</span><span class="n">difference</span><span class="p">(</span>
                    <span class="p">[</span><span class="n">prev_residue</span><span class="o">.</span><span class="n">o_atom_index</span><span class="p">,</span> <span class="n">prev_residue</span><span class="o">.</span><span class="n">c_atom_index</span><span class="p">,</span> <span class="n">next_residue</span><span class="o">.</span><span class="n">n_atom_index</span><span class="p">]</span>
                    <span class="o">+</span> <span class="n">residue</span><span class="o">.</span><span class="n">atom_indices</span>
                <span class="p">))</span>
            <span class="n">prev_residue</span> <span class="o">=</span> <span class="n">residue</span>
            <span class="n">residue</span> <span class="o">=</span> <span class="n">next_residue</span>

        <span class="n">residue_atom_contacts</span> <span class="o">=</span> <span class="n">atom_tree</span><span class="o">.</span><span class="n">query_radius</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">residue</span><span class="p">,</span> <span class="n">coords_type</span><span class="p">),</span> <span class="n">distance</span><span class="p">)</span>
        <span class="n">all_contacts</span> <span class="o">=</span> <span class="p">{</span><span class="n">atom_contact</span> <span class="k">for</span> <span class="n">residue_contacts</span> <span class="ow">in</span> <span class="n">residue_atom_contacts</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
                        <span class="k">for</span> <span class="n">atom_contact</span> <span class="ow">in</span> <span class="n">residue_contacts</span><span class="o">.</span><span class="n">tolist</span><span class="p">()}</span>
        <span class="n">clashes</span> <span class="o">=</span> <span class="n">_any_clashes</span><span class="p">(</span>
            <span class="n">all_contacts</span><span class="o">.</span><span class="n">difference</span><span class="p">([</span><span class="n">prev_residue</span><span class="o">.</span><span class="n">o_atom_index</span><span class="p">,</span> <span class="n">prev_residue</span><span class="o">.</span><span class="n">c_atom_index</span><span class="p">]</span>
                                    <span class="o">+</span> <span class="n">residue</span><span class="o">.</span><span class="n">atom_indices</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">except</span> <span class="n">stutils</span><span class="o">.</span><span class="n">ClashError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>  <span class="c1"># Raised by _any_clashes()</span>
        <span class="k">if</span> <span class="n">silence_exceptions</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">error</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">clashes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">measured_clashes</span><span class="p">:</span>
                <span class="n">bb_info</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Chain </span><span class="si">{</span><span class="n">residue</span><span class="o">.</span><span class="n">chain_id</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">residue</span><span class="o">.</span><span class="n">number</span><span class="si">:</span><span class="s1">5d</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">atom</span><span class="o">.</span><span class="n">get_atom_record</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span>
                                      <span class="k">for</span> <span class="n">residue</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">measured_clashes</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">measured_clashes</span><span class="p">)</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">measure</span><span class="si">}</span><span class="s1"> clashes from the following &#39;</span>
                               <span class="sa">f</span><span class="s1">&#39;Residues to the corresponding Atom:</span><span class="se">\n\t</span><span class="si">{</span><span class="n">bb_info</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">raise</span> <span class="n">stutils</span><span class="o">.</span><span class="n">ClashError</span><span class="p">(</span><span class="n">clash_msg</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">other_clashes</span><span class="p">:</span>
                <span class="n">sc_info</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Chain </span><span class="si">{</span><span class="n">residue</span><span class="o">.</span><span class="n">chain_id</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">residue</span><span class="o">.</span><span class="n">number</span><span class="si">:</span><span class="s1">5d</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">atom</span><span class="o">.</span><span class="n">get_atom_record</span><span class="p">()</span><span class="si">}</span><span class="s1">&#39;</span>
                                      <span class="k">for</span> <span class="n">residue</span><span class="p">,</span> <span class="n">atom</span> <span class="ow">in</span> <span class="n">other_clashes</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1"> contains </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">other_clashes</span><span class="p">)</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">other</span><span class="si">}</span><span class="s1"> clashes between the &#39;</span>
                                 <span class="sa">f</span><span class="s1">&#39;following Residues:</span><span class="se">\n\t</span><span class="si">{</span><span class="n">sc_info</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.get_sasa" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_sasa</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_sasa</span><span class="p">(</span><span class="n">probe_radius</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="mf">1.4</span><span class="p">,</span> <span class="n">atom</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Use FreeSASA to calculate the surface area of residues in the Structure object.</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>probe_radius</code></b>
            (<code>float</code>, default:
                <code>1.4</code>
)
        
        <div class="doc-md-description">
          <p>The radius which surface area should be generated</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>atom</code></b>
            (<code>bool</code>, default:
                <code>True</code>
)
        
        <div class="doc-md-description">
          <p>Whether the output should be generated for each atom. If False, will be generated for each Residue</p>
        </div>
      </li>
  </ul>

<details class="sets" open>
  <summary>Sets</summary>
  <p>self.sasa, self.residue(s).sasa</p>
</details>
          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">4946</span>
<span class="normal">4947</span>
<span class="normal">4948</span>
<span class="normal">4949</span>
<span class="normal">4950</span>
<span class="normal">4951</span>
<span class="normal">4952</span>
<span class="normal">4953</span>
<span class="normal">4954</span>
<span class="normal">4955</span>
<span class="normal">4956</span>
<span class="normal">4957</span>
<span class="normal">4958</span>
<span class="normal">4959</span>
<span class="normal">4960</span>
<span class="normal">4961</span>
<span class="normal">4962</span>
<span class="normal">4963</span>
<span class="normal">4964</span>
<span class="normal">4965</span>
<span class="normal">4966</span>
<span class="normal">4967</span>
<span class="normal">4968</span>
<span class="normal">4969</span>
<span class="normal">4970</span>
<span class="normal">4971</span>
<span class="normal">4972</span>
<span class="normal">4973</span>
<span class="normal">4974</span>
<span class="normal">4975</span>
<span class="normal">4976</span>
<span class="normal">4977</span>
<span class="normal">4978</span>
<span class="normal">4979</span>
<span class="normal">4980</span>
<span class="normal">4981</span>
<span class="normal">4982</span>
<span class="normal">4983</span>
<span class="normal">4984</span>
<span class="normal">4985</span>
<span class="normal">4986</span>
<span class="normal">4987</span>
<span class="normal">4988</span>
<span class="normal">4989</span>
<span class="normal">4990</span>
<span class="normal">4991</span>
<span class="normal">4992</span>
<span class="normal">4993</span>
<span class="normal">4994</span>
<span class="normal">4995</span>
<span class="normal">4996</span>
<span class="normal">4997</span>
<span class="normal">4998</span>
<span class="normal">4999</span>
<span class="normal">5000</span>
<span class="normal">5001</span>
<span class="normal">5002</span>
<span class="normal">5003</span>
<span class="normal">5004</span>
<span class="normal">5005</span>
<span class="normal">5006</span>
<span class="normal">5007</span>
<span class="normal">5008</span>
<span class="normal">5009</span>
<span class="normal">5010</span>
<span class="normal">5011</span>
<span class="normal">5012</span>
<span class="normal">5013</span>
<span class="normal">5014</span>
<span class="normal">5015</span>
<span class="normal">5016</span>
<span class="normal">5017</span>
<span class="normal">5018</span>
<span class="normal">5019</span>
<span class="normal">5020</span>
<span class="normal">5021</span>
<span class="normal">5022</span>
<span class="normal">5023</span>
<span class="normal">5024</span>
<span class="normal">5025</span>
<span class="normal">5026</span>
<span class="normal">5027</span>
<span class="normal">5028</span>
<span class="normal">5029</span>
<span class="normal">5030</span>
<span class="normal">5031</span>
<span class="normal">5032</span>
<span class="normal">5033</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_sasa</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probe_radius</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.4</span><span class="p">,</span> <span class="n">atom</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Use FreeSASA to calculate the surface area of residues in the Structure object.</span>

<span class="sd">    Args:</span>
<span class="sd">        probe_radius: The radius which surface area should be generated</span>
<span class="sd">        atom: Whether the output should be generated for each atom. If False, will be generated for each Residue</span>

<span class="sd">    Sets:</span>
<span class="sd">        self.sasa, self.residue(s).sasa</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">atom</span><span class="p">:</span>
        <span class="n">out_format</span> <span class="o">=</span> <span class="s1">&#39;pdb&#39;</span>
    <span class="c1"># --format=pdb --depth=atom</span>
    <span class="c1"># REMARK 999 This PDB file was generated by FreeSASA 2.0.</span>
    <span class="c1"># REMARK 999 In the ATOM records temperature factors have been</span>
    <span class="c1"># REMARK 999 replaced by the SASA of the atom, and the occupancy</span>
    <span class="c1"># REMARK 999 by the radius used in the calculation.</span>
    <span class="c1"># MODEL        1                                        [radii][sasa]</span>
    <span class="c1"># ATOM   2557  C   PHE C 113      -2.627 -17.654  13.108  1.61  1.39</span>
    <span class="c1"># ATOM   2558  O   PHE C 113      -2.767 -18.772  13.648  1.42 39.95</span>
    <span class="c1"># ATOM   2559  CB  PHE C 113      -1.255 -16.970  11.143  1.88 13.46</span>
    <span class="c1"># ATOM   2560  CG  PHE C 113      -0.886 -17.270   9.721  1.61  1.98</span>
    <span class="c1"># ATOM   2563 CE1  PHE C 113      -0.041 -18.799   8.042  1.76 28.76</span>
    <span class="c1"># ATOM   2564 CE2  PHE C 113      -0.694 -16.569   7.413  1.76  2.92</span>
    <span class="c1"># ATOM   2565  CZ  PHE C 113      -0.196 -17.820   7.063  1.76  4.24</span>
    <span class="c1"># ATOM   2566 OXT  PHE C 113      -2.515 -16.590  13.750  1.46 15.09</span>
    <span class="c1"># ...</span>
    <span class="c1"># TER    7913      GLU A 264</span>
    <span class="c1"># ENDMDL EOF</span>
    <span class="c1"># if residue:</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out_format</span> <span class="o">=</span> <span class="s1">&#39;seq&#39;</span>
    <span class="c1"># --format=seq</span>
    <span class="c1"># Residues in ...</span>
    <span class="c1"># SEQ A    1 MET :   74.46</span>
    <span class="c1"># SEQ A    2 LYS :   96.30</span>
    <span class="c1"># SEQ A    3 VAL :    0.00</span>
    <span class="c1"># SEQ A    4 VAL :    0.00</span>
    <span class="c1"># SEQ A    5 VAL :    0.00</span>
    <span class="c1"># SEQ A    6 GLN :    0.00</span>
    <span class="c1"># SEQ A    7 ILE :    0.00</span>
    <span class="c1"># SEQ A    8 LYS :    0.87</span>
    <span class="c1"># SEQ A    9 ASP :    1.30</span>
    <span class="c1"># SEQ A   10 PHE :   64.55</span>
    <span class="c1"># ...</span>
    <span class="c1"># \n EOF</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">contains_hydrogen</span><span class="p">():</span>
        <span class="n">include_hydrogen</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;--hydrogen&#39;</span><span class="p">]</span>  <span class="c1"># the addition of hydrogen changes results quite a bit</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">include_hydrogen</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="p">[</span><span class="n">putils</span><span class="o">.</span><span class="n">freesasa_exe_path</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;--format=</span><span class="si">{</span><span class="n">out_format</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;--probe-radius&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">probe_radius</span><span class="p">),</span>
           <span class="s1">&#39;-c&#39;</span><span class="p">,</span> <span class="n">putils</span><span class="o">.</span><span class="n">freesasa_config_path</span><span class="p">,</span> <span class="s1">&#39;--n-threads=2&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">include_hydrogen</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;FreeSASA:</span><span class="se">\n</span><span class="si">{</span><span class="n">subprocess</span><span class="o">.</span><span class="n">list2cmdline</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span><span class="n">cmd</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">)</span>
    <span class="n">out</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_atom_record</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
    <span class="c1"># if err:  # usually results from Hydrogen atoms, silencing</span>
    <span class="c1">#     self.log.warning(&#39;\n%s&#39; % err.decode(&#39;utf-8&#39;))</span>
    <span class="n">sasa_output</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">if_idx</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">atom</span><span class="p">:</span>
        <span class="c1"># slice removes first REMARK, MODEL and final TER, MODEL regardless of # of chains, TER inclusion</span>
        <span class="c1"># since return_atom_record doesn&#39;t have models, these won&#39;t be present and no option to freesasa about model</span>
        <span class="c1"># would be provided with above subprocess call</span>
        <span class="n">atoms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">atoms</span>
        <span class="k">for</span> <span class="n">line_split</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">split</span><span class="p">,</span> <span class="n">sasa_output</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="o">-</span><span class="mi">2</span><span class="p">]):</span>  <span class="c1"># Does slice remove need for if line[0] == &#39;ATOM&#39;?</span>
            <span class="k">if</span> <span class="n">line_split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ATOM&#39;</span><span class="p">:</span>  <span class="c1"># This line appears necessary as MODEL can be added if MODEL is written</span>
                <span class="n">atoms</span><span class="p">[</span><span class="n">if_idx</span><span class="p">]</span><span class="o">.</span><span class="n">sasa</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line_split</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">if_idx</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">seq_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">sasa_slice</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">sasa_output</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]):</span>  <span class="c1"># Does slice remove the need for if line[:3] == &#39;SEQ&#39;?</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="n">seq_slice</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;SEQ&#39;</span><span class="p">:</span>  <span class="c1"># Doesn&#39;t seem that this equality is sufficient ^</span>
                <span class="n">residues</span><span class="p">[</span><span class="n">if_idx</span><span class="p">]</span><span class="o">.</span><span class="n">sasa</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">sasa_slice</span><span class="p">])</span>
                <span class="n">if_idx</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sasa</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">residue</span><span class="o">.</span><span class="n">sasa</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">RecursionError</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s1">&#39;RecursionError measuring SASA&#39;</span><span class="p">)</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">putils</span><span class="o">.</span><span class="n">sasa_debug_dir</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out_path</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">putils</span><span class="o">.</span><span class="n">sasa_debug_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;SASA-INPUT-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.pdb&#39;</span><span class="p">))</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">putils</span><span class="o">.</span><span class="n">sasa_debug_dir</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;SASA-OUTPUT-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.pdb&#39;</span><span class="p">),</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sasa_output</span><span class="p">))</span>

        <span class="k">raise</span> <span class="n">stutils</span><span class="o">.</span><span class="n">DesignError</span><span class="p">(</span>
            <span class="s2">&quot;Measurement of SASA isn&#39;t working, probably due to a missing Atom. Debug files written to &quot;</span>
            <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">putils</span><span class="o">.</span><span class="n">sasa_debug_dir</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.get_surface_area_residues" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_surface_area_residues</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_surface_area_residues</span><span class="p">(</span><span class="n">residues</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n"><span title="structure.base.sasa_types_literal">sasa_types_literal</span></span> <span class="o">=</span> <span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Get the surface area for specified residues</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>residues</code></b>
            (<code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The Residues to sum. If not provided, will be retrieved by <code>.get_residues()</code></p>
        </div>
      </li>
      <li class="field-body">
        <b><code>dtype</code></b>
            (<code><span title="structure.base.sasa_types_literal">sasa_types_literal</span></code>, default:
                <code>&#39;polar&#39;</code>
)
        
        <div class="doc-md-description">
          <p>The type of area classification to query.</p>
        </div>
      </li>
  </ul>



  <p>Other Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>atom</code></b>
        
        <div class="doc-md-description">
          <p>bool = True - Whether the output should be generated for each atom.
If False, will be generated for each Residue</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>probe_radius</code></b>
        
        <div class="doc-md-description">
          <p>float = 1.4 - The radius which surface area should be generated</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>numbers</code></b>
        
        <div class="doc-md-description">
          <p>Container[int] = None  Residue numbers of interest</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>indices</code></b>
        
        <div class="doc-md-description">
          <p>Iterable[int] = None  Residue indices of interest for the Structure</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>float</code>
        
        <div class="doc-md-description">
          <p>Angstrom^2 of surface area</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5092</span>
<span class="normal">5093</span>
<span class="normal">5094</span>
<span class="normal">5095</span>
<span class="normal">5096</span>
<span class="normal">5097</span>
<span class="normal">5098</span>
<span class="normal">5099</span>
<span class="normal">5100</span>
<span class="normal">5101</span>
<span class="normal">5102</span>
<span class="normal">5103</span>
<span class="normal">5104</span>
<span class="normal">5105</span>
<span class="normal">5106</span>
<span class="normal">5107</span>
<span class="normal">5108</span>
<span class="normal">5109</span>
<span class="normal">5110</span>
<span class="normal">5111</span>
<span class="normal">5112</span>
<span class="normal">5113</span>
<span class="normal">5114</span>
<span class="normal">5115</span>
<span class="normal">5116</span>
<span class="normal">5117</span>
<span class="normal">5118</span>
<span class="normal">5119</span>
<span class="normal">5120</span>
<span class="normal">5121</span>
<span class="normal">5122</span>
<span class="normal">5123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_surface_area_residues</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">residues</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Residue</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">sasa_types_literal</span> <span class="o">=</span> <span class="s1">&#39;polar&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the surface area for specified residues</span>

<span class="sd">    Args:</span>
<span class="sd">        residues: The Residues to sum. If not provided, will be retrieved by `.get_residues()`</span>
<span class="sd">        dtype: The type of area classification to query.</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        atom: bool = True - Whether the output should be generated for each atom.</span>
<span class="sd">            If False, will be generated for each Residue</span>
<span class="sd">        probe_radius: float = 1.4 - The radius which surface area should be generated</span>
<span class="sd">        numbers: Container[int] = None  Residue numbers of interest</span>
<span class="sd">        indices: Iterable[int] = None  Residue indices of interest for the Structure</span>

<span class="sd">    Returns:</span>
<span class="sd">        Angstrom^2 of surface area</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sasa</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_sasa</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">residues</span><span class="p">:</span>
        <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_residues</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="n">sasa_dtype</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;sasa_</span><span class="si">{</span><span class="n">dtype</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">getattr</span><span class="p">(</span><span class="n">residue</span><span class="p">,</span> <span class="n">sasa_dtype</span><span class="p">)</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">])</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot; </span><span class="si">{</span><span class="n">dtype</span><span class="si">=}</span><span class="s2"> is an invalid &#39;sasa_dtype&#39;. Viable types are </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">sasa_types</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.errat" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">errat</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">errat</span><span class="p">(</span><span class="n">out_path</span><span class="p">:</span> <span class="n"><span title="typing.AnyStr">AnyStr</span></span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span> <span class="o">-&gt;</span> <span class="n">tuple</span><span class="p">[</span><span class="n">float</span><span class="p">,</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Find the overall and per residue Errat accuracy for the given Structure</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>out_path</code></b>
            (<code><span title="typing.AnyStr">AnyStr</span></code>, default:
                <code><span title="os.getcwd">getcwd</span>()</code>
)
        
        <div class="doc-md-description">
          <p>The path where Errat files should be written</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>tuple[float, <span title="numpy.ndarray">ndarray</span>]</code>
        
        <div class="doc-md-description">
          <p>Overall Errat score, Errat value/residue array</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5125</span>
<span class="normal">5126</span>
<span class="normal">5127</span>
<span class="normal">5128</span>
<span class="normal">5129</span>
<span class="normal">5130</span>
<span class="normal">5131</span>
<span class="normal">5132</span>
<span class="normal">5133</span>
<span class="normal">5134</span>
<span class="normal">5135</span>
<span class="normal">5136</span>
<span class="normal">5137</span>
<span class="normal">5138</span>
<span class="normal">5139</span>
<span class="normal">5140</span>
<span class="normal">5141</span>
<span class="normal">5142</span>
<span class="normal">5143</span>
<span class="normal">5144</span>
<span class="normal">5145</span>
<span class="normal">5146</span>
<span class="normal">5147</span>
<span class="normal">5148</span>
<span class="normal">5149</span>
<span class="normal">5150</span>
<span class="normal">5151</span>
<span class="normal">5152</span>
<span class="normal">5153</span>
<span class="normal">5154</span>
<span class="normal">5155</span>
<span class="normal">5156</span>
<span class="normal">5157</span>
<span class="normal">5158</span>
<span class="normal">5159</span>
<span class="normal">5160</span>
<span class="normal">5161</span>
<span class="normal">5162</span>
<span class="normal">5163</span>
<span class="normal">5164</span>
<span class="normal">5165</span>
<span class="normal">5166</span>
<span class="normal">5167</span>
<span class="normal">5168</span>
<span class="normal">5169</span>
<span class="normal">5170</span>
<span class="normal">5171</span>
<span class="normal">5172</span>
<span class="normal">5173</span>
<span class="normal">5174</span>
<span class="normal">5175</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">errat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out_path</span><span class="p">:</span> <span class="n">AnyStr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Find the overall and per residue Errat accuracy for the given Structure</span>

<span class="sd">    Args:</span>
<span class="sd">        out_path: The path where Errat files should be written</span>

<span class="sd">    Returns:</span>
<span class="sd">        Overall Errat score, Errat value/residue array</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># name = &#39;errat_input-%s-%d.pdb&#39; % (self.name, random() * 100000)</span>
    <span class="c1"># current_struc_file = self.write(out_path=os.path.join(out_path, name))</span>
    <span class="c1"># errat_cmd = [putils.errat_exe_path, os.path.splitext(name)[0], out_path]  # for writing file first</span>
    <span class="c1"># os.system(&#39;rm %s&#39; % current_struc_file)</span>
    <span class="n">out_path</span> <span class="o">=</span> <span class="n">out_path</span> <span class="k">if</span> <span class="n">out_path</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span> <span class="k">else</span> <span class="n">out_path</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">sep</span>  <span class="c1"># errat needs trailing &quot;/&quot;</span>
    <span class="n">errat_cmd</span> <span class="o">=</span> <span class="p">[</span><span class="n">putils</span><span class="o">.</span><span class="n">errat_exe_path</span><span class="p">,</span> <span class="n">out_path</span><span class="p">]</span>  <span class="c1"># for passing atoms by stdin</span>
    <span class="c1"># p = subprocess.Popen(errat_cmd, stdin=subprocess.PIPE, stdout=subprocess.DEVNULL, stderr=subprocess.DEVNULL)</span>
    <span class="c1"># out, err = p.communicate(input=self.get_atom_record().encode(&#39;utf-8&#39;))</span>
    <span class="c1"># logger.info(self.get_atom_record()[:120])</span>
    <span class="n">iteration</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">all_residue_scores</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">number_of_residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_residues</span>
    <span class="k">while</span> <span class="n">iteration</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">errat_cmd</span><span class="p">,</span> <span class="nb">input</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_atom_record</span><span class="p">(),</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">all_residue_scores</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># Subtract one due to the addition of overall score</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_residue_scores</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">number_of_residues</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="k">if</span> <span class="n">iteration</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">stderr</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">errat</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> couldn&#39;t generate the correct output length. &quot;</span>
                       <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">all_residue_scores</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s1">) != number_of_residues (</span><span class="si">{</span><span class="n">number_of_residues</span><span class="si">}</span><span class="s1">). Got stderr:&#39;</span>
                       <span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="c1"># errat_output_file = os.path.join(out_path, &#39;%s.ps&#39; % name)</span>
    <span class="c1"># errat_output_file = os.path.join(out_path, &#39;errat.ps&#39;)</span>
    <span class="c1"># else:</span>
    <span class="c1"># print(subprocess.list2cmdline([&#39;grep&#39;, &#39;Overall quality factor**: &#39;, errat_output_file]))</span>
    <span class="c1"># p = subprocess.Popen([&#39;grep&#39;, &#39;Overall quality factor&#39;, errat_output_file],</span>
    <span class="c1">#                      stdout=subprocess.PIPE, stderr=subprocess.DEVNULL)</span>
    <span class="c1"># errat_out, errat_err = p.communicate()</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="c1"># overall_score = set(errat_out.decode().split(&#39;\n&#39;))</span>
        <span class="c1"># all_residue_scores = list(map(str.strip, errat_out.split(&#39;\n&#39;), &#39;Residue &#39;))</span>
        <span class="c1"># all_residue_scores = errat_out.split(&#39;\n&#39;)</span>
        <span class="n">overall_score</span> <span class="o">=</span> <span class="n">all_residue_scores</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">float</span><span class="p">(</span><span class="n">overall_score</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="o">-</span><span class="mi">1</span><span class="p">]),</span> \
            <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">score</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">split</span><span class="p">,</span> <span class="n">all_residue_scores</span><span class="p">)])</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">AttributeError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>  <span class="c1"># ValueError when returning text instead of float</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">: Failed to generate ERRAT measurement. Errat returned: </span><span class="si">{</span><span class="n">all_residue_scores</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_residues</span><span class="p">)])</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.stride" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">stride</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">stride</span><span class="p">(</span><span class="n">to_file</span><span class="p">:</span> <span class="n"><span title="typing.AnyStr">AnyStr</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculates the secondary structure using the program Stride</p>
<p>Args
    to_file: The location of a file to save the Stride output</p>

<details class="sets" open>
  <summary>Sets</summary>
  <p>Each contained Residue instance <code>.secondary_structure</code> attribute</p>
</details>
          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5177</span>
<span class="normal">5178</span>
<span class="normal">5179</span>
<span class="normal">5180</span>
<span class="normal">5181</span>
<span class="normal">5182</span>
<span class="normal">5183</span>
<span class="normal">5184</span>
<span class="normal">5185</span>
<span class="normal">5186</span>
<span class="normal">5187</span>
<span class="normal">5188</span>
<span class="normal">5189</span>
<span class="normal">5190</span>
<span class="normal">5191</span>
<span class="normal">5192</span>
<span class="normal">5193</span>
<span class="normal">5194</span>
<span class="normal">5195</span>
<span class="normal">5196</span>
<span class="normal">5197</span>
<span class="normal">5198</span>
<span class="normal">5199</span>
<span class="normal">5200</span>
<span class="normal">5201</span>
<span class="normal">5202</span>
<span class="normal">5203</span>
<span class="normal">5204</span>
<span class="normal">5205</span>
<span class="normal">5206</span>
<span class="normal">5207</span>
<span class="normal">5208</span>
<span class="normal">5209</span>
<span class="normal">5210</span>
<span class="normal">5211</span>
<span class="normal">5212</span>
<span class="normal">5213</span>
<span class="normal">5214</span>
<span class="normal">5215</span>
<span class="normal">5216</span>
<span class="normal">5217</span>
<span class="normal">5218</span>
<span class="normal">5219</span>
<span class="normal">5220</span>
<span class="normal">5221</span>
<span class="normal">5222</span>
<span class="normal">5223</span>
<span class="normal">5224</span>
<span class="normal">5225</span>
<span class="normal">5226</span>
<span class="normal">5227</span>
<span class="normal">5228</span>
<span class="normal">5229</span>
<span class="normal">5230</span>
<span class="normal">5231</span>
<span class="normal">5232</span>
<span class="normal">5233</span>
<span class="normal">5234</span>
<span class="normal">5235</span>
<span class="normal">5236</span>
<span class="normal">5237</span>
<span class="normal">5238</span>
<span class="normal">5239</span>
<span class="normal">5240</span>
<span class="normal">5241</span>
<span class="normal">5242</span>
<span class="normal">5243</span>
<span class="normal">5244</span>
<span class="normal">5245</span>
<span class="normal">5246</span>
<span class="normal">5247</span>
<span class="normal">5248</span>
<span class="normal">5249</span>
<span class="normal">5250</span>
<span class="normal">5251</span>
<span class="normal">5252</span>
<span class="normal">5253</span>
<span class="normal">5254</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">stride</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to_file</span><span class="p">:</span> <span class="n">AnyStr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculates the secondary structure using the program Stride</span>

<span class="sd">    Args</span>
<span class="sd">        to_file: The location of a file to save the Stride output</span>

<span class="sd">    Sets:</span>
<span class="sd">        Each contained Residue instance `.secondary_structure` attribute</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># REM  -------------------- Secondary structure summary -------------------  XXXX</span>
    <span class="c1"># REM                .         .         .         .         .               XXXX</span>
    <span class="c1"># SEQ  1    IVQQQNNLLRAIEAQQHLLQLTVWGIKQLQAGGWMEWDREINNYTSLIHS   50          XXXX</span>
    <span class="c1"># STR       HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH  HHHHHHHHHHHHHHHHH               XXXX</span>
    <span class="c1"># REM                                                                        XXXX</span>
    <span class="c1"># SEQ  51   LIEESQN                                              57          XXXX</span>
    <span class="c1"># STR       HHHHHH                                                           XXXX</span>
    <span class="c1"># REM                                                                        XXXX</span>
    <span class="c1"># LOC  AlphaHelix   ILE     3 A      ALA     33 A                            XXXX</span>
    <span class="c1"># LOC  AlphaHelix   TRP    41 A      GLN     63 A                            XXXX</span>
    <span class="c1"># REM                                                                        XXXX</span>
    <span class="c1"># REM  --------------- Detailed secondary structure assignment-------------  XXXX</span>
    <span class="c1"># REM                                                                        XXXX</span>
    <span class="c1"># REM  |---Residue---|    |--Structure--|   |-Phi-|   |-Psi-|  |-Area-|      XXXX</span>
    <span class="c1"># ASG  ILE A    3    1    H    AlphaHelix    360.00    -29.07     180.4      XXXX</span>
    <span class="c1"># ASG  VAL A    4    2    H    AlphaHelix    -64.02    -45.93      99.8      XXXX</span>
    <span class="c1"># ASG  GLN A    5    3    H    AlphaHelix    -61.99    -39.37      82.2      XXXX</span>

    <span class="c1"># ASG    Detailed secondary structure assignment</span>
    <span class="c1"># Format:</span>
    <span class="c1">#  5-8  Residue type</span>
    <span class="c1">#  9-10 Protein chain identifier</span>
    <span class="c1">#  11-15 PDB residue number</span>
    <span class="c1">#  16-20 Ordinal residue number</span>
    <span class="c1">#  24-25 One letter secondary structure code **)</span>
    <span class="c1">#  26-39 Full secondary structure name</span>
    <span class="c1">#  42-49 Phi angle</span>
    <span class="c1">#  52-59 Psi angle</span>
    <span class="c1">#  61-69 Residue solvent accessible area</span>
    <span class="c1">#</span>
    <span class="c1"># -rId1Id2..  Read only Chains Id1, Id2 ...</span>
    <span class="c1"># -cId1Id2..  Process only Chains Id1, Id2 ...</span>

    <span class="c1"># The Stride based secondary structure names of each unique element where possible values are</span>
    <span class="c1">#  H:Alpha helix,</span>
    <span class="c1">#  G:3-10 helix,</span>
    <span class="c1">#  I:PI-helix,</span>
    <span class="c1">#  E:Extended conformation,</span>
    <span class="c1">#  B/b:Isolated bridge,</span>
    <span class="c1">#  T:Turn,</span>
    <span class="c1">#  C:Coil (none of the above)&#39;</span>
    <span class="n">current_struc_file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out_path</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;stride_input-</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">random</span><span class="p">()</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">100000</span><span class="si">}</span><span class="s1">.pdb&#39;</span><span class="p">)</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">([</span><span class="n">putils</span><span class="o">.</span><span class="n">stride_exe_path</span><span class="p">,</span> <span class="n">current_struc_file</span><span class="p">],</span>
                         <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">)</span>
    <span class="n">out</span><span class="p">,</span> <span class="n">err</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">communicate</span><span class="p">()</span>
    <span class="n">struct_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">current_struc_file</span><span class="p">)</span>
    <span class="n">struct_file</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">missing_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># self.log.debug(f&#39;Stride file is at: {current_struc_file}&#39;)</span>

    <span class="k">if</span> <span class="n">out</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">to_file</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">to_file</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
        <span class="n">stride_output</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">: No secondary structure assignment found with Stride&#39;</span><span class="p">)</span>
        <span class="k">return</span>

    <span class="n">residue_idx</span> <span class="o">=</span> <span class="n">count</span><span class="p">()</span>
    <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">stride_output</span><span class="p">:</span>
        <span class="c1"># residue_idx = int(line[10:15])</span>
        <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;ASG&#39;</span><span class="p">:</span>
            <span class="c1"># residue_idx = int(line[15:20])  # one-indexed, use in Structure version...</span>
            <span class="c1"># line[10:15].strip().isdigit():  # residue number -&gt; line[10:15].strip().isdigit():</span>
            <span class="c1"># self.chain(line[9:10]).residue(int(line[10:15].strip())).secondary_structure = line[24:25]</span>
            <span class="n">residues</span><span class="p">[</span><span class="nb">next</span><span class="p">(</span><span class="n">residue_idx</span><span class="p">)]</span><span class="o">.</span><span class="n">secondary_structure</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">24</span><span class="p">:</span><span class="mi">25</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">secondary_structure</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="n">secondary_structure</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.is_termini_helical" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">is_termini_helical</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">is_termini_helical</span><span class="p">(</span><span class="n">termini</span><span class="p">:</span> <span class="n"><span title="structure.utils.termini_literal">termini_literal</span></span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">window</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">bool</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Using assigned secondary structure, probe for helical termini using a segment of 'window' residues. Will
remove any disordered residues from the specified termini before checking, with the assumption that the
disordered terminal residues are not integral to the structure</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>termini</code></b>
            (<code><span title="structure.utils.termini_literal">termini_literal</span></code>, default:
                <code>&#39;n&#39;</code>
)
        
        <div class="doc-md-description">
          <p>Either 'n' or 'c' should be specified</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>window</code></b>
            (<code>int</code>, default:
                <code>5</code>
)
        
        <div class="doc-md-description">
          <p>The segment size to search</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>bool</code>
        
        <div class="doc-md-description">
          <p>True if the specified terminus has a stretch of helical residues the length of the window</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5256</span>
<span class="normal">5257</span>
<span class="normal">5258</span>
<span class="normal">5259</span>
<span class="normal">5260</span>
<span class="normal">5261</span>
<span class="normal">5262</span>
<span class="normal">5263</span>
<span class="normal">5264</span>
<span class="normal">5265</span>
<span class="normal">5266</span>
<span class="normal">5267</span>
<span class="normal">5268</span>
<span class="normal">5269</span>
<span class="normal">5270</span>
<span class="normal">5271</span>
<span class="normal">5272</span>
<span class="normal">5273</span>
<span class="normal">5274</span>
<span class="normal">5275</span>
<span class="normal">5276</span>
<span class="normal">5277</span>
<span class="normal">5278</span>
<span class="normal">5279</span>
<span class="normal">5280</span>
<span class="normal">5281</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_termini_helical</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">termini</span><span class="p">:</span> <span class="n">stutils</span><span class="o">.</span><span class="n">termini_literal</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">window</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">5</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Using assigned secondary structure, probe for helical termini using a segment of &#39;window&#39; residues. Will</span>
<span class="sd">    remove any disordered residues from the specified termini before checking, with the assumption that the</span>
<span class="sd">    disordered terminal residues are not integral to the structure</span>

<span class="sd">    Args:</span>
<span class="sd">        termini: Either &#39;n&#39; or &#39;c&#39; should be specified</span>
<span class="sd">        window: The segment size to search</span>

<span class="sd">    Returns:</span>
<span class="sd">        True if the specified terminus has a stretch of helical residues the length of the window</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Strip &quot;disorder&quot; from the termini, then use the window to compare against the secondary structure</span>
    <span class="n">search_window</span> <span class="o">=</span> <span class="n">window</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">termini</span> <span class="ow">in</span> <span class="s1">&#39;Nn&#39;</span><span class="p">:</span>
        <span class="n">term_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondary_structure</span><span class="o">.</span><span class="n">lstrip</span><span class="p">(</span><span class="n">SS_DISORDER_IDENTIFIERS</span><span class="p">)[:</span><span class="n">search_window</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">termini</span> <span class="ow">in</span> <span class="s1">&#39;Cc&#39;</span><span class="p">:</span>
        <span class="n">term_window</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">secondary_structure</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="n">SS_DISORDER_IDENTIFIERS</span><span class="p">)[</span><span class="o">-</span><span class="n">search_window</span><span class="p">:]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The termini value </span><span class="si">{</span><span class="n">termini</span><span class="si">}</span><span class="s2"> isn&#39;t allowed. Must indicate one of </span><span class="si">{</span><span class="n">get_args</span><span class="p">(</span><span class="n">stutils</span><span class="o">.</span><span class="n">termini_literal</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="s1">&#39;H&#39;</span> <span class="o">*</span> <span class="n">window</span> <span class="ow">in</span> <span class="n">term_window</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">False</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.calculate_secondary_structure" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">calculate_secondary_structure</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">calculate_secondary_structure</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Perform the secondary structure calculation for the Structure using the DEFAULT_SS_PROGRAM</p>



  <p>Other Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>to_file</code></b>
        
        <div class="doc-md-description">
          <p>AnyStr = None - The location of a file to save secondary structure calculations</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5283</span>
<span class="normal">5284</span>
<span class="normal">5285</span>
<span class="normal">5286</span>
<span class="normal">5287</span>
<span class="normal">5288</span>
<span class="normal">5289</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">calculate_secondary_structure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Perform the secondary structure calculation for the Structure using the DEFAULT_SS_PROGRAM</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        to_file: AnyStr = None - The location of a file to save secondary structure calculations</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="fm">__getattribute__</span><span class="p">(</span><span class="n">DEFAULT_SS_PROGRAM</span><span class="p">)(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># self.stride()</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.termini_proximity_from_reference" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">termini_proximity_from_reference</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">termini_proximity_from_reference</span><span class="p">(</span><span class="n">termini</span><span class="p">:</span> <span class="n"><span title="structure.utils.termini_literal">termini_literal</span></span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span> <span class="n">reference</span><span class="p">:</span> <span class="n"><span title="numpy.ndarray">ndarray</span></span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">symmetry</span><span class="o">.</span><span class="n">origin</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">float</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Finds the orientation of the termini from the origin (default) or from a reference point</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>termini</code></b>
            (<code><span title="structure.utils.termini_literal">termini_literal</span></code>, default:
                <code>&#39;n&#39;</code>
)
        
        <div class="doc-md-description">
          <p>Either 'n' or 'c' should be specified</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>reference</code></b>
            (<code><span title="numpy.ndarray">ndarray</span></code>, default:
                <code><span title="symdesign.utils.symmetry.origin">origin</span></code>
)
        
        <div class="doc-md-description">
          <p>The reference where the point should be measured from</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>float</code>
        
        <div class="doc-md-description">
          <p>When compared to the reference, 1 if the termini is more than halfway from the center of the Structure and
-1 if the termini is less than halfway from the center of the Structure</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5315</span>
<span class="normal">5316</span>
<span class="normal">5317</span>
<span class="normal">5318</span>
<span class="normal">5319</span>
<span class="normal">5320</span>
<span class="normal">5321</span>
<span class="normal">5322</span>
<span class="normal">5323</span>
<span class="normal">5324</span>
<span class="normal">5325</span>
<span class="normal">5326</span>
<span class="normal">5327</span>
<span class="normal">5328</span>
<span class="normal">5329</span>
<span class="normal">5330</span>
<span class="normal">5331</span>
<span class="normal">5332</span>
<span class="normal">5333</span>
<span class="normal">5334</span>
<span class="normal">5335</span>
<span class="normal">5336</span>
<span class="normal">5337</span>
<span class="normal">5338</span>
<span class="normal">5339</span>
<span class="normal">5340</span>
<span class="normal">5341</span>
<span class="normal">5342</span>
<span class="normal">5343</span>
<span class="normal">5344</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">termini_proximity_from_reference</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">termini</span><span class="p">:</span> <span class="n">stutils</span><span class="o">.</span><span class="n">termini_literal</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="p">,</span>
                                     <span class="n">reference</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">symmetry</span><span class="o">.</span><span class="n">origin</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Finds the orientation of the termini from the origin (default) or from a reference point</span>

<span class="sd">    Args:</span>
<span class="sd">        termini: Either &#39;n&#39; or &#39;c&#39; should be specified</span>
<span class="sd">        reference: The reference where the point should be measured from</span>

<span class="sd">    Returns:</span>
<span class="sd">        When compared to the reference, 1 if the termini is more than halfway from the center of the Structure and</span>
<span class="sd">            -1 if the termini is less than halfway from the center of the Structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">termini</span> <span class="o">==</span> <span class="s1">&#39;n&#39;</span><span class="p">:</span>
        <span class="n">residue_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">n_coords</span>
    <span class="k">elif</span> <span class="n">termini</span> <span class="o">==</span> <span class="s1">&#39;c&#39;</span><span class="p">:</span>
        <span class="n">residue_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">c_coords</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;termini&#39; must be either &#39;n&#39; or &#39;c&#39;, not </span><span class="si">{</span><span class="n">termini</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">reference</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">reference</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">symmetry</span><span class="o">.</span><span class="n">origin</span>

    <span class="n">max_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_from_reference</span><span class="p">(</span><span class="n">reference</span><span class="o">=</span><span class="n">reference</span><span class="p">,</span> <span class="n">measure</span><span class="o">=</span><span class="s1">&#39;max&#39;</span><span class="p">)</span>
    <span class="n">min_distance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">distance_from_reference</span><span class="p">(</span><span class="n">reference</span><span class="o">=</span><span class="n">reference</span><span class="p">,</span> <span class="n">measure</span><span class="o">=</span><span class="s1">&#39;min&#39;</span><span class="p">)</span>
    <span class="n">coord_distance</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">residue_coords</span> <span class="o">-</span> <span class="n">reference</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">coord_distance</span> <span class="o">-</span> <span class="n">max_distance</span><span class="p">)</span> <span class="o">&lt;</span> <span class="nb">abs</span><span class="p">(</span><span class="n">coord_distance</span> <span class="o">-</span> <span class="n">min_distance</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">1</span>  <span class="c1"># Termini further from the reference</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># Termini closer to the reference</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.get_atom_record" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_atom_record</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_atom_record</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">str</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Provides the Structure as a 'PDB' formatted string of Atom records</p>



  <p>Other Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>chain_id</code></b>
        
        <div class="doc-md-description">
          <p>str = None - The chain ID to use</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>atom_offset</code></b>
        
        <div class="doc-md-description">
          <p>int = 0 - How much to offset the atom number by. Default returns one-indexed</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>str</code>
        
        <div class="doc-md-description">
          <p>The archived .pdb formatted ATOM records for the Structure</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5346</span>
<span class="normal">5347</span>
<span class="normal">5348</span>
<span class="normal">5349</span>
<span class="normal">5350</span>
<span class="normal">5351</span>
<span class="normal">5352</span>
<span class="normal">5353</span>
<span class="normal">5354</span>
<span class="normal">5355</span>
<span class="normal">5356</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_atom_record</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Provides the Structure as a &#39;PDB&#39; formatted string of Atom records</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        chain_id: str = None - The chain ID to use</span>
<span class="sd">        atom_offset: int = 0 - How much to offset the atom number by. Default returns one-indexed</span>

<span class="sd">    Returns:</span>
<span class="sd">        The archived .pdb formatted ATOM records for the Structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">residue</span><span class="o">.</span><span class="fm">__str__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.get_fragments" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_fragments</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_fragments</span><span class="p">(</span><span class="n">residues</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">residue_numbers</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fragment_db</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.fragment.db.FragmentDatabase" href="../fragment/db/#structure.fragment.db.FragmentDatabase">FragmentDatabase</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.fragment.MonoFragment" href="../fragment/#structure.fragment.MonoFragment">MonoFragment</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>From the Structure, find Residues with a matching fragment type as identified in a fragment library</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>residues</code></b>
            (<code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The specific Residues to search for</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>residue_numbers</code></b>
            (<code>list[int]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The specific residue numbers to search for</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>fragment_db</code></b>
            (<code><a class="autorefs autorefs-internal" title="structure.fragment.db.FragmentDatabase" href="../fragment/db/#structure.fragment.db.FragmentDatabase">FragmentDatabase</a></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The FragmentDatabase with representative fragment types  to query against</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[<a class="autorefs autorefs-internal" title="structure.fragment.MonoFragment" href="../fragment/#structure.fragment.MonoFragment">MonoFragment</a>]</code>
        
        <div class="doc-md-description">
          <p>The MonoFragments found on the Structure</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5358</span>
<span class="normal">5359</span>
<span class="normal">5360</span>
<span class="normal">5361</span>
<span class="normal">5362</span>
<span class="normal">5363</span>
<span class="normal">5364</span>
<span class="normal">5365</span>
<span class="normal">5366</span>
<span class="normal">5367</span>
<span class="normal">5368</span>
<span class="normal">5369</span>
<span class="normal">5370</span>
<span class="normal">5371</span>
<span class="normal">5372</span>
<span class="normal">5373</span>
<span class="normal">5374</span>
<span class="normal">5375</span>
<span class="normal">5376</span>
<span class="normal">5377</span>
<span class="normal">5378</span>
<span class="normal">5379</span>
<span class="normal">5380</span>
<span class="normal">5381</span>
<span class="normal">5382</span>
<span class="normal">5383</span>
<span class="normal">5384</span>
<span class="normal">5385</span>
<span class="normal">5386</span>
<span class="normal">5387</span>
<span class="normal">5388</span>
<span class="normal">5389</span>
<span class="normal">5390</span>
<span class="normal">5391</span>
<span class="normal">5392</span>
<span class="normal">5393</span>
<span class="normal">5394</span>
<span class="normal">5395</span>
<span class="normal">5396</span>
<span class="normal">5397</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_fragments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residues</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Residue</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">residue_numbers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">fragment_db</span><span class="p">:</span> <span class="n">fragment</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">FragmentDatabase</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">fragment</span><span class="o">.</span><span class="n">MonoFragment</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;From the Structure, find Residues with a matching fragment type as identified in a fragment library</span>

<span class="sd">    Args:</span>
<span class="sd">        residues: The specific Residues to search for</span>
<span class="sd">        residue_numbers: The specific residue numbers to search for</span>
<span class="sd">        fragment_db: The FragmentDatabase with representative fragment types  to query against</span>

<span class="sd">    Returns:</span>
<span class="sd">        The MonoFragments found on the Structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">residues</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">residue_numbers</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[]</span>

    <span class="k">if</span> <span class="n">fragment_db</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fragment_db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragment_db</span>
        <span class="k">if</span> <span class="n">fragment_db</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t assign fragments without passing &#39;fragment_db&#39; or setting .fragment_db&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Without passing &#39;fragment_db&#39;, using the existing .fragment_db=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">fragment_db</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">fragment_db</span><span class="o">.</span><span class="n">representatives</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The passed fragment_db is not of the required type &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">fragment</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">FragmentDatabase</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="n">fragment_length</span> <span class="o">=</span> <span class="n">fragment_db</span><span class="o">.</span><span class="n">fragment_length</span>
    <span class="n">fragment_range</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="o">*</span><span class="n">fragment_db</span><span class="o">.</span><span class="n">fragment_range</span><span class="p">)</span>
    <span class="n">fragments</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">residue_number</span> <span class="ow">in</span> <span class="n">residue_numbers</span><span class="p">:</span>
        <span class="n">frag_residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_residues</span><span class="p">(</span><span class="n">numbers</span><span class="o">=</span><span class="p">[</span><span class="n">residue_number</span> <span class="o">+</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">fragment_range</span><span class="p">])</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">frag_residues</span><span class="p">)</span> <span class="o">==</span> <span class="n">fragment_length</span><span class="p">:</span>
            <span class="n">new_fragment</span> <span class="o">=</span> <span class="n">fragment</span><span class="o">.</span><span class="n">MonoFragment</span><span class="p">(</span><span class="n">residues</span><span class="o">=</span><span class="n">frag_residues</span><span class="p">,</span> <span class="n">fragment_db</span><span class="o">=</span><span class="n">fragment_db</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">new_fragment</span><span class="o">.</span><span class="n">i_type</span><span class="p">:</span>
                <span class="n">fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_fragment</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fragments</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.get_fragment_residues" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">get_fragment_residues</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">get_fragment_residues</span><span class="p">(</span><span class="n">residues</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">residue_numbers</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">fragment_db</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.fragment.db.FragmentDatabase" href="../fragment/db/#structure.fragment.db.FragmentDatabase">FragmentDatabase</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">rmsd_thresh</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="n">fragment</span><span class="o">.</span><span class="n">Fragment</span><span class="o">.</span><span class="n">rmsd_thresh</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span> <span class="o">|</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Assigns a Fragment type to Residue instances identified from a FragmentDatabase, and returns them</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>residues</code></b>
            (<code>list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The specific Residues to search for</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>residue_numbers</code></b>
            (<code>list[int]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The specific residue numbers to search for</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>fragment_db</code></b>
            (<code><a class="autorefs autorefs-internal" title="structure.fragment.db.FragmentDatabase" href="../fragment/db/#structure.fragment.db.FragmentDatabase">FragmentDatabase</a></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The FragmentDatabase with representative fragment types to query the Residue against</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>rmsd_thresh</code></b>
            (<code>float</code>, default:
                <code><span title="structure.fragment.Fragment.rmsd_thresh">rmsd_thresh</span></code>
)
        
        <div class="doc-md-description">
          <p>The threshold for which a rmsd should fail to produce a fragment match</p>
        </div>
      </li>
  </ul>

<details class="sets" open>
  <summary>Sets</summary>
  <p>Each Fragment Residue instance self.guide_coords, self.i_type</p>
</details>


  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list | list[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>]</code>
        
        <div class="doc-md-description">
          <p>The Residue instances that match Fragment representatives from the Structure</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5400</span>
<span class="normal">5401</span>
<span class="normal">5402</span>
<span class="normal">5403</span>
<span class="normal">5404</span>
<span class="normal">5405</span>
<span class="normal">5406</span>
<span class="normal">5407</span>
<span class="normal">5408</span>
<span class="normal">5409</span>
<span class="normal">5410</span>
<span class="normal">5411</span>
<span class="normal">5412</span>
<span class="normal">5413</span>
<span class="normal">5414</span>
<span class="normal">5415</span>
<span class="normal">5416</span>
<span class="normal">5417</span>
<span class="normal">5418</span>
<span class="normal">5419</span>
<span class="normal">5420</span>
<span class="normal">5421</span>
<span class="normal">5422</span>
<span class="normal">5423</span>
<span class="normal">5424</span>
<span class="normal">5425</span>
<span class="normal">5426</span>
<span class="normal">5427</span>
<span class="normal">5428</span>
<span class="normal">5429</span>
<span class="normal">5430</span>
<span class="normal">5431</span>
<span class="normal">5432</span>
<span class="normal">5433</span>
<span class="normal">5434</span>
<span class="normal">5435</span>
<span class="normal">5436</span>
<span class="normal">5437</span>
<span class="normal">5438</span>
<span class="normal">5439</span>
<span class="normal">5440</span>
<span class="normal">5441</span>
<span class="normal">5442</span>
<span class="normal">5443</span>
<span class="normal">5444</span>
<span class="normal">5445</span>
<span class="normal">5446</span>
<span class="normal">5447</span>
<span class="normal">5448</span>
<span class="normal">5449</span>
<span class="normal">5450</span>
<span class="normal">5451</span>
<span class="normal">5452</span>
<span class="normal">5453</span>
<span class="normal">5454</span>
<span class="normal">5455</span>
<span class="normal">5456</span>
<span class="normal">5457</span>
<span class="normal">5458</span>
<span class="normal">5459</span>
<span class="normal">5460</span>
<span class="normal">5461</span>
<span class="normal">5462</span>
<span class="normal">5463</span>
<span class="normal">5464</span>
<span class="normal">5465</span>
<span class="normal">5466</span>
<span class="normal">5467</span>
<span class="normal">5468</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_fragment_residues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residues</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Residue</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">residue_numbers</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="n">fragment_db</span><span class="p">:</span> <span class="n">fragment</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">FragmentDatabase</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="n">rmsd_thresh</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">fragment</span><span class="o">.</span><span class="n">Fragment</span><span class="o">.</span><span class="n">rmsd_thresh</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">list</span><span class="p">[</span><span class="n">Residue</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Assigns a Fragment type to Residue instances identified from a FragmentDatabase, and returns them</span>

<span class="sd">    Args:</span>
<span class="sd">        residues: The specific Residues to search for</span>
<span class="sd">        residue_numbers: The specific residue numbers to search for</span>
<span class="sd">        fragment_db: The FragmentDatabase with representative fragment types to query the Residue against</span>
<span class="sd">        rmsd_thresh: The threshold for which a rmsd should fail to produce a fragment match</span>

<span class="sd">    Sets:</span>
<span class="sd">        Each Fragment Residue instance self.guide_coords, self.i_type</span>

<span class="sd">    Returns:</span>
<span class="sd">        The Residue instances that match Fragment representatives from the Structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fragment_db</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fragment_db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragment_db</span>
        <span class="k">if</span> <span class="n">fragment_db</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t assign fragments without passing &#39;fragment_db&#39; or setting .fragment_db&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Without passing &#39;fragment_db&#39;, using the existing .fragment_db=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">fragment_db</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">fragment_db</span><span class="o">.</span><span class="n">representatives</span>
    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The passed fragment_db is not of the required type &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">fragment</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">FragmentDatabase</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">residue_numbers</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_residues</span><span class="p">(</span><span class="n">numbers</span><span class="o">=</span><span class="n">residue_numbers</span><span class="p">)</span>

    <span class="c1"># Get iterable of residues</span>
    <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span> <span class="k">if</span> <span class="n">residues</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">residues</span>

    <span class="c1"># Get neighboring ca coords on each side by retrieving flanking residues. If not fragment_length, remove</span>
    <span class="n">fragment_length</span> <span class="o">=</span> <span class="n">fragment_db</span><span class="o">.</span><span class="n">fragment_length</span>
    <span class="n">frag_lower_range</span><span class="p">,</span> <span class="n">frag_upper_range</span> <span class="o">=</span> <span class="n">fragment_db</span><span class="o">.</span><span class="n">fragment_range</span>

    <span class="c1"># Iterate over the residues in reverse to remove any indices that are missing and convert to coordinates</span>
    <span class="n">viable_residues</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">residues_ca_coords</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
        <span class="n">residue_set</span> <span class="o">=</span> \
            <span class="n">residue</span><span class="o">.</span><span class="n">get_upstream</span><span class="p">(</span><span class="n">frag_lower_range</span><span class="p">)</span> <span class="o">+</span> <span class="p">[</span><span class="n">residue</span><span class="p">]</span> <span class="o">+</span> <span class="n">residue</span><span class="o">.</span><span class="n">get_downstream</span><span class="p">(</span><span class="n">frag_upper_range</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">residue_set</span><span class="p">)</span> <span class="o">==</span> <span class="n">fragment_length</span><span class="p">:</span>
            <span class="n">residues_ca_coords</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">residue</span><span class="o">.</span><span class="n">ca_coords</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residue_set</span><span class="p">])</span>
            <span class="n">viable_residues</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">residue</span><span class="p">)</span>

    <span class="n">residue_ca_coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">residues_ca_coords</span><span class="p">)</span>

    <span class="c1"># Solve for fragment type (secondary structure classification could be used too)</span>
    <span class="n">found_fragments</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">residue</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">viable_residues</span><span class="p">):</span>
        <span class="n">min_rmsd</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
        <span class="n">residue_ca_coord_set</span> <span class="o">=</span> <span class="n">residue_ca_coords</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">fragment_type</span><span class="p">,</span> <span class="n">representative</span> <span class="ow">in</span> <span class="n">fragment_db</span><span class="o">.</span><span class="n">representatives</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">rmsd</span><span class="p">,</span> <span class="n">rot</span><span class="p">,</span> <span class="n">tx</span> <span class="o">=</span> <span class="n">superposition3d</span><span class="p">(</span><span class="n">residue_ca_coord_set</span><span class="p">,</span> <span class="n">representative</span><span class="o">.</span><span class="n">ca_coords</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">rmsd</span> <span class="o">&lt;=</span> <span class="n">rmsd_thresh</span> <span class="ow">and</span> <span class="n">rmsd</span> <span class="o">&lt;=</span> <span class="n">min_rmsd</span><span class="p">:</span>
                <span class="n">residue</span><span class="o">.</span><span class="n">frag_type</span> <span class="o">=</span> <span class="n">fragment_type</span>
                <span class="n">min_rmsd</span> <span class="o">=</span> <span class="n">rmsd</span>

        <span class="k">if</span> <span class="n">residue</span><span class="o">.</span><span class="n">frag_type</span><span class="p">:</span>
            <span class="n">residue</span><span class="o">.</span><span class="n">fragment_db</span> <span class="o">=</span> <span class="n">fragment_db</span>
            <span class="n">residue</span><span class="o">.</span><span class="n">_fragment_coords</span> <span class="o">=</span> <span class="n">fragment_db</span><span class="o">.</span><span class="n">representatives</span><span class="p">[</span><span class="n">residue</span><span class="o">.</span><span class="n">frag_type</span><span class="p">]</span><span class="o">.</span><span class="n">backbone_coords</span>
            <span class="n">found_fragments</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">residue</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">found_fragments</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.find_fragments" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">find_fragments</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">find_fragments</span><span class="p">(</span><span class="n">fragment_db</span><span class="p">:</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.fragment.db.FragmentDatabase" href="../fragment/db/#structure.fragment.db.FragmentDatabase">FragmentDatabase</a></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n">tuple</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.fragment.GhostFragment" href="../fragment/#structure.fragment.GhostFragment">GhostFragment</a></span><span class="p">,</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.fragment.Fragment" href="../fragment/#structure.fragment.Fragment">Fragment</a></span><span class="p">,</span> <span class="n">float</span><span class="p">]]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Search Residue instances to find Fragment instances that are neighbors, returning all Fragment pairs.
By default, returns all Residue instances neighboring FragmentResidue instances</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>fragment_db</code></b>
            (<code><a class="autorefs autorefs-internal" title="structure.fragment.db.FragmentDatabase" href="../fragment/db/#structure.fragment.db.FragmentDatabase">FragmentDatabase</a></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The FragmentDatabase with representative fragment types to query the Residue against</p>
        </div>
      </li>
  </ul>



  <p>Other Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>residues</code></b>
        
        <div class="doc-md-description">
          <p>list[Residue] = None - The specific Residues to search for</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>residue_numbers</code></b>
        
        <div class="doc-md-description">
          <p>list[int] = None - The specific residue numbers to search for</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>rmsd_thresh</code></b>
        
        <div class="doc-md-description">
          <p>float = fragment.Fragment.rmsd_thresh - The threshold for which a rmsd should fail to produce
a fragment match</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>distance</code></b>
        
        <div class="doc-md-description">
          <p>float = 8.0 - The distance to query for neighboring fragments</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>min_match_value</code></b>
        
        <div class="doc-md-description">
          <p>float = 2 - The minimum value which constitutes an acceptable fragment z_score</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>clash_coords</code></b>
        
        <div class="doc-md-description">
          <p>np.ndarray = None  The coordinates to use for checking for GhostFragment clashes</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[tuple[<a class="autorefs autorefs-internal" title="structure.fragment.GhostFragment" href="../fragment/#structure.fragment.GhostFragment">GhostFragment</a>, <a class="autorefs autorefs-internal" title="structure.fragment.Fragment" href="../fragment/#structure.fragment.Fragment">Fragment</a>, float]]</code>
        
        <div class="doc-md-description">
          <p>The GhostFragment, Fragment pairs, along with their match score</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5470</span>
<span class="normal">5471</span>
<span class="normal">5472</span>
<span class="normal">5473</span>
<span class="normal">5474</span>
<span class="normal">5475</span>
<span class="normal">5476</span>
<span class="normal">5477</span>
<span class="normal">5478</span>
<span class="normal">5479</span>
<span class="normal">5480</span>
<span class="normal">5481</span>
<span class="normal">5482</span>
<span class="normal">5483</span>
<span class="normal">5484</span>
<span class="normal">5485</span>
<span class="normal">5486</span>
<span class="normal">5487</span>
<span class="normal">5488</span>
<span class="normal">5489</span>
<span class="normal">5490</span>
<span class="normal">5491</span>
<span class="normal">5492</span>
<span class="normal">5493</span>
<span class="normal">5494</span>
<span class="normal">5495</span>
<span class="normal">5496</span>
<span class="normal">5497</span>
<span class="normal">5498</span>
<span class="normal">5499</span>
<span class="normal">5500</span>
<span class="normal">5501</span>
<span class="normal">5502</span>
<span class="normal">5503</span>
<span class="normal">5504</span>
<span class="normal">5505</span>
<span class="normal">5506</span>
<span class="normal">5507</span>
<span class="normal">5508</span>
<span class="normal">5509</span>
<span class="normal">5510</span>
<span class="normal">5511</span>
<span class="normal">5512</span>
<span class="normal">5513</span>
<span class="normal">5514</span>
<span class="normal">5515</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">find_fragments</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fragment_db</span><span class="p">:</span> <span class="n">fragment</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">FragmentDatabase</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> \
        <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">fragment</span><span class="o">.</span><span class="n">GhostFragment</span><span class="p">,</span> <span class="n">fragment</span><span class="o">.</span><span class="n">Fragment</span><span class="p">,</span> <span class="nb">float</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Search Residue instances to find Fragment instances that are neighbors, returning all Fragment pairs.</span>
<span class="sd">    By default, returns all Residue instances neighboring FragmentResidue instances</span>

<span class="sd">    Args:</span>
<span class="sd">        fragment_db: The FragmentDatabase with representative fragment types to query the Residue against</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        residues: list[Residue] = None - The specific Residues to search for</span>
<span class="sd">        residue_numbers: list[int] = None - The specific residue numbers to search for</span>
<span class="sd">        rmsd_thresh: float = fragment.Fragment.rmsd_thresh - The threshold for which a rmsd should fail to produce</span>
<span class="sd">            a fragment match</span>
<span class="sd">        distance: float = 8.0 - The distance to query for neighboring fragments</span>
<span class="sd">        min_match_value: float = 2 - The minimum value which constitutes an acceptable fragment z_score</span>
<span class="sd">        clash_coords: np.ndarray = None  The coordinates to use for checking for GhostFragment clashes</span>

<span class="sd">    Returns:</span>
<span class="sd">        The GhostFragment, Fragment pairs, along with their match score</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">fragment_db</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fragment_db</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fragment_db</span>
        <span class="k">if</span> <span class="n">fragment_db</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Can&#39;t assign fragments without passing &#39;fragment_db&#39; or setting .fragment_db&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Without passing &#39;fragment_db&#39;, using the existing .fragment_db=</span><span class="si">{</span><span class="nb">repr</span><span class="p">(</span><span class="n">fragment_db</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">fragment_time_start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">frag_residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_fragment_residues</span><span class="p">(</span><span class="n">fragment_db</span><span class="o">=</span><span class="n">fragment_db</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">frag_residues</span><span class="p">)</span><span class="si">}</span><span class="s1"> fragments on </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">frag_residue_indices</span> <span class="o">=</span> <span class="p">[</span><span class="n">residue</span><span class="o">.</span><span class="n">index</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">frag_residues</span><span class="p">]</span>
    <span class="n">all_fragment_pairs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">frag_residue</span> <span class="ow">in</span> <span class="n">frag_residues</span><span class="p">:</span>
        <span class="c1"># frag_neighbors = frag_residue.get_residue_neighbors(**kwargs)</span>
        <span class="n">neighbors</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_residues_by_atom_indices</span><span class="p">(</span><span class="n">frag_residue</span><span class="o">.</span><span class="n">neighboring_atom_indices</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>
        <span class="c1"># THIS GETS NON-SELF FRAGMENTS TOO</span>
        <span class="c1"># frag_neighbors = [residue for residue in neighbors if residue.frag_type]</span>
        <span class="c1"># if not frag_neighbors:</span>
        <span class="c1">#     continue</span>
        <span class="n">frag_neighbors</span> <span class="o">=</span> <span class="p">[</span><span class="n">residue</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">neighbors</span> <span class="k">if</span> <span class="n">residue</span><span class="o">.</span><span class="n">index</span> <span class="ow">in</span> <span class="n">frag_residue_indices</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">frag_neighbors</span><span class="p">:</span>
            <span class="k">continue</span>
        <span class="n">all_fragment_pairs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">fragment</span><span class="o">.</span><span class="n">find_fragment_overlap</span><span class="p">([</span><span class="n">frag_residue</span><span class="p">],</span> <span class="n">frag_neighbors</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Took </span><span class="si">{</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">fragment_time_start</span><span class="si">:</span><span class="s1">.8f</span><span class="si">}</span><span class="s1">s&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">all_fragment_pairs</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.spatial_aggregation_propensity_per_residue" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">spatial_aggregation_propensity_per_residue</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">spatial_aggregation_propensity_per_residue</span><span class="p">(</span><span class="n">distance</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculate the spatial aggregation propensity on a per-residue basis using calculated heavy atom contacts to
define which Residue instances are in contact.</p>
<p>Caution: Contrasts with published method due to use of relative sasa for each Residue instance instead of
relative sasa for each Atom instance</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>distance</code></b>
            (<code>float</code>, default:
                <code>5.0</code>
)
        
        <div class="doc-md-description">
          <p>The distance in angstroms to measure Atom instances in contact</p>
        </div>
      </li>
  </ul>



  <p>Other Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>probe_radius</code></b>
        
        <div class="doc-md-description">
          <p>float = 1.4 - The radius which surface area should be generated</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[float]</code>
        
        <div class="doc-md-description">
          <p>The floats representing the spatial aggregation propensity for each Residue in the Structure</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5530</span>
<span class="normal">5531</span>
<span class="normal">5532</span>
<span class="normal">5533</span>
<span class="normal">5534</span>
<span class="normal">5535</span>
<span class="normal">5536</span>
<span class="normal">5537</span>
<span class="normal">5538</span>
<span class="normal">5539</span>
<span class="normal">5540</span>
<span class="normal">5541</span>
<span class="normal">5542</span>
<span class="normal">5543</span>
<span class="normal">5544</span>
<span class="normal">5545</span>
<span class="normal">5546</span>
<span class="normal">5547</span>
<span class="normal">5548</span>
<span class="normal">5549</span>
<span class="normal">5550</span>
<span class="normal">5551</span>
<span class="normal">5552</span>
<span class="normal">5553</span>
<span class="normal">5554</span>
<span class="normal">5555</span>
<span class="normal">5556</span>
<span class="normal">5557</span>
<span class="normal">5558</span>
<span class="normal">5559</span>
<span class="normal">5560</span>
<span class="normal">5561</span>
<span class="normal">5562</span>
<span class="normal">5563</span>
<span class="normal">5564</span>
<span class="normal">5565</span>
<span class="normal">5566</span>
<span class="normal">5567</span>
<span class="normal">5568</span>
<span class="normal">5569</span>
<span class="normal">5570</span>
<span class="normal">5571</span>
<span class="normal">5572</span>
<span class="normal">5573</span>
<span class="normal">5574</span>
<span class="normal">5575</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">spatial_aggregation_propensity_per_residue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the spatial aggregation propensity on a per-residue basis using calculated heavy atom contacts to</span>
<span class="sd">    define which Residue instances are in contact.</span>

<span class="sd">    Caution: Contrasts with published method due to use of relative sasa for each Residue instance instead of</span>
<span class="sd">    relative sasa for each Atom instance</span>

<span class="sd">    Args:</span>
<span class="sd">        distance: The distance in angstroms to measure Atom instances in contact</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        probe_radius: float = 1.4 - The radius which surface area should be generated</span>

<span class="sd">    Returns:</span>
<span class="sd">        The floats representing the spatial aggregation propensity for each Residue in the Structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># SASA Keyword args that are not reported as available</span>
    <span class="c1"># atom: bool = True - Whether the output should be generated for each atom.</span>
    <span class="c1">#     If False, will be generated for each Residue</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">sasa</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_sasa</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="c1"># Set up the hydrophobicity parameters</span>
    <span class="n">hydrophobicity_</span> <span class="o">=</span> <span class="n">hydrophobicity_values_glycine_centered</span><span class="p">[</span><span class="s1">&#39;black_and_mould&#39;</span><span class="p">]</span>
    <span class="c1"># Get heavy Atom coordinates</span>
    <span class="n">heavy_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">heavy_coords</span>
    <span class="c1"># Make and query a tree</span>
    <span class="n">tree</span> <span class="o">=</span> <span class="n">BallTree</span><span class="p">(</span><span class="n">heavy_coords</span><span class="p">)</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">query_radius</span><span class="p">(</span><span class="n">heavy_coords</span><span class="p">,</span> <span class="n">distance</span><span class="p">)</span>

    <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span>
    <span class="c1"># In case this was already called, all should be set to 0.0</span>
    <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
        <span class="n">residue</span><span class="o">.</span><span class="n">spatial_aggregation_propensity</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="c1"># Set the hydrophobicity_ attribute in a first pass to reduce repetitive lookups</span>
        <span class="n">residue</span><span class="o">.</span><span class="n">hydrophobicity_</span> <span class="o">=</span> <span class="n">hydrophobicity_</span><span class="p">[</span><span class="n">residue</span><span class="o">.</span><span class="n">type</span><span class="p">]</span>

    <span class="n">heavy_atom_coords_indexed_residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">heavy_coords_indexed_residues</span>
    <span class="n">contacting_pairs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="n">heavy_atom_coords_indexed_residues</span><span class="p">[</span><span class="n">idx1</span><span class="p">],</span> <span class="n">heavy_atom_coords_indexed_residues</span><span class="p">[</span><span class="n">idx2</span><span class="p">])</span>
                           <span class="k">for</span> <span class="n">idx2</span><span class="p">,</span> <span class="n">contacts</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span> <span class="k">for</span> <span class="n">idx1</span> <span class="ow">in</span> <span class="n">contacts</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="c1"># Residue.spatial_aggregation_propensity starts as 0., so we are adding any observation to that attribute</span>
    <span class="k">for</span> <span class="n">residue1</span><span class="p">,</span> <span class="n">residue2</span> <span class="ow">in</span> <span class="n">contacting_pairs</span><span class="p">:</span>
        <span class="c1"># Multiply suggested hydrophobicity value by the Residue.relative_sasa</span>
        <span class="c1"># Only set on residue1 as this is the &quot;center&quot; of the calculation</span>
        <span class="n">residue1</span><span class="o">.</span><span class="n">spatial_aggregation_propensity</span> <span class="o">=</span> <span class="n">residue2</span><span class="o">.</span><span class="n">hydrophobicity_</span> <span class="o">*</span> <span class="n">residue2</span><span class="o">.</span><span class="n">relative_sasa</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">residue</span><span class="o">.</span><span class="n">spatial_aggregation_propensity</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.contact_order_per_residue" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">contact_order_per_residue</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">contact_order_per_residue</span><span class="p">(</span><span class="n">sequence_distance_cutoff</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="mf">6.0</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n">float</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Calculate the contact order on a per-residue basis using calculated heavy atom contacts</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>sequence_distance_cutoff</code></b>
            (<code>int</code>, default:
                <code>2</code>
)
        
        <div class="doc-md-description">
          <p>The residue spacing required to count a contact as a true contact</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>distance</code></b>
            (<code>float</code>, default:
                <code>6.0</code>
)
        
        <div class="doc-md-description">
          <p>The distance in angstroms to measure Atom instances in contact</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[float]</code>
        
        <div class="doc-md-description">
          <p>The floats representing the contact order for each Residue in the Structure</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5609</span>
<span class="normal">5610</span>
<span class="normal">5611</span>
<span class="normal">5612</span>
<span class="normal">5613</span>
<span class="normal">5614</span>
<span class="normal">5615</span>
<span class="normal">5616</span>
<span class="normal">5617</span>
<span class="normal">5618</span>
<span class="normal">5619</span>
<span class="normal">5620</span>
<span class="normal">5621</span>
<span class="normal">5622</span>
<span class="normal">5623</span>
<span class="normal">5624</span>
<span class="normal">5625</span>
<span class="normal">5626</span>
<span class="normal">5627</span>
<span class="normal">5628</span>
<span class="normal">5629</span>
<span class="normal">5630</span>
<span class="normal">5631</span>
<span class="normal">5632</span>
<span class="normal">5633</span>
<span class="normal">5634</span>
<span class="normal">5635</span>
<span class="normal">5636</span>
<span class="normal">5637</span>
<span class="normal">5638</span>
<span class="normal">5639</span>
<span class="normal">5640</span>
<span class="normal">5641</span>
<span class="normal">5642</span>
<span class="normal">5643</span>
<span class="normal">5644</span>
<span class="normal">5645</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">contact_order_per_residue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence_distance_cutoff</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">distance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">6.</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Calculate the contact order on a per-residue basis using calculated heavy atom contacts</span>

<span class="sd">    Args:</span>
<span class="sd">        sequence_distance_cutoff: The residue spacing required to count a contact as a true contact</span>
<span class="sd">        distance: The distance in angstroms to measure Atom instances in contact</span>

<span class="sd">    Returns:</span>
<span class="sd">        The floats representing the contact order for each Residue in the Structure</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Get heavy Atom coordinates</span>
    <span class="n">heavy_coords</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">heavy_coords</span>
    <span class="c1"># Make and query a tree</span>
    <span class="n">tree</span> <span class="o">=</span> <span class="n">BallTree</span><span class="p">(</span><span class="n">heavy_coords</span><span class="p">)</span>
    <span class="n">query</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">query_radius</span><span class="p">(</span><span class="n">heavy_coords</span><span class="p">,</span> <span class="n">distance</span><span class="p">)</span>

    <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span>
    <span class="c1"># In case this was already called, we should set all to 0.0</span>
    <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
        <span class="n">residue</span><span class="o">.</span><span class="n">contact_order</span> <span class="o">=</span> <span class="mf">0.</span>

    <span class="n">heavy_atom_coords_indexed_residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">heavy_coords_indexed_residues</span>
    <span class="n">contacting_pairs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">((</span><span class="n">heavy_atom_coords_indexed_residues</span><span class="p">[</span><span class="n">idx1</span><span class="p">],</span> <span class="n">heavy_atom_coords_indexed_residues</span><span class="p">[</span><span class="n">idx2</span><span class="p">])</span>
                           <span class="k">for</span> <span class="n">idx2</span><span class="p">,</span> <span class="n">contacts</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">query</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span> <span class="k">for</span> <span class="n">idx1</span> <span class="ow">in</span> <span class="n">contacts</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
    <span class="c1"># Residue.contact_order starts as 0., so we are adding any observation to that attribute</span>
    <span class="k">for</span> <span class="n">residue1</span><span class="p">,</span> <span class="n">residue2</span> <span class="ow">in</span> <span class="n">contacting_pairs</span><span class="p">:</span>
        <span class="c1"># Calculate using number since index might not actually specify the intended distance</span>
        <span class="n">residue_sequence_distance</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">residue1</span><span class="o">.</span><span class="n">number</span> <span class="o">-</span> <span class="n">residue2</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">residue_sequence_distance</span> <span class="o">&gt;=</span> <span class="n">sequence_distance_cutoff</span><span class="p">:</span>
            <span class="c1"># Only set on residue1 so that we don&#39;t overcount</span>
            <span class="n">residue1</span><span class="o">.</span><span class="n">contact_order</span> <span class="o">+=</span> <span class="n">residue_sequence_distance</span>

    <span class="n">number_residues</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">residues</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">:</span>
        <span class="n">residue</span><span class="o">.</span><span class="n">contact_order</span> <span class="o">/=</span> <span class="n">number_residues</span>

    <span class="k">return</span> <span class="p">[</span><span class="n">residue</span><span class="o">.</span><span class="n">contact_order</span> <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="n">residues</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.format_resfile_from_directives" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">format_resfile_from_directives</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">format_resfile_from_directives</span><span class="p">(</span><span class="n">residue_directives</span><span class="p">:</span> <span class="n">dict</span><span class="p">[</span><span class="n">int</span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">,</span> <span class="n">str</span><span class="p">],</span> <span class="n">include</span><span class="p">:</span> <span class="n">dict</span><span class="p">[</span><span class="n">int</span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">,</span> <span class="n">set</span><span class="p">[</span><span class="n">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">background</span><span class="p">:</span> <span class="n">dict</span><span class="p">[</span><span class="n">int</span> <span class="o">|</span> <span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span><span class="p">,</span> <span class="n">set</span><span class="p">[</span><span class="n">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">list</span><span class="p">[</span><span class="n">str</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Format Residue mutational potentials given Residues/residue numbers and corresponding mutation directive.
Optionally, include specific amino acids and limit to a specific background. Both dictionaries accessed by same
keys as residue_directives</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>residue_directives</code></b>
            (<code>dict[int | <a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>, str]</code>)
        
        <div class="doc-md-description">
          <p>{Residue object: 'mutational_directive', ...}</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>include</code></b>
            (<code>dict[int | <a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>, set[str]]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>Include a set of specific amino acids for each residue</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>background</code></b>
            (<code>dict[int | <a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a>, set[str]]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The background amino acids to compare possibilities against</p>
        </div>
      </li>
  </ul>



  <p>Other Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>special</code></b>
        
        <div class="doc-md-description">
          <p>bool = False - Whether to include special residues</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>list[str]</code>
        
        <div class="doc-md-description">
          <p>For each Residue, returns the string formatted for a resfile with a 'PIKAA' and amino acid type string</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5686</span>
<span class="normal">5687</span>
<span class="normal">5688</span>
<span class="normal">5689</span>
<span class="normal">5690</span>
<span class="normal">5691</span>
<span class="normal">5692</span>
<span class="normal">5693</span>
<span class="normal">5694</span>
<span class="normal">5695</span>
<span class="normal">5696</span>
<span class="normal">5697</span>
<span class="normal">5698</span>
<span class="normal">5699</span>
<span class="normal">5700</span>
<span class="normal">5701</span>
<span class="normal">5702</span>
<span class="normal">5703</span>
<span class="normal">5704</span>
<span class="normal">5705</span>
<span class="normal">5706</span>
<span class="normal">5707</span>
<span class="normal">5708</span>
<span class="normal">5709</span>
<span class="normal">5710</span>
<span class="normal">5711</span>
<span class="normal">5712</span>
<span class="normal">5713</span>
<span class="normal">5714</span>
<span class="normal">5715</span>
<span class="normal">5716</span>
<span class="normal">5717</span>
<span class="normal">5718</span>
<span class="normal">5719</span>
<span class="normal">5720</span>
<span class="normal">5721</span>
<span class="normal">5722</span>
<span class="normal">5723</span>
<span class="normal">5724</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">format_resfile_from_directives</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residue_directives</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="n">Residue</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span>
                                   <span class="n">include</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="n">Residue</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                   <span class="n">background</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">int</span> <span class="o">|</span> <span class="n">Residue</span><span class="p">,</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Format Residue mutational potentials given Residues/residue numbers and corresponding mutation directive.</span>
<span class="sd">    Optionally, include specific amino acids and limit to a specific background. Both dictionaries accessed by same</span>
<span class="sd">    keys as residue_directives</span>

<span class="sd">    Args:</span>
<span class="sd">        residue_directives: {Residue object: &#39;mutational_directive&#39;, ...}</span>
<span class="sd">        include: Include a set of specific amino acids for each residue</span>
<span class="sd">        background: The background amino acids to compare possibilities against</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        special: bool = False - Whether to include special residues</span>

<span class="sd">    Returns:</span>
<span class="sd">        For each Residue, returns the string formatted for a resfile with a &#39;PIKAA&#39; and amino acid type string</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">background</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">background</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">include</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">include</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="n">res_file_lines</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">residues</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span>
    <span class="k">for</span> <span class="n">residue_index</span><span class="p">,</span> <span class="n">directive</span> <span class="ow">in</span> <span class="n">residue_directives</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">residue_index</span><span class="p">,</span> <span class="n">Residue</span><span class="p">):</span>
            <span class="n">residue</span> <span class="o">=</span> <span class="n">residue_index</span>
            <span class="n">residue_index</span> <span class="o">=</span> <span class="n">residue</span><span class="o">.</span><span class="n">index</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">residue</span> <span class="o">=</span> <span class="n">residues</span><span class="p">[</span><span class="n">residue_index</span><span class="p">]</span>

        <span class="n">allowed_aas</span> <span class="o">=</span> <span class="n">residue</span><span class="o">.</span><span class="n">mutation_possibilities_from_directive</span><span class="p">(</span>
            <span class="n">directive</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="n">background</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">residue_index</span><span class="p">),</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">allowed_aas</span> <span class="o">=</span> <span class="p">{</span><span class="n">protein_letters_3to1_extended</span><span class="p">[</span><span class="n">aa</span><span class="p">]</span> <span class="k">for</span> <span class="n">aa</span> <span class="ow">in</span> <span class="n">allowed_aas</span><span class="p">}</span>
        <span class="n">allowed_aas</span> <span class="o">=</span> <span class="n">allowed_aas</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="n">include</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">residue_index</span><span class="p">,</span> <span class="p">{}))</span>
        <span class="n">res_file_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">residue</span><span class="o">.</span><span class="n">number</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">residue</span><span class="o">.</span><span class="n">chain_id</span><span class="si">}</span><span class="s1"> PIKAA </span><span class="si">{</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">allowed_aas</span><span class="p">))</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">res_file_lines</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.make_resfile" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">make_resfile</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">make_resfile</span><span class="p">(</span><span class="n">residue_directives</span><span class="p">:</span> <span class="n">dict</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a></span> <span class="o">|</span> <span class="n">int</span><span class="p">,</span> <span class="n">str</span><span class="p">],</span> <span class="n">out_path</span><span class="p">:</span> <span class="n"><span title="typing.AnyStr">AnyStr</span></span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">header</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n"><span title="typing.AnyStr">AnyStr</span></span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Format a resfile for the Rosetta Packer from Residue mutational directives</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>residue_directives</code></b>
            (<code>dict[<a class="autorefs autorefs-internal" title="structure.base.Residue" href="#structure.base.Residue">Residue</a> | int, str]</code>)
        
        <div class="doc-md-description">
          <p>{Residue/int: 'mutational_directive', ...}</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>out_path</code></b>
            (<code><span title="typing.AnyStr">AnyStr</span></code>, default:
                <code><span title="os.getcwd">getcwd</span>()</code>
)
        
        <div class="doc-md-description">
          <p>Directory to write the file</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>header</code></b>
            (<code>list[str]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>A header to constrain all Residues for packing</p>
        </div>
      </li>
  </ul>



  <p>Other Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>include</code></b>
        
        <div class="doc-md-description">
          <p>dict[Residue | int, set[str]] = None - Include a set of specific amino acids for each residue</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>background</code></b>
        
        <div class="doc-md-description">
          <p>dict[Residue | int, set[str]] = None - The background amino acids to compare possibilities</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>special</code></b>
        
        <div class="doc-md-description">
          <p>bool = False - Whether to include special residues</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code><span title="typing.AnyStr">AnyStr</span></code>
        
        <div class="doc-md-description">
          <p>The path to the resfile</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5726</span>
<span class="normal">5727</span>
<span class="normal">5728</span>
<span class="normal">5729</span>
<span class="normal">5730</span>
<span class="normal">5731</span>
<span class="normal">5732</span>
<span class="normal">5733</span>
<span class="normal">5734</span>
<span class="normal">5735</span>
<span class="normal">5736</span>
<span class="normal">5737</span>
<span class="normal">5738</span>
<span class="normal">5739</span>
<span class="normal">5740</span>
<span class="normal">5741</span>
<span class="normal">5742</span>
<span class="normal">5743</span>
<span class="normal">5744</span>
<span class="normal">5745</span>
<span class="normal">5746</span>
<span class="normal">5747</span>
<span class="normal">5748</span>
<span class="normal">5749</span>
<span class="normal">5750</span>
<span class="normal">5751</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">make_resfile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">residue_directives</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Residue</span> <span class="o">|</span> <span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">out_path</span><span class="p">:</span> <span class="n">AnyStr</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span>
                 <span class="n">header</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">AnyStr</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Format a resfile for the Rosetta Packer from Residue mutational directives</span>

<span class="sd">    Args:</span>
<span class="sd">        residue_directives: {Residue/int: &#39;mutational_directive&#39;, ...}</span>
<span class="sd">        out_path: Directory to write the file</span>
<span class="sd">        header: A header to constrain all Residues for packing</span>

<span class="sd">    Keyword Args:</span>
<span class="sd">        include: dict[Residue | int, set[str]] = None - Include a set of specific amino acids for each residue</span>
<span class="sd">        background: dict[Residue | int, set[str]] = None - The background amino acids to compare possibilities</span>
<span class="sd">        special: bool = False - Whether to include special residues</span>

<span class="sd">    Returns:</span>
<span class="sd">        The path to the resfile</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">residue_lines</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">format_resfile_from_directives</span><span class="p">(</span><span class="n">residue_directives</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">res_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">out_path</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">.resfile&#39;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">res_file</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="c1"># Format the header</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">header</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;start&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="n">header</span> <span class="k">else</span> <span class="s1">&#39;start&#39;</span><span class="p">))</span>
        <span class="c1"># Start the body</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%s</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">residue_lines</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">res_file</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.set_b_factor_by_attribute" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">set_b_factor_by_attribute</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">set_b_factor_by_attribute</span><span class="p">(</span><span class="n">dtype</span><span class="p">:</span> <span class="n"><span title="structure.base.residue_attributes_literal">residue_attributes_literal</span></span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Set the b-factor entry for every Residue to a Residue attribute</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>dtype</code></b>
            (<code><span title="structure.base.residue_attributes_literal">residue_attributes_literal</span></code>)
        
        <div class="doc-md-description">
          <p>The attribute of interest</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5753</span>
<span class="normal">5754</span>
<span class="normal">5755</span>
<span class="normal">5756</span>
<span class="normal">5757</span>
<span class="normal">5758</span>
<span class="normal">5759</span>
<span class="normal">5760</span>
<span class="normal">5761</span>
<span class="normal">5762</span>
<span class="normal">5763</span>
<span class="normal">5764</span>
<span class="normal">5765</span>
<span class="normal">5766</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_b_factor_by_attribute</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">residue_attributes_literal</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the b-factor entry for every Residue to a Residue attribute</span>

<span class="sd">    Args:</span>
<span class="sd">        dtype: The attribute of interest</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="c1"># self.set_residues_attributes(b_factor=dtype)</span>
        <span class="k">for</span> <span class="n">residue</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">residues</span><span class="p">:</span>
            <span class="n">residue</span><span class="o">.</span><span class="n">b_factor</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">residue</span><span class="p">,</span> <span class="n">dtype</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The type &#39;</span><span class="si">{</span><span class="n">dtype</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; isn&#39;t a string. To </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">set_b_factor_by_attribute</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">, &quot;</span>
            <span class="s2">&quot;you must provide &#39;dtype&#39; as a string specifying a Residue attribute&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="structure.base.ContainsResidues.set_b_factor_data" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">set_b_factor_data</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">set_b_factor_data</span><span class="p">(</span><span class="n">values</span><span class="p">:</span> <span class="n"><span title="collections.abc.Iterable">Iterable</span></span><span class="p">[</span><span class="n">float</span><span class="p">])</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Set the b-factor entry for every Residue to a value from an array-like</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>values</code></b>
            (<code><span title="collections.abc.Iterable">Iterable</span>[float]</code>)
        
        <div class="doc-md-description">
          <p>Array-like of integer types to set each Residue instance 'b_factor' attribute to</p>
        </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5768</span>
<span class="normal">5769</span>
<span class="normal">5770</span>
<span class="normal">5771</span>
<span class="normal">5772</span>
<span class="normal">5773</span>
<span class="normal">5774</span>
<span class="normal">5775</span>
<span class="normal">5776</span>
<span class="normal">5777</span>
<span class="normal">5778</span>
<span class="normal">5779</span>
<span class="normal">5780</span>
<span class="normal">5781</span>
<span class="normal">5782</span>
<span class="normal">5783</span>
<span class="normal">5784</span>
<span class="normal">5785</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_b_factor_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">float</span><span class="p">]):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Set the b-factor entry for every Residue to a value from an array-like</span>

<span class="sd">    Args:</span>
<span class="sd">        values: Array-like of integer types to set each Residue instance &#39;b_factor&#39; attribute to</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
        <span class="n">values</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_residues</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Can&#39;t provide a array-like of values with length </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span><span class="si">}</span><span class="s2"> != </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_residues</span><span class="si">}</span><span class="s2">, the &quot;</span>
                <span class="s2">&quot;number of residues&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">residue</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">residues</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
            <span class="n">residue</span><span class="o">.</span><span class="n">b_factor</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The type &#39;</span><span class="si">{</span><span class="n">values</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; isn&#39;t an Iterable. To </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">set_b_factor_data</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">, you &quot;</span>
            <span class="s2">&quot;must provide the &#39;values&#39; as an Iterable of integer type with length = number_of_residues&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>


</div>

<div class="doc doc-object doc-class">



<h2 id="structure.base.Structures" class="doc doc-heading">
          <span class="doc doc-object-name doc-class-name">Structures</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">Structures</span><span class="p">(</span><span class="n">structures</span><span class="p">:</span> <span class="n"><span title="collections.abc.Iterable">Iterable</span></span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.ContainsResidues" href="#structure.base.ContainsResidues">ContainsResidues</a></span><span class="p">],</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="structure.base.ContainsResidues" href="#structure.base.ContainsResidues">ContainsResidues</a></code>, <code><span title="collections.UserList">UserList</span></code></p>

  
      <p>A view of a set of Structure instances. This isn't used at the moment</p>
  



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>structures</code></b>
            (<code><span title="collections.abc.Iterable">Iterable</span>[<a class="autorefs autorefs-internal" title="structure.base.ContainsResidues" href="#structure.base.ContainsResidues">ContainsResidues</a>]</code>)
        
        <div class="doc-md-description">
          <p>The Iterable of Structure to set the Structures with</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>dtype</code></b>
            (<code>str</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>If an empty Structures, the specific subclass of Structure that Structures contains</p>
        </div>
      </li>
  </ul>

                <details class="quote">
                  <summary>Source code in <code>symdesign/structure/base.py</code></summary>
                  <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">5808</span>
<span class="normal">5809</span>
<span class="normal">5810</span>
<span class="normal">5811</span>
<span class="normal">5812</span>
<span class="normal">5813</span>
<span class="normal">5814</span>
<span class="normal">5815</span>
<span class="normal">5816</span>
<span class="normal">5817</span>
<span class="normal">5818</span>
<span class="normal">5819</span>
<span class="normal">5820</span>
<span class="normal">5821</span>
<span class="normal">5822</span>
<span class="normal">5823</span>
<span class="normal">5824</span>
<span class="normal">5825</span>
<span class="normal">5826</span>
<span class="normal">5827</span>
<span class="normal">5828</span>
<span class="normal">5829</span>
<span class="normal">5830</span>
<span class="normal">5831</span>
<span class="normal">5832</span>
<span class="normal">5833</span>
<span class="normal">5834</span>
<span class="normal">5835</span>
<span class="normal">5836</span>
<span class="normal">5837</span>
<span class="normal">5838</span>
<span class="normal">5839</span>
<span class="normal">5840</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">structures</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="n">ContainsResidues</span><span class="p">],</span> <span class="n">dtype</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Pass the parent Structure with parent= to initialize .log, .coords, .atoms, and .residues</span>

<span class="sd">    Args:</span>
<span class="sd">        structures: The Iterable of Structure to set the Structures with</span>
<span class="sd">        dtype: If an empty Structures, the specific subclass of Structure that Structures contains</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">initlist</span><span class="o">=</span><span class="n">structures</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># initlist sets UserList.data to Iterable[Structure]</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;This class isn&#39;t functional yet&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_parent</span><span class="p">():</span>
        <span class="k">raise</span> <span class="n">stutils</span><span class="o">.</span><span class="n">ConstructionError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Couldn&#39;t create </span><span class="si">{</span><span class="n">Structures</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> without passing &#39;parent&#39; argument&quot;</span>
        <span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>  <span class="c1"># Set up an empty Structures</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span> <span class="k">if</span> <span class="n">dtype</span> <span class="k">else</span> <span class="s1">&#39;Structure&#39;</span>
    <span class="k">elif</span> <span class="nb">all</span><span class="p">([</span><span class="kc">True</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">structure</span><span class="p">,</span> <span class="n">ContainsResidues</span><span class="p">)</span> <span class="k">else</span> <span class="kc">False</span> <span class="k">for</span> <span class="n">structure</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">]):</span>
        <span class="c1"># self.data = [structure for structure in structures]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_atom_indices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">structure</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_atom_indices</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">atom_indices</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_residue_indices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">structure</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_residue_indices</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">structure</span><span class="o">.</span><span class="n">residue_indices</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">dtype</span> <span class="k">if</span> <span class="n">dtype</span> <span class="k">else</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="vm">__name__</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Can&#39;t set </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> by passing &#39;</span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">structure</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">structure</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="bp">self</span><span class="p">)</span><span class="si">}</span><span class="s2">, &quot;</span>
            <span class="sa">f</span><span class="s1">&#39;must set with type [Structure, ...] or an empty constructor. Ex: Structures()&#39;</span><span class="p">)</span>

    <span class="c1"># Overwrite attributes in Structure</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">dtype</span><span class="si">}</span><span class="s1">Selection&#39;</span>
</code></pre></div></td></tr></table></div>
                </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Structures.dtype" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">dtype</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-instance-attribute"><code>instance-attribute</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">dtype</span><span class="p">:</span> <span class="n">str</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>The type of Structure in instance</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h3 id="structure.base.Structures.structures" class="doc doc-heading">
          <span class="doc doc-object-name doc-attribute-name">structures</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">structures</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n"><a class="autorefs autorefs-internal" title="structure.base.ContainsResidues" href="#structure.base.ContainsResidues">ContainsResidues</a></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns the underlying data in Structures</p>
  </div>

</div>





  </div>

  </div>


</div>



<div class="doc doc-object doc-function">



<h2 id="structure.base.parse_seqres" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">parse_seqres</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">parse_seqres</span><span class="p">(</span><span class="n">seqres_lines</span><span class="p">:</span> <span class="n">list</span><span class="p">[</span><span class="n">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n">str</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Convert SEQRES information to single amino acid dictionary format</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>seqres_lines</code></b>
            (<code>list[str]</code>)
        
        <div class="doc-md-description">
          <p>The list of lines containing SEQRES information</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>dict[str, str]</code>
        
        <div class="doc-md-description">
          <p>The mapping of each chain to its reference sequence</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">parse_seqres</span><span class="p">(</span><span class="n">seqres_lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>  <span class="c1"># list[str]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Convert SEQRES information to single amino acid dictionary format</span>

<span class="sd">    Args:</span>
<span class="sd">        seqres_lines: The list of lines containing SEQRES information</span>

<span class="sd">    Returns:</span>
<span class="sd">        The mapping of each chain to its reference sequence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># SEQRES   1 A  182  THR THR ALA SER THR SER GLN VAL ARG GLN ASN TYR HIS</span>
    <span class="c1"># SEQRES   2 A  182  GLN ASP SER GLU ALA ALA ILE ASN ARG GLN ILE ASN LEU</span>
    <span class="c1"># SEQRES   3 A  182  GLU LEU TYR ALA SER TYR VAL TYR LEU SER MET SER TYR</span>
    <span class="c1"># SEQRES ...</span>
    <span class="c1"># SEQRES  16 C  201  SER TYR ILE ALA GLN GLU</span>
    <span class="c1"># In order to account for MultiModel files where the chain names are all the same, using the parsed order</span>
    <span class="c1"># instead of a dictionary as later entries would overwrite earlier ones making them inaccurate</span>
    <span class="c1"># If the file is screwed up in that it has chains in a different order than the seqres, then this wouldn&#39;t work</span>
    <span class="c1"># I am opting for the standard .pdb file format and if it is messed up this is the users problem</span>
    <span class="n">reference_sequence</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">seqres_lines</span><span class="p">:</span>
        <span class="n">chain</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="o">*</span><span class="n">sequence</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">chain</span> <span class="ow">in</span> <span class="n">reference_sequence</span><span class="p">:</span>
            <span class="n">reference_sequence</span><span class="p">[</span><span class="n">chain</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">sequence</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">reference_sequence</span><span class="p">[</span><span class="n">chain</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">sequence</span><span class="p">)</span>

    <span class="c1"># Format the sequences as a one AA letter list</span>
    <span class="n">reference_sequences</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># []</span>
    <span class="k">for</span> <span class="n">chain</span><span class="p">,</span> <span class="n">sequence</span> <span class="ow">in</span> <span class="n">reference_sequence</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Ensure we parse selenomethionine correctly</span>
        <span class="n">one_letter_sequence</span> <span class="o">=</span> <span class="p">[</span><span class="n">protein_letters_3to1_extended_mse</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">aa</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
                               <span class="k">for</span> <span class="n">aa</span> <span class="ow">in</span> <span class="n">sequence</span><span class="p">]</span>
        <span class="n">reference_sequences</span><span class="p">[</span><span class="n">chain</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">one_letter_sequence</span><span class="p">)</span>
        <span class="c1"># reference_sequences.append(&#39;&#39;.join(one_letter_sequence))</span>

    <span class="k">return</span> <span class="n">reference_sequences</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="structure.base.read_pdb_file" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">read_pdb_file</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">read_pdb_file</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="n"><span title="typing.AnyStr">AnyStr</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">pdb_lines</span><span class="p">:</span> <span class="n"><span title="collections.abc.Iterable">Iterable</span></span><span class="p">[</span><span class="n">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">separate_coords</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Reads .pdb file and returns structural information pertaining to parsed file</p>
<p>By default, returns the coordinates as a separate numpy.ndarray which is parsed directly by StructureBase. This will
be associated with each Atom however, separate parsing is done for efficiency. To include coordinate info with the
individual Atom instances, pass separate_coords=False. (Not recommended)</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>file</code></b>
            (<code><span title="typing.AnyStr">AnyStr</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The path to the file to parse</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>pdb_lines</code></b>
            (<code><span title="collections.abc.Iterable">Iterable</span>[str]</code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>If lines are already read, provide the lines instead</p>
        </div>
      </li>
      <li class="field-body">
        <b><code>separate_coords</code></b>
            (<code>bool</code>, default:
                <code>True</code>
)
        
        <div class="doc-md-description">
          <p>Whether to separate parsed coordinates from Atom instances. Will be returned as two separate
entries in the parsed dictionary, otherwise returned with coords=None</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>dict[str, <span title="typing.Any">Any</span>]</code>
        
        <div class="doc-md-description">
          <p>The dictionary containing all the parsed structural information</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_pdb_file</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="n">AnyStr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">pdb_lines</span><span class="p">:</span> <span class="n">Iterable</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">separate_coords</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> \
        <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reads .pdb file and returns structural information pertaining to parsed file</span>

<span class="sd">    By default, returns the coordinates as a separate numpy.ndarray which is parsed directly by StructureBase. This will</span>
<span class="sd">    be associated with each Atom however, separate parsing is done for efficiency. To include coordinate info with the</span>
<span class="sd">    individual Atom instances, pass separate_coords=False. (Not recommended)</span>

<span class="sd">    Args:</span>
<span class="sd">        file: The path to the file to parse</span>
<span class="sd">        pdb_lines: If lines are already read, provide the lines instead</span>
<span class="sd">        separate_coords: Whether to separate parsed coordinates from Atom instances. Will be returned as two separate</span>
<span class="sd">            entries in the parsed dictionary, otherwise returned with coords=None</span>

<span class="sd">    Returns:</span>
<span class="sd">        The dictionary containing all the parsed structural information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">pdb_lines</span><span class="p">:</span>
        <span class="c1"># path, extension = None, None</span>
        <span class="n">assembly</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">elif</span> <span class="n">file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="n">pdb_lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
        <span class="n">path</span><span class="p">,</span> <span class="n">extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">extension</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="c1"># If last character is not a letter, then the file is an assembly, or the extension was provided weird</span>
            <span class="n">assembly</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">extension</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">keep_digit_table</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">assembly</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">read_pdb_file</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: Must provide the argument &#39;file&#39; or &#39;pdb_lines&#39;&quot;</span><span class="p">)</span>

    <span class="c1"># type to info index:   1    2    3    4    5    6    7     11     12   13   14</span>
    <span class="c1"># eventual type:      int, str, str, str, str, int, str, float, float, str, str]] = []</span>
    <span class="n">temp_info</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1"># type to info index:   1    2    3    4    5    6    7 8,9,10     11     12   13   14</span>
    <span class="c1"># fields w/ coords   [int, str, str, str, str, int, str, float, float, float, str, str]</span>
    <span class="n">coords</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">cryst_record</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">dbref</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">entity_info</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span> <span class="o">|</span> <span class="nb">list</span> <span class="o">|</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">header</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">resolution</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">seq_res_lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">biomt</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">entity</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">current_operation</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="n">alt_loc_str</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span>
    <span class="c1"># for line_tokens in map(str.split, pdb_lines):</span>
    <span class="c1">#     # 0       1       2          3             4             5      6               7                   8  9</span>
    <span class="c1">#     # remark, number, atom_type, alt_location, residue_type, chain, residue_number, code_for_insertion, x, y,</span>
    <span class="c1">#     #     10 11   12         13       14</span>
    <span class="c1">#     #     z, occ, temp_fact, element, charge = \</span>
    <span class="c1">#     #     line[6:11].strip(), int(line[6:11]), line[12:16].strip(), line[16:17].strip(), line[17:20].strip(),</span>
    <span class="c1">#     #     line[21:22], int(line[22:26]), line[26:27].strip(), float(line[30:38]), float(line[38:46]), \</span>
    <span class="c1">#     #     float(line[46:54]), float(line[54:60]), float(line[60:66]), line[76:78].strip(), line[78:80].strip()</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">pdb_lines</span><span class="p">:</span>
        <span class="n">remark</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">slice_remark</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">remark</span> <span class="o">==</span> <span class="s1">&#39;ATOM  &#39;</span> <span class="ow">or</span> <span class="n">line</span><span class="p">[</span><span class="n">slice_residue_type</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;MSE&#39;</span> <span class="ow">and</span> <span class="n">remark</span> <span class="o">==</span> <span class="s1">&#39;HETATM&#39;</span><span class="p">:</span>
            <span class="c1"># if remove_alt_location and alt_location not in [&#39;&#39;, &#39;A&#39;]:</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="n">slice_alt_location</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="n">alt_loc_str</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">]:</span>
                <span class="k">continue</span>
            <span class="c1"># number = int(line[slice_number])</span>
            <span class="n">residue_type</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">slice_residue_type</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">residue_type</span> <span class="o">==</span> <span class="s1">&#39;MSE&#39;</span><span class="p">:</span>
                <span class="n">residue_type</span> <span class="o">=</span> <span class="s1">&#39;MET&#39;</span>
                <span class="n">atom_type</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">slice_atom_type</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">atom_type</span> <span class="o">==</span> <span class="s1">&#39;SE&#39;</span><span class="p">:</span>
                    <span class="n">atom_type</span> <span class="o">=</span> <span class="s1">&#39;SD&#39;</span>  <span class="c1"># change type from Selenium to Sulfur delta</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">atom_type</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">slice_atom_type</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="c1"># prepare line information for population of Atom objects</span>
            <span class="n">temp_info</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">line</span><span class="p">[</span><span class="n">slice_number</span><span class="p">],</span> <span class="n">atom_type</span><span class="p">,</span> <span class="n">alt_loc_str</span><span class="p">,</span> <span class="n">residue_type</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="n">slice_chain</span><span class="p">],</span>
                              <span class="n">line</span><span class="p">[</span><span class="n">slice_residue_number</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="n">slice_code_for_insertion</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span>
                              <span class="n">line</span><span class="p">[</span><span class="n">slice_occ</span><span class="p">],</span> <span class="n">line</span><span class="p">[</span><span class="n">slice_temp_fact</span><span class="p">],</span>
                              <span class="n">line</span><span class="p">[</span><span class="n">slice_element</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">line</span><span class="p">[</span><span class="n">slice_charge</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()))</span>
            <span class="c1"># temp_info.append((int(line[slice_number]), atom_type, alt_loc_str, residue_type, line[slice_chain],</span>
            <span class="c1">#                   int(line[slice_residue_number]), line[slice_code_for_insertion].strip(),</span>
            <span class="c1">#                   float(line[slice_occ]), float(line[slice_temp_fact]),</span>
            <span class="c1">#                   line[slice_element].strip(), line[slice_charge].strip()))</span>
            <span class="c1"># Prepare the atomic coordinates for addition to numpy array</span>
            <span class="n">coords</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">slice_x</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">slice_y</span><span class="p">]),</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="n">slice_z</span><span class="p">])])</span>
        <span class="k">elif</span> <span class="n">remark</span> <span class="o">==</span> <span class="s1">&#39;SEQRES&#39;</span><span class="p">:</span>
            <span class="n">seq_res_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">11</span><span class="p">:])</span>
        <span class="k">elif</span> <span class="n">remark</span> <span class="o">==</span> <span class="s1">&#39;REMARK&#39;</span><span class="p">:</span>
            <span class="n">header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="n">remark_number</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">slice_number</span><span class="p">]</span>
            <span class="c1"># elif line[:18] == &#39;REMARK 350   BIOMT&#39;:</span>
            <span class="k">if</span> <span class="n">remark_number</span> <span class="o">==</span> <span class="s1">&#39; 350 &#39;</span><span class="p">:</span>  <span class="c1"># 6:11  &#39;   BIOMT&#39;</span>
                <span class="c1"># integration of the REMARK 350 BIOMT</span>
                <span class="c1"># REMARK 350</span>
                <span class="c1"># REMARK 350 BIOMOLECULE: 1</span>
                <span class="c1"># REMARK 350 AUTHOR DETERMINED BIOLOGICAL UNIT: TRIMERIC</span>
                <span class="c1"># REMARK 350 SOFTWARE DETERMINED QUATERNARY STRUCTURE: TRIMERIC</span>
                <span class="c1"># REMARK 350 SOFTWARE USED: PISA</span>
                <span class="c1"># REMARK 350 TOTAL BURIED SURFACE AREA: 6220 ANGSTROM**2</span>
                <span class="c1"># REMARK 350 SURFACE AREA OF THE COMPLEX: 28790 ANGSTROM**2</span>
                <span class="c1"># REMARK 350 CHANGE IN SOLVENT FREE ENERGY: -42.0 KCAL/MOL</span>
                <span class="c1"># REMARK 350 APPLY THE FOLLOWING TO CHAINS: A, B, C</span>
                <span class="c1"># REMARK 350   BIOMT1   1  1.000000  0.000000  0.000000        0.00000</span>
                <span class="c1"># REMARK 350   BIOMT2   1  0.000000  1.000000  0.000000        0.00000</span>
                <span class="c1"># REMARK 350   BIOMT3   1  0.000000  0.000000  1.000000        0.00000</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">biomt_indicator</span><span class="p">,</span> <span class="n">operation_number</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">tx</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
                <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>  <span class="c1"># Not enough values to unpack</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">biomt_indicator</span> <span class="o">==</span> <span class="s1">&#39;BIOMT&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">operation_number</span> <span class="o">!=</span> <span class="n">current_operation</span><span class="p">:</span>  <span class="c1"># Reached a new transformation matrix</span>
                        <span class="n">current_operation</span> <span class="o">=</span> <span class="n">operation_number</span>
                        <span class="n">biomt</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
                    <span class="c1"># Add the transformation to the current matrix</span>
                    <span class="n">biomt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">tx</span><span class="p">))))</span>
            <span class="k">elif</span> <span class="n">remark_number</span> <span class="o">==</span> <span class="s1">&#39;   2 &#39;</span><span class="p">:</span>  <span class="c1"># 6:11 &#39; RESOLUTION&#39;</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">resolution</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">line</span><span class="p">[</span><span class="mi">22</span><span class="p">:</span><span class="mi">30</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">IndexError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>
                    <span class="n">resolution</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="s1">&#39;DBREF&#39;</span> <span class="ow">in</span> <span class="n">remark</span><span class="p">:</span>
            <span class="n">header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="n">chain</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">12</span><span class="p">:</span><span class="mi">14</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span>
                <span class="n">db_accession_id</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">18</span><span class="p">:</span><span class="mi">40</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">db</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">26</span><span class="p">:</span><span class="mi">33</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">line</span><span class="p">[</span><span class="mi">5</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>  <span class="c1"># skip grabbing db_accession_id until DBREF2</span>
                    <span class="k">continue</span>
                <span class="n">db_accession_id</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="mi">33</span><span class="p">:</span><span class="mi">42</span><span class="p">]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
            <span class="n">dbref</span><span class="p">[</span><span class="n">chain</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="n">db</span><span class="p">,</span> <span class="s1">&#39;accession&#39;</span><span class="p">:</span> <span class="n">db_accession_id</span><span class="p">}</span>  <span class="c1"># implies each chain has only one id</span>
        <span class="k">elif</span> <span class="n">remark</span> <span class="o">==</span> <span class="s1">&#39;COMPND&#39;</span> <span class="ow">and</span> <span class="s1">&#39;MOL_ID&#39;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
            <span class="n">header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="n">entity</span> <span class="o">=</span> <span class="n">line</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:</span> <span class="n">line</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">remark</span> <span class="o">==</span> <span class="s1">&#39;COMPND&#39;</span> <span class="ow">and</span> <span class="s1">&#39;CHAIN&#39;</span> <span class="ow">in</span> <span class="n">line</span> <span class="ow">and</span> <span class="n">entity</span><span class="p">:</span>  <span class="c1"># retrieve from standard .pdb file notation</span>
            <span class="n">header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="c1"># entity number (starting from 1) = {&#39;chains&#39; : {A, B, C}}</span>
            <span class="n">entity_info</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">entity</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> \
                <span class="p">{</span><span class="s1">&#39;chains&#39;</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">strip</span><span class="p">,</span> <span class="n">line</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:]</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)))}</span>
            <span class="n">entity</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">elif</span> <span class="n">remark</span> <span class="o">==</span> <span class="s1">&#39;SCALE &#39;</span><span class="p">:</span>
            <span class="n">header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">elif</span> <span class="n">remark</span> <span class="o">==</span> <span class="s1">&#39;CRYST1&#39;</span><span class="p">:</span>
            <span class="n">header</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
            <span class="n">cryst_record</span> <span class="o">=</span> <span class="n">line</span>  <span class="c1"># Don&#39;t .strip() so &#39;\n&#39; is attached for output</span>
            <span class="c1"># uc_dimensions, space_group = parse_cryst_record(cryst_record)</span>
            <span class="c1"># cryst = {&#39;space&#39;: space_group, &#39;a_b_c&#39;: tuple(uc_dimensions[:3]), &#39;ang_a_b_c&#39;: tuple(uc_dimensions[3:])}</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">temp_info</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">file</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;The file </span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1"> has no ATOM records&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The provided &#39;pdb_lines&#39; have no ATOM records&quot;</span><span class="p">)</span>

    <span class="c1"># Combine entity_info with the reference_sequence info and dbref info</span>
    <span class="k">if</span> <span class="n">seq_res_lines</span><span class="p">:</span>
        <span class="n">reference_sequence</span> <span class="o">=</span> <span class="n">parse_seqres</span><span class="p">(</span><span class="n">seq_res_lines</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">reference_sequence</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">for</span> <span class="n">entity_name</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="n">entity_info</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="c1"># Grab the first chain from the identified chains, and use it to grab the reference sequence</span>
        <span class="n">chain</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="s1">&#39;chains&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;reference_sequence&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reference_sequence</span><span class="p">[</span><span class="n">chain</span><span class="p">]</span>  <span class="c1"># Used when parse_seqres returns dict[str, str]</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>  <span class="c1"># This is None</span>
            <span class="k">pass</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">info</span><span class="p">[</span><span class="s1">&#39;dbref&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">dbref</span><span class="p">[</span><span class="n">chain</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>  <span class="c1"># Keys are missing</span>
            <span class="k">pass</span>

    <span class="c1"># # Convert the incrementing reference sequence to a list of the sequences</span>
    <span class="c1"># reference_sequence = list(reference_sequence.values())</span>

    <span class="k">if</span> <span class="n">biomt</span><span class="p">:</span>
        <span class="n">biomt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">biomt</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="n">rotation_matrices</span> <span class="o">=</span> <span class="n">biomt</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">translation_matrices</span> <span class="o">=</span> <span class="n">biomt</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">:]</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rotation_matrices</span> <span class="o">=</span> <span class="n">translation_matrices</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">parsed_info</span> <span class="o">=</span> \
        <span class="nb">dict</span><span class="p">(</span><span class="n">atoms</span><span class="o">=</span><span class="p">[</span><span class="n">Atom</span><span class="o">.</span><span class="n">without_coordinates</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="o">*</span><span class="n">info</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">temp_info</span><span class="p">)]</span>
             <span class="k">if</span> <span class="n">separate_coords</span> <span class="k">else</span>
             <span class="c1"># Initialize with individual coords. Not sure why anyone would do this, but include for compatibility</span>
             <span class="p">[</span><span class="n">Atom</span><span class="p">(</span><span class="n">number</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">number</span><span class="p">),</span> <span class="n">atom_type</span><span class="o">=</span><span class="n">atom_type</span><span class="p">,</span> <span class="n">alt_location</span><span class="o">=</span><span class="n">alt_location</span><span class="p">,</span> <span class="n">residue_type</span><span class="o">=</span><span class="n">residue_type</span><span class="p">,</span>
                   <span class="n">chain_id</span><span class="o">=</span><span class="n">chain_id</span><span class="p">,</span> <span class="n">residue_number</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">residue_number</span><span class="p">),</span> <span class="n">code_for_insertion</span><span class="o">=</span><span class="n">code_for_insertion</span><span class="p">,</span>
                   <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">[</span><span class="n">idx</span><span class="p">],</span> <span class="n">occupancy</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">occupancy</span><span class="p">),</span> <span class="n">b_factor</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">b_factor</span><span class="p">),</span> <span class="n">element</span><span class="o">=</span><span class="n">element</span><span class="p">,</span>
                   <span class="n">charge</span><span class="o">=</span><span class="n">charge</span><span class="p">)</span>
              <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="p">(</span><span class="n">number</span><span class="p">,</span> <span class="n">atom_type</span><span class="p">,</span> <span class="n">alt_location</span><span class="p">,</span> <span class="n">residue_type</span><span class="p">,</span> <span class="n">chain_id</span><span class="p">,</span> <span class="n">residue_number</span><span class="p">,</span> <span class="n">code_for_insertion</span><span class="p">,</span>
                        <span class="n">occupancy</span><span class="p">,</span> <span class="n">b_factor</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">charge</span><span class="p">)</span>
              <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">temp_info</span><span class="p">)],</span>
             <span class="n">biological_assembly</span><span class="o">=</span><span class="n">assembly</span><span class="p">,</span>
             <span class="n">rotation_matrices</span><span class="o">=</span><span class="n">rotation_matrices</span><span class="p">,</span>
             <span class="n">translation_matrices</span><span class="o">=</span><span class="n">translation_matrices</span><span class="p">,</span>
             <span class="n">coords</span><span class="o">=</span><span class="n">coords</span> <span class="k">if</span> <span class="n">separate_coords</span> <span class="k">else</span> <span class="kc">None</span><span class="p">,</span>
             <span class="n">cryst_record</span><span class="o">=</span><span class="n">cryst_record</span><span class="p">,</span>
             <span class="n">entity_info</span><span class="o">=</span><span class="n">entity_info</span><span class="p">,</span>
             <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
             <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">,</span>
             <span class="n">reference_sequence</span><span class="o">=</span><span class="n">reference_sequence</span><span class="p">,</span>
             <span class="p">)</span>
    <span class="c1"># Explicitly overwrite any parsing if argument was passed to caller</span>
    <span class="n">parsed_info</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parsed_info</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="structure.base.read_mmcif_file" class="doc doc-heading">
          <span class="doc doc-object-name doc-function-name">read_mmcif_file</span>


</h2>
<div class="doc-signature highlight"><pre><span></span><code><span class="n">read_mmcif_file</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="n"><span title="typing.AnyStr">AnyStr</span></span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">dict</span><span class="p">[</span><span class="n">str</span><span class="p">,</span> <span class="n"><span title="typing.Any">Any</span></span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Reads .cif file and returns structural information pertaining to parsed file</p>
<p>By default, returns the coordinates as a separate numpy.ndarray which is parsed directly by StructureBase. This will
be associated with each Atom however, separate parsing is done for efficiency. To include coordinate info with the
individual Atom instances, pass separate_coords=False. (Not recommended)</p>



  <p>Parameters:</p>
  <ul>
      <li class="field-body">
        <b><code>file</code></b>
            (<code><span title="typing.AnyStr">AnyStr</span></code>, default:
                <code>None</code>
)
        
        <div class="doc-md-description">
          <p>The path to the file to parse</p>
        </div>
      </li>
  </ul>



  <p>Returns:</p>
  <ul>
      <li class="field-body">
            <code>dict[str, <span title="typing.Any">Any</span>]</code>
        
        <div class="doc-md-description">
          <p>The dictionary containing all the parsed structural information</p>
      </div>
      </li>
  </ul>

          <details class="quote">
            <summary>Source code in <code>symdesign/structure/base.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">read_mmcif_file</span><span class="p">(</span><span class="n">file</span><span class="p">:</span> <span class="n">AnyStr</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reads .cif file and returns structural information pertaining to parsed file</span>

<span class="sd">    By default, returns the coordinates as a separate numpy.ndarray which is parsed directly by StructureBase. This will</span>
<span class="sd">    be associated with each Atom however, separate parsing is done for efficiency. To include coordinate info with the</span>
<span class="sd">    individual Atom instances, pass separate_coords=False. (Not recommended)</span>

<span class="sd">    Args:</span>
<span class="sd">        file: The path to the file to parse</span>

<span class="sd">    Returns:</span>
<span class="sd">        The dictionary containing all the parsed structural information</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># if lines:</span>
    <span class="c1">#     # path, extension = None, None</span>
    <span class="c1">#     assembly: str | None = None</span>
    <span class="c1">#     name = None</span>
    <span class="c1"># el</span>
    <span class="k">if</span> <span class="n">file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">path</span><span class="p">,</span> <span class="n">extension</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="n">ignore_fields</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span> <span class="o">=</span> <span class="n">cif_reader</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="n">ignore</span><span class="o">=</span><span class="n">ignore_fields</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">extension</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">isdigit</span><span class="p">():</span>
            <span class="c1"># If last character is not a letter, then the file is an assembly, or the extension was provided weird</span>
            <span class="n">assembly</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="n">extension</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">keep_digit_table</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s1">&#39;assembly&#39;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">assembly</span> <span class="o">=</span> <span class="n">name</span><span class="p">[</span><span class="n">name</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;assembly&#39;</span><span class="p">):]</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">utils</span><span class="o">.</span><span class="n">keep_digit_table</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">assembly</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">read_mmcif_file</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">: Must provide the argument &#39;file&#39;&quot;</span>
        <span class="p">)</span>

    <span class="c1">#  name = kwargs.pop(&#39;name&#39;, None)</span>
    <span class="c1">#  if not name:</span>
    <span class="c1">#      name = os.path.basename(os.path.splitext(file)[0])</span>
    <span class="c1">#</span>
    <span class="c1">#  input(data.keys())</span>
    <span class="c1">#  for k, v_ in data.items():</span>
    <span class="c1">#      # input(f&#39;{list(v_.keys())}&#39;)</span>
    <span class="c1">#      # [&#39;_entry&#39;, &#39;_audit_conform&#39;, &#39;_database_2&#39;, &#39;_pdbx_database_PDB_obs_spr&#39;, &#39;_pdbx_database_related&#39;,</span>
    <span class="c1">#      #  &#39;_pdbx_database_status&#39;, &#39;_audit_author&#39;, &#39;_citation&#39;, &#39;_citation_author&#39;, &#39;_cell&#39;, &#39;_symmetry&#39;,</span>
    <span class="c1">#      #  &#39;_entity&#39;, &#39;_entity_poly&#39;, &#39;_entity_poly_seq&#39;, &#39;_entity_src_gen&#39;, &#39;_struct_ref&#39;, &#39;_struct_ref_seq&#39;,</span>
    <span class="c1">#      #  &#39;_struct_ref_seq_dif&#39;, &#39;_chem_comp&#39;, &#39;_exptl&#39;, &#39;_exptl_crystal&#39;, &#39;_exptl_crystal_grow&#39;, &#39;_diffrn&#39;,</span>
    <span class="c1">#      #  &#39;_diffrn_detector&#39;, &#39;_diffrn_radiation&#39;, &#39;_diffrn_radiation_wavelength&#39;, &#39;_diffrn_source&#39;, &#39;_reflns&#39;,</span>
    <span class="c1">#      #  &#39;_reflns_shell&#39;, &#39;_refine&#39;, &#39;_refine_hist&#39;, &#39;_refine_ls_restr&#39;, &#39;_refine_ls_shell&#39;, &#39;_pdbx_refine&#39;,</span>
    <span class="c1">#      #  &#39;_struct&#39;, &#39;_struct_keywords&#39;, &#39;_struct_asym&#39;, &#39;_struct_biol&#39;, &#39;_struct_conf&#39;, &#39;_struct_conf_type&#39;,</span>
    <span class="c1">#      #  &#39;_struct_mon_prot_cis&#39;, &#39;_struct_sheet&#39;, &#39;_struct_sheet_order&#39;, &#39;_struct_sheet_range&#39;,</span>
    <span class="c1">#      #  &#39;_pdbx_struct_sheet_hbond&#39;, &#39;_atom_sites&#39;, &#39;_atom_type&#39;, &#39;_atom_site&#39;, &#39;_atom_site_anisotrop&#39;,</span>
    <span class="c1">#      #  &#39;_pdbx_poly_seq_scheme&#39;, &#39;_pdbx_struct_assembly&#39;, &#39;_pdbx_struct_assembly_gen&#39;,</span>
    <span class="c1">#      #  &#39;_pdbx_struct_assembly_prop&#39;, &#39;_pdbx_struct_oper_list&#39;, &#39;_pdbx_audit_revision_history&#39;,</span>
    <span class="c1">#      #  &#39;_pdbx_audit_revision_details&#39;, &#39;_pdbx_audit_revision_group&#39;, &#39;_pdbx_refine_tls&#39;,</span>
    <span class="c1">#      #  &#39;_pdbx_refine_tls_group&#39;, &#39;_pdbx_phasing_MR&#39;, &#39;_phasing&#39;, &#39;_software&#39;, &#39;_pdbx_validate_torsion&#39;,</span>
    <span class="c1">#      #  &#39;_pdbx_unobs_or_zero_occ_atoms&#39;, &#39;_pdbx_unobs_or_zero_occ_residues&#39;, &#39;_space_group_symop&#39;]</span>
    <span class="c1">#      for idx, (k, v) in enumerate(v_.items()):</span>
    <span class="c1">#          # if k == &#39;_atom_sites&#39;:</span>
    <span class="c1">#          #     input(v.keys())</span>
    <span class="c1">#          # if k in [&#39;_database_2&#39;, &#39;_pdbx_database_PDB_obs_spr&#39;, &#39;_pdbx_database_related&#39;, &#39;_pdbx_database_status&#39;]:</span>
    <span class="c1">#          #     print(&#39;Database key&#39;, k)</span>
    <span class="c1">#          #     input(v)</span>
    <span class="c1">#          # if k in [&#39;_entity&#39;, &#39;_entity_poly&#39;, &#39;_entity_poly_seq&#39;, &#39;_struct_ref&#39;]:  # &#39;_entity_src_gen&#39;, &#39;_struct_ref_seq&#39;</span>
    <span class="c1">#          #     print(&#39;Sequence key&#39;, k)</span>
    <span class="c1">#          #     input(v)</span>
    <span class="c1">#          # if k in [&#39;_cell&#39;, &#39;_symmetry&#39;,</span>
    <span class="c1">#          #          # &#39;_space_group_symop&#39;</span>
    <span class="c1">#          #          ]:</span>
    <span class="c1">#          #     print(&#39;Symmetry key&#39;, k)</span>
    <span class="c1">#          #     input(v)</span>
    <span class="c1">#          # if k in [&#39;_reflns&#39;, &#39;_reflns_shell&#39;, &#39;_refine&#39;, &#39;_refine_hist&#39;, &#39;_refine_ls_restr&#39;, &#39;_refine_ls_shell&#39;, &#39;_pdbx_refine&#39;,]:</span>
    <span class="c1">#          #     print(&#39;Diffraction key&#39;, k)</span>
    <span class="c1">#          #     input(v)</span>
    <span class="c1">#          # if k in [</span>
    <span class="c1">#          #     # &#39;_struct&#39;, &#39;_struct_keywords&#39;, &#39;_struct_asym&#39;, &#39;_struct_biol&#39;,</span>
    <span class="c1">#          #     &#39;_pdbx_struct_assembly&#39;, &#39;_pdbx_struct_assembly_gen&#39;,</span>
    <span class="c1">#          #     # &#39;_pdbx_struct_assembly_prop&#39;,</span>
    <span class="c1">#          #     &#39;_pdbx_struct_oper_list&#39;,</span>
    <span class="c1">#          # ]:</span>
    <span class="c1">#          #     print(&#39;struct key&#39;, k)</span>
    <span class="c1">#          #     input(v)</span>
    <span class="c1">#          # if k == &#39;_atom_site&#39;:</span>
    <span class="c1">#          #     &quot;&quot;&quot;</span>
    <span class="c1">#          #     key group_PDB</span>
    <span class="c1">#          #     values [&#39;ATOM&#39;, &#39;ATOM&#39;, &#39;ATOM&#39;, &#39;ATOM&#39;, &#39;ATOM&#39;, &#39;ATOM&#39;, &#39;ATOM&#39;, &#39;ATOM&#39;, &#39;ATOM&#39;, &#39;ATOM&#39;]</span>
    <span class="c1">#          #     key id</span>
    <span class="c1">#          #     values [&#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;4&#39;, &#39;5&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;, &#39;10&#39;]</span>
    <span class="c1">#          #     key type_symbol</span>
    <span class="c1">#          #     values [&#39;N&#39;, &#39;C&#39;, &#39;C&#39;, &#39;O&#39;, &#39;C&#39;, &#39;O&#39;, &#39;N&#39;, &#39;C&#39;, &#39;C&#39;, &#39;O&#39;]</span>
    <span class="c1">#          #     key label_atom_id</span>
    <span class="c1">#          #     values [&#39;N&#39;, &#39;CA&#39;, &#39;C&#39;, &#39;O&#39;, &#39;CB&#39;, &#39;OG&#39;, &#39;N&#39;, &#39;CA&#39;, &#39;C&#39;, &#39;O&#39;]</span>
    <span class="c1">#          #     key label_alt_id</span>
    <span class="c1">#          #     values [&#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;, &#39;.&#39;]</span>
    <span class="c1">#          #     key label_comp_id</span>
    <span class="c1">#          #     values [&#39;SER&#39;, &#39;SER&#39;, &#39;SER&#39;, &#39;SER&#39;, &#39;SER&#39;, &#39;SER&#39;, &#39;VAL&#39;, &#39;VAL&#39;, &#39;VAL&#39;, &#39;VAL&#39;]</span>
    <span class="c1">#          #     key label_asym_id</span>
    <span class="c1">#          #     values [&#39;A&#39;, &#39;A&#39;, &#39;A&#39;, &#39;A&#39;, &#39;A&#39;, &#39;A&#39;, &#39;A&#39;, &#39;A&#39;, &#39;A&#39;, &#39;A&#39;]</span>
    <span class="c1">#          #     key label_entity_id</span>
    <span class="c1">#          #     values [&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;]</span>
    <span class="c1">#          #     key label_seq_id</span>
    <span class="c1">#          #     values [&#39;3&#39;, &#39;3&#39;, &#39;3&#39;, &#39;3&#39;, &#39;3&#39;, &#39;3&#39;, &#39;4&#39;, &#39;4&#39;, &#39;4&#39;, &#39;4&#39;]</span>
    <span class="c1">#          #     key pdbx_PDB_ins_code</span>
    <span class="c1">#          #     values [&#39;?&#39;, &#39;?&#39;, &#39;?&#39;, &#39;?&#39;, &#39;?&#39;, &#39;?&#39;, &#39;?&#39;, &#39;?&#39;, &#39;?&#39;, &#39;?&#39;]</span>
    <span class="c1">#          #     key Cartn_x</span>
    <span class="c1">#          #     values [&#39;25.947&#39;, &#39;25.499&#39;, &#39;24.208&#39;, &#39;23.310&#39;, &#39;26.585&#39;, &#39;27.819&#39;, &#39;24.126&#39;, &#39;22.943&#39;, &#39;22.353&#39;, &#39;23.081&#39;]</span>
    <span class="c1">#          #     key Cartn_y</span>
    <span class="c1">#          #     values [&#39;8.892&#39;, &#39;10.149&#39;, &#39;9.959&#39;, &#39;10.800&#39;, &#39;10.734&#39;, &#39;10.839&#39;, &#39;8.851&#39;, &#39;8.533&#39;, &#39;7.200&#39;, &#39;6.224&#39;]</span>
    <span class="c1">#          #     key Cartn_z</span>
    <span class="c1">#          #     values [&#39;43.416&#39;, &#39;42.828&#39;, &#39;42.038&#39;, &#39;42.084&#39;, &#39;41.925&#39;, &#39;42.615&#39;, &#39;41.310&#39;, &#39;40.519&#39;, &#39;40.967&#39;, &#39;41.152&#39;]</span>
    <span class="c1">#          #     key occupancy</span>
    <span class="c1">#          #     values [&#39;1.00&#39;, &#39;1.00&#39;, &#39;1.00&#39;, &#39;1.00&#39;, &#39;1.00&#39;, &#39;1.00&#39;, &#39;1.00&#39;, &#39;1.00&#39;, &#39;1.00&#39;, &#39;1.00&#39;]</span>
    <span class="c1">#          #     key B_iso_or_equiv</span>
    <span class="c1">#          #     values [&#39;67.99&#39;, &#39;79.33&#39;, &#39;61.67&#39;, &#39;60.15&#39;, &#39;81.39&#39;, &#39;86.58&#39;, &#39;62.97&#39;, &#39;56.54&#39;, &#39;56.17&#39;, &#39;85.78&#39;]</span>
    <span class="c1">#          #     key pdbx_formal_charge</span>
    <span class="c1">#          #     values [&#39;?&#39;, &#39;?&#39;, &#39;?&#39;, &#39;?&#39;, &#39;?&#39;, &#39;?&#39;, &#39;?&#39;, &#39;?&#39;, &#39;?&#39;, &#39;?&#39;]</span>
    <span class="c1">#          #     key auth_seq_id</span>
    <span class="c1">#          #     values [&#39;3&#39;, &#39;3&#39;, &#39;3&#39;, &#39;3&#39;, &#39;3&#39;, &#39;3&#39;, &#39;4&#39;, &#39;4&#39;, &#39;4&#39;, &#39;4&#39;]</span>
    <span class="c1">#          #     key auth_comp_id</span>
    <span class="c1">#          #     values [&#39;SER&#39;, &#39;SER&#39;, &#39;SER&#39;, &#39;SER&#39;, &#39;SER&#39;, &#39;SER&#39;, &#39;VAL&#39;, &#39;VAL&#39;, &#39;VAL&#39;, &#39;VAL&#39;]</span>
    <span class="c1">#          #     key auth_asym_id</span>
    <span class="c1">#          #     values [&#39;A&#39;, &#39;A&#39;, &#39;A&#39;, &#39;A&#39;, &#39;A&#39;, &#39;A&#39;, &#39;A&#39;, &#39;A&#39;, &#39;A&#39;, &#39;A&#39;]</span>
    <span class="c1">#          #     key auth_atom_id</span>
    <span class="c1">#          #     values [&#39;N&#39;, &#39;CA&#39;, &#39;C&#39;, &#39;O&#39;, &#39;CB&#39;, &#39;OG&#39;, &#39;N&#39;, &#39;CA&#39;, &#39;C&#39;, &#39;O&#39;]</span>
    <span class="c1">#          #     key pdbx_PDB_model_num</span>
    <span class="c1">#          #     values [&#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;, &#39;1&#39;]</span>
    <span class="c1">#          #     &quot;&quot;&quot;</span>
    <span class="c1">#          #     for k__, v__ in v.items():</span>
    <span class="c1">#          #         # [&#39;group_PDB&#39;, &#39;id&#39;, &#39;type_symbol&#39;, &#39;label_atom_id&#39;, &#39;label_alt_id&#39;, &#39;label_comp_id&#39;, &#39;label_asym_id&#39;, &#39;label_entity_id&#39;, &#39;label_seq_id&#39;, &#39;pdbx_PDB_ins_code&#39;, &#39;Cartn_x&#39;, &#39;Cartn_y&#39;, &#39;Cartn_z&#39;, &#39;occupancy&#39;, &#39;B_iso_or_equiv&#39;, &#39;pdbx_formal_charge&#39;, &#39;auth_seq_id&#39;, &#39;auth_comp_id&#39;, &#39;auth_asym_id&#39;, &#39;auth_atom_id&#39;, &#39;pdbx_PDB_model_num&#39;]</span>
    <span class="c1">#          #         print(&#39;key&#39;, k__)</span>
    <span class="c1">#          #         input(f&#39;values {v__[:10]}&#39;)</span>
    <span class="c1">#          #     input(&#39;DONE&#39;)</span>
    <span class="c1">#          pass</span>

    <span class="n">provided_dataname</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">_</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;Found multiple values for the cif &#39;provided_dataname&#39;=</span><span class="si">{</span><span class="n">_</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Extract the data of interest as saved by the provided_dataname</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">provided_dataname</span><span class="p">]</span>

    <span class="c1"># def format_mmcif_dict(data: dict[str, Any], name: str = None, **kwargs) -&gt; dict:</span>
    <span class="n">atom_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_atom_site&#39;</span><span class="p">)</span>
    <span class="n">atom_numbers</span> <span class="o">=</span> <span class="n">atom_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">)</span>
    <span class="n">number_of_atoms</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">atom_numbers</span><span class="p">)</span>
    <span class="n">atom_types</span> <span class="o">=</span> <span class="n">atom_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label_atom_id&#39;</span><span class="p">)</span>
    <span class="n">alt_locations</span> <span class="o">=</span> <span class="n">atom_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label_alt_id&#39;</span><span class="p">,</span> <span class="n">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">number_of_atoms</span><span class="p">))</span>
    <span class="n">residue_types</span> <span class="o">=</span> <span class="n">atom_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label_comp_id&#39;</span><span class="p">)</span>
    <span class="n">chains</span> <span class="o">=</span> <span class="n">atom_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label_asym_id&#39;</span><span class="p">)</span>
    <span class="n">residue_numbers</span> <span class="o">=</span> <span class="n">atom_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;label_seq_id&#39;</span><span class="p">)</span>
    <span class="n">occupancies</span> <span class="o">=</span> <span class="n">atom_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;occupancy&#39;</span><span class="p">)</span>
    <span class="n">code_for_insertion</span> <span class="o">=</span> <span class="n">atom_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">repeat</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">number_of_atoms</span><span class="p">))</span>
    <span class="n">b_factors</span> <span class="o">=</span> <span class="n">atom_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;B_iso_or_equiv&#39;</span><span class="p">)</span>
    <span class="n">element</span> <span class="o">=</span> <span class="n">atom_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;type_symbol&#39;</span><span class="p">,</span> <span class="n">repeat</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_atoms</span><span class="p">))</span>
    <span class="n">charge</span> <span class="o">=</span> <span class="n">atom_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pdbx_formal_charge&#39;</span><span class="p">,</span> <span class="n">repeat</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">number_of_atoms</span><span class="p">))</span>
    <span class="n">alt_locations</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">alt_locations</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="n">code_for_insertion</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">code_for_insertion</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>
    <span class="n">charge</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">charge</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>

    <span class="n">atoms</span> <span class="o">=</span> <span class="p">[</span><span class="n">Atom</span><span class="o">.</span><span class="n">without_coordinates</span><span class="p">(</span><span class="n">idx</span><span class="p">,</span> <span class="o">*</span><span class="n">info</span><span class="p">)</span> <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">info</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span>
        <span class="nb">zip</span><span class="p">(</span><span class="n">atom_numbers</span><span class="p">,</span> <span class="n">atom_types</span><span class="p">,</span> <span class="n">alt_locations</span><span class="p">,</span> <span class="n">residue_types</span><span class="p">,</span> <span class="n">chains</span><span class="p">,</span> <span class="n">residue_numbers</span><span class="p">,</span> <span class="n">code_for_insertion</span><span class="p">,</span>
            <span class="n">occupancies</span><span class="p">,</span> <span class="n">b_factors</span><span class="p">,</span> <span class="n">element</span><span class="p">,</span> <span class="n">charge</span><span class="p">))]</span>

    <span class="n">coords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">atom_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Cartn_x&#39;</span><span class="p">),</span>
                       <span class="n">atom_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Cartn_y&#39;</span><span class="p">),</span>
                       <span class="n">atom_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;Cartn_z&#39;</span><span class="p">)],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
    <span class="n">cell_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_cell&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">cell_data</span><span class="p">:</span>
        <span class="c1"># &#39;length_a&#39;: &#39;124.910&#39;, &#39;length_b&#39;: &#39;189.250&#39;, &#39;length_c&#39;: &#39;376.830&#39;,</span>
        <span class="c1"># &#39;angle_alpha&#39;: &#39;90.00&#39;, &#39;angle_beta&#39;: &#39;90.02&#39;, &#39;angle_gamma&#39;: &#39;90.00&#39;</span>
        <span class="c1"># Formatted in Hermann-Mauguin notation</span>
        <span class="n">space_group</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_symmetry&#39;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;space_group_name_H-M&#39;</span><span class="p">)</span>
        <span class="n">cryst_record</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">symmetry</span><span class="o">.</span><span class="n">generate_cryst1_record</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="p">(</span><span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;length_a&#39;</span><span class="p">],</span> <span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;length_b&#39;</span><span class="p">],</span> <span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;length_c&#39;</span><span class="p">],</span>
                             <span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;angle_alpha&#39;</span><span class="p">],</span> <span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;angle_beta&#39;</span><span class="p">],</span> <span class="n">cell_data</span><span class="p">[</span><span class="s1">&#39;angle_gamma&#39;</span><span class="p">]))),</span>
            <span class="n">space_group</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cryst_record</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">reflections_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_reflns&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">reflections_data</span><span class="p">:</span>
        <span class="n">resolution</span> <span class="o">=</span> <span class="n">reflections_data</span><span class="p">[</span><span class="s1">&#39;d_resolution_high&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">resolution</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># _struct_ref</span>
    <span class="c1"># Get the cannonical sequence</span>
    <span class="n">entity_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_entity_poly&#39;</span><span class="p">)</span>
    <span class="n">db_data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_struct_ref&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">db_data</span><span class="p">:</span>
        <span class="c1"># &#39;db_name&#39;: [&#39;UNP&#39;, &#39;UNP&#39;], &#39;db_code&#39;: [&#39;B0BGB0_9BACT&#39;, &#39;Q4Q413_LEIMA&#39;],</span>
        <span class="c1"># &#39;pdbx_db_accession&#39;: [&#39;B0BGB0&#39;, &#39;Q4Q413&#39;], &#39;entity_id&#39;: [&#39;1&#39;, &#39;2&#39;],</span>
        <span class="c1"># &#39;pdbx_seq_one_letter_code&#39;: [&#39;MESVNTSFLSPSLVTIRDFDNGQFAVLRIGRTGFPADKGDIDLCLDKMKGVRDAQQSIGDDTEFGFKGPHIRIRCVDIDD\nKHTYNAMVYVDLIVGTGASEVERETAEELAKEKLRAALQVDIADEHSCVTQFEMKLREELLSSDSFHPDKDEYYKDFL&#39;, &#39;MPVIQTFVSTPLDHHKRENLAQVYRAVTRDVLGKPEDLVMMTFHDSTPMHFFGSTDPVACVRVEALGGYGPSEPEKVTSI\nVTAAITKECGIVADRIFVLYFSPLHCGWNGTNF&#39;]</span>
        <span class="n">entity_info</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">_</span><span class="si">{</span><span class="n">entity_id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;chains&#39;</span><span class="p">:</span> <span class="p">[],</span>
                                               <span class="s1">&#39;reference_sequence&#39;</span><span class="p">:</span> <span class="n">reference_sequence</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">),</span>
                                               <span class="s1">&#39;dbref&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;db&#39;</span><span class="p">:</span> <span class="n">db_name</span><span class="p">,</span> <span class="s1">&#39;accession&#39;</span><span class="p">:</span> <span class="n">db_accession</span><span class="p">}}</span>
                       <span class="k">for</span> <span class="n">entity_id</span><span class="p">,</span> <span class="n">reference_sequence</span><span class="p">,</span> <span class="n">db_name</span><span class="p">,</span> <span class="n">db_accession</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span>
                <span class="n">db_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;entity_id&#39;</span><span class="p">),</span>
                <span class="n">entity_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pdbx_seq_one_letter_code_can&#39;</span><span class="p">),</span>  <span class="c1"># db_data.get(&#39;pdbx_seq_one_letter_code&#39;),</span>
                <span class="n">db_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;db_name&#39;</span><span class="p">),</span> <span class="n">db_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pdbx_db_accession&#39;</span><span class="p">))</span>
                       <span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">entity_info</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">operations</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;_pdbx_struct_oper_list&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">operations</span><span class="p">:</span>
        <span class="n">biomt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
            <span class="p">[</span><span class="n">operations</span><span class="p">[</span><span class="s1">&#39;matrix[1][1]&#39;</span><span class="p">],</span> <span class="n">operations</span><span class="p">[</span><span class="s1">&#39;matrix[1][2]&#39;</span><span class="p">],</span> <span class="n">operations</span><span class="p">[</span><span class="s1">&#39;matrix[1][3]&#39;</span><span class="p">],</span>
             <span class="n">operations</span><span class="p">[</span><span class="s1">&#39;vector[1]&#39;</span><span class="p">],</span>
             <span class="n">operations</span><span class="p">[</span><span class="s1">&#39;matrix[2][1]&#39;</span><span class="p">],</span> <span class="n">operations</span><span class="p">[</span><span class="s1">&#39;matrix[2][2]&#39;</span><span class="p">],</span> <span class="n">operations</span><span class="p">[</span><span class="s1">&#39;matrix[2][3]&#39;</span><span class="p">],</span>
             <span class="n">operations</span><span class="p">[</span><span class="s1">&#39;vector[2]&#39;</span><span class="p">],</span>
             <span class="n">operations</span><span class="p">[</span><span class="s1">&#39;matrix[3][1]&#39;</span><span class="p">],</span> <span class="n">operations</span><span class="p">[</span><span class="s1">&#39;matrix[3][2]&#39;</span><span class="p">],</span> <span class="n">operations</span><span class="p">[</span><span class="s1">&#39;matrix[3][3]&#39;</span><span class="p">],</span>
             <span class="n">operations</span><span class="p">[</span><span class="s1">&#39;vector[3]&#39;</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="c1"># print(&#39;biomt&#39;, biomt)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operations</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">biomt</span> <span class="o">=</span> <span class="n">biomt</span><span class="o">.</span><span class="n">T</span>
        <span class="n">biomt</span> <span class="o">=</span> <span class="n">biomt</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
        <span class="c1"># print(&#39;biomt&#39;, biomt)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">biomt</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># # Separated...</span>
    <span class="c1"># rotations = np.array(</span>
    <span class="c1">#     [operations[&#39;matrix[1][1]&#39;], operations[&#39;matrix[1][2]&#39;], operations[&#39;matrix[1][3]&#39;],</span>
    <span class="c1">#      operations[&#39;matrix[2][1]&#39;], operations[&#39;matrix[2][2]&#39;], operations[&#39;matrix[2][3]&#39;],</span>
    <span class="c1">#      operations[&#39;matrix[3][1]&#39;], operations[&#39;matrix[3][2]&#39;], operations[&#39;matrix[3][3]&#39;]], dtype=float)</span>
    <span class="c1"># translations = np.array([operations[&#39;vector[1]&#39;], operations[&#39;vector[2]&#39;], operations[&#39;vector[3]&#39;]],</span>
    <span class="c1">#                         dtype=float)</span>
    <span class="c1"># print(&#39;rotations&#39;, rotations)</span>
    <span class="c1"># print(&#39;translations&#39;, translations)</span>
    <span class="c1"># if isinstance(operations[&#39;id&#39;], list):</span>
    <span class="c1">#     # number_of_operations = len(operations[&#39;id&#39;])</span>
    <span class="c1">#     rotations = rotations.T  # .reshape(-1, 3, 3)</span>
    <span class="c1">#     # rotations = rotations.reshape(-1, number_of_operations)</span>
    <span class="c1">#     translations = translations.T</span>
    <span class="c1"># # else:</span>
    <span class="c1"># #     pass</span>
    <span class="c1"># translations = translations.reshape(-1, 3)</span>
    <span class="c1"># rotations = rotations.reshape(-1, 3, 3)</span>
    <span class="c1">#</span>
    <span class="c1"># print(&#39;rotations&#39;, rotations)</span>
    <span class="c1"># print(&#39;translations&#39;, translations)</span>
    <span class="c1"># # biomt = rotations, translations</span>

    <span class="c1"># reference_sequence = {chain: reference_sequence}</span>
    <span class="n">formatted_info</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span>
        <span class="n">atoms</span><span class="o">=</span><span class="n">atoms</span><span class="p">,</span>
        <span class="n">biological_assembly</span><span class="o">=</span><span class="n">assembly</span><span class="p">,</span>
        <span class="n">biomt</span><span class="o">=</span><span class="n">biomt</span><span class="p">,</span>
        <span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">,</span>
        <span class="c1"># coords=coords if separate_coords else None,</span>
        <span class="n">cryst_record</span><span class="o">=</span><span class="n">cryst_record</span><span class="p">,</span>
        <span class="n">entity_info</span><span class="o">=</span><span class="n">entity_info</span><span class="p">,</span>
        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
        <span class="n">resolution</span><span class="o">=</span><span class="n">resolution</span><span class="p">,</span>
        <span class="c1"># reference_sequence=reference_sequence,</span>
    <span class="p">)</span>
    <span class="c1"># Explicitly overwrite any parsing if argument was passed to caller</span>
    <span class="n">formatted_info</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">formatted_info</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: structure">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                structure
              </div>
            </div>
          </a>
        
        
          
          <a href="../coordinates/" class="md-footer__link md-footer__link--next" aria-label="Next: coordinates">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                coordinates
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Kyle Meador
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/kylemeador" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.tracking", "navigation.instant", "navigation.path", "navigation.top", "navigation.footer", "search.suggest", "search.highlight", "toc.follow", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.8fd75fb4.min.js"></script>
      
    
  </body>
</html>